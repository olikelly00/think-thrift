[0m17:43:11.804297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c743a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0aad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0aa930>]}


============================== 17:43:11.835856 | ce916677-9338-4fc7-8177-3e247dc5f899 ==============================
[0m17:43:11.835856 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m17:43:11.837189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:11.925645 [error] [MainThread]: Encountered an error:
[ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/Users/olikelly/.dbt')}
[0m17:43:11.962424 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/google/protobuf/json_format.py", line 608, in _ConvertFieldValuePair
    _ConvertScalarFieldValue(value, field,
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/google/protobuf/json_format.py", line 779, in _ConvertScalarFieldValue
    if _UNPAIRED_SURROGATE_PATTERN.search(value):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'PosixPath'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt_common/events/base_types.py", line 67, in __init__
    self.pb_msg = ParseDict(kwargs, msg_cls())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/google/protobuf/json_format.py", line 446, in ParseDict
    parser.ConvertMessage(js_dict, message, '')
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/google/protobuf/json_format.py", line 487, in ConvertMessage
    self._ConvertFieldValuePair(value, message, path)
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/google/protobuf/json_format.py", line 622, in _ConvertFieldValuePair
    raise ParseError(
google.protobuf.json_format.ParseError: Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/task/init.py", line 300, in run
    self.create_profiles_dir(profiles_dir)
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/task/init.py", line 68, in create_profiles_dir
    fire_event(ConfigFolderDirectory(dir=profiles_dir))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt_common/events/base_types.py", line 76, in __init__
    raise Exception(error_msg)
Exception: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/Users/olikelly/.dbt')}

[0m17:43:12.034134 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 0.48931843, "process_user_time": 3.806714, "process_kernel_time": 0.908412, "process_mem_max_rss": "90439680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:43:12.048544 [debug] [MainThread]: Command `dbt init` failed at 17:43:12.037040 after 0.50 seconds
[0m17:43:12.056312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db4b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d8f80>]}
[0m17:43:12.061850 [debug] [MainThread]: Flushing usage events
[0m17:43:12.517168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:48.131148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc6c00>]}


============================== 21:50:48.147909 | 5c441a8c-70a9-4aa6-9d00-fc88053536d1 ==============================
[0m21:50:48.147909 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m21:50:48.149164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:48.157116 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m21:50:48.158357 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "think_thrift", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m21:50:48.186663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2807631, "process_user_time": 3.100088, "process_kernel_time": 0.675167, "process_mem_max_rss": "94814208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:50:48.187848 [debug] [MainThread]: Command `dbt run` failed at 21:50:48.187657 after 0.28 seconds
[0m21:50:48.188518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b75610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d9e20>]}
[0m21:50:48.189181 [debug] [MainThread]: Flushing usage events
[0m21:50:48.636528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:11.823040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111948740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11233fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11233ff80>]}


============================== 21:54:11.840151 | 8cf5068b-f332-4a7c-b321-1b999f579e5b ==============================
[0m21:54:11.840151 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:54:11.841970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:54:11.851369 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m21:54:11.852432 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "think_thrift", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m21:54:11.860222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.16726688, "process_user_time": 3.129536, "process_kernel_time": 0.697156, "process_mem_max_rss": "94072832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:54:11.863154 [debug] [MainThread]: Command `dbt run` failed at 21:54:11.862806 after 0.17 seconds
[0m21:54:11.864468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111948740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11152b140>]}
[0m21:54:11.866251 [debug] [MainThread]: Flushing usage events
[0m21:55:30.863022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10307d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b682c0>]}


============================== 21:55:30.878694 | d8c8dc2f-b1c9-441b-923e-b7cd6037f024 ==============================
[0m21:55:30.878694 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:55:30.880039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:30.888829 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m21:55:30.889860 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "think_thrift", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m21:55:30.897352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.16065381, "process_user_time": 2.934257, "process_kernel_time": 0.671002, "process_mem_max_rss": "93970432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:30.899515 [debug] [MainThread]: Command `dbt run` failed at 21:55:30.899182 after 0.16 seconds
[0m21:55:30.901259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048637d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477ab10>]}
[0m21:55:30.902795 [debug] [MainThread]: Flushing usage events
[0m22:01:24.248475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4003b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d792480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a0380>]}


============================== 22:01:24.284899 | 73a4ce6a-b84f-4ae7-951f-5cae42e3c544 ==============================
[0m22:01:24.284899 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:01:24.287763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:01:24.500482 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "think_thrift", target "dev" invalid: None is not of type 'string'
[0m22:01:24.507086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.47678596, "process_user_time": 3.238007, "process_kernel_time": 0.737271, "process_mem_max_rss": "96210944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:24.508454 [debug] [MainThread]: Command `dbt run` failed at 22:01:24.508221 after 0.48 seconds
[0m22:01:24.509169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ffaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9380e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3de450>]}
[0m22:01:24.509832 [debug] [MainThread]: Flushing usage events
[0m22:02:02.996997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082452b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d43c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d78080>]}


============================== 22:02:03.020099 | 261bfe27-31fd-4637-9a4e-c1e3c01558c3 ==============================
[0m22:02:03.020099 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:02:03.027964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:03.259318 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "think_thrift", target "dev" invalid: None is not of type 'string'
[0m22:02:03.264800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6153233, "process_user_time": 3.373951, "process_kernel_time": 0.751144, "process_mem_max_rss": "96337920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:03.266643 [debug] [MainThread]: Command `dbt run` failed at 22:02:03.266360 after 0.62 seconds
[0m22:02:03.267559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109864890>]}
[0m22:02:03.268308 [debug] [MainThread]: Flushing usage events
[0m22:03:39.824833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f93da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107018650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107018170>]}


============================== 22:03:39.859972 | 167e7a79-85ab-471b-b307-60c8d8912ef3 ==============================
[0m22:03:39.859972 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:03:39.862007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:03:40.435342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167e7a79-85ab-471b-b307-60c8d8912ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701a750>]}
[0m22:03:40.607066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167e7a79-85ab-471b-b307-60c8d8912ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b7cb0>]}
[0m22:03:40.609927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:03:41.432329 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:03:41.434823 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:03:41.436107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '167e7a79-85ab-471b-b307-60c8d8912ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747b170>]}
[0m22:03:43.722541 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.think_thrift_project.user_sales' (models/user_sales.sql) depends on a node named 'sales' which was not found
[0m22:03:43.731435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0944114, "process_user_time": 5.77003, "process_kernel_time": 0.85816, "process_mem_max_rss": "106287104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:03:43.733345 [debug] [MainThread]: Command `dbt run` failed at 22:03:43.733050 after 4.10 seconds
[0m22:03:43.734488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107018110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076179b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747af30>]}
[0m22:03:43.735274 [debug] [MainThread]: Flushing usage events
[0m22:04:14.022855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108883170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9845c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9840b0>]}


============================== 22:04:14.037118 | 21c633ff-8945-4329-9ae0-625851e5ee31 ==============================
[0m22:04:14.037118 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:04:14.039011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:04:14.467783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c633ff-8945-4329-9ae0-625851e5ee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3adc70>]}
[0m22:04:14.594082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21c633ff-8945-4329-9ae0-625851e5ee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a994500>]}
[0m22:04:14.604230 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:04:14.710443 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:04:14.751726 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:04:14.755162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21c633ff-8945-4329-9ae0-625851e5ee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae63290>]}
[0m22:04:17.185070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21c633ff-8945-4329-9ae0-625851e5ee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af06420>]}
[0m22:04:17.488003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21c633ff-8945-4329-9ae0-625851e5ee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b4e90>]}
[0m22:04:17.493069 [info ] [MainThread]: Found 1 model, 3 seeds, 423 macros
[0m22:04:17.496616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c633ff-8945-4329-9ae0-625851e5ee31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b761a00>]}
[0m22:04:17.500390 [info ] [MainThread]: 
[0m22:04:17.504211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:17.507265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think_thrift_db'
[0m22:04:17.688988 [debug] [ThreadPool]: Using postgres connection "list_think_thrift_db"
[0m22:04:17.690425 [debug] [ThreadPool]: On list_think_thrift_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think_thrift_db"} */

    select distinct nspname from pg_namespace
  
[0m22:04:17.691636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:17.704967 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m22:04:17.707057 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think_thrift_db"} */

    select distinct nspname from pg_namespace
  
[0m22:04:17.707734 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:04:17.708421 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:04:17.709008 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:04:17.709575 [debug] [ThreadPool]: On list_think_thrift_db: No close available on handle
[0m22:04:17.710682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:17.711302 [debug] [MainThread]: Connection 'list_think_thrift_db' was properly closed.
[0m22:04:17.711902 [info ] [MainThread]: 
[0m22:04:17.714234 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m22:04:17.715614 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m22:04:17.720325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8256233, "process_user_time": 5.904369, "process_kernel_time": 0.974768, "process_mem_max_rss": "110968832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:17.721431 [debug] [MainThread]: Command `dbt run` failed at 22:04:17.721237 after 3.83 seconds
[0m22:04:17.722104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5cea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b763f80>]}
[0m22:04:17.722727 [debug] [MainThread]: Flushing usage events
[0m22:08:16.740148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138fc110>]}


============================== 22:08:16.760368 | dba5b7fa-1170-4d10-b833-25ddad623ff5 ==============================
[0m22:08:16.760368 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:08:16.763810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:17.505043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dba5b7fa-1170-4d10-b833-25ddad623ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132607a0>]}
[0m22:08:17.742103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dba5b7fa-1170-4d10-b833-25ddad623ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d3dd00>]}
[0m22:08:17.746454 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:08:18.016927 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:08:18.598591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:18.599951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:18.716031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dba5b7fa-1170-4d10-b833-25ddad623ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e1c9e0>]}
[0m22:08:19.109051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dba5b7fa-1170-4d10-b833-25ddad623ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e1ce30>]}
[0m22:08:19.110701 [info ] [MainThread]: Found 1 model, 3 seeds, 423 macros
[0m22:08:19.113002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dba5b7fa-1170-4d10-b833-25ddad623ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d06e0>]}
[0m22:08:19.145205 [info ] [MainThread]: 
[0m22:08:19.157995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:08:19.162859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think_thrift_db'
[0m22:08:19.388896 [debug] [ThreadPool]: Using postgres connection "list_think_thrift_db"
[0m22:08:19.390315 [debug] [ThreadPool]: On list_think_thrift_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think_thrift_db"} */

    select distinct nspname from pg_namespace
  
[0m22:08:19.391575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:19.403956 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m22:08:19.406878 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think_thrift_db"} */

    select distinct nspname from pg_namespace
  
[0m22:08:19.408176 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:08:19.409776 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:08:19.411059 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:08:19.412338 [debug] [ThreadPool]: On list_think_thrift_db: No close available on handle
[0m22:08:19.414585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:19.415782 [debug] [MainThread]: Connection 'list_think_thrift_db' was properly closed.
[0m22:08:19.418583 [info ] [MainThread]: 
[0m22:08:19.421202 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m22:08:19.422966 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m22:08:19.428835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.959836, "process_user_time": 5.432735, "process_kernel_time": 1.004236, "process_mem_max_rss": "107552768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:19.431125 [debug] [MainThread]: Command `dbt run` failed at 22:08:19.430642 after 2.96 seconds
[0m22:08:19.433228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e1e960>]}
[0m22:08:19.434706 [debug] [MainThread]: Flushing usage events
[0m22:13:21.517807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111520710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111520230>]}


============================== 22:13:21.534513 | 8dfb050d-a08c-4f64-94b5-7709ece54d54 ==============================
[0m22:13:21.534513 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:13:21.536400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:13:22.054415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dfb050d-a08c-4f64-94b5-7709ece54d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe32540>]}
[0m22:13:22.157061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dfb050d-a08c-4f64-94b5-7709ece54d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fba0c0>]}
[0m22:13:22.159666 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:13:22.197229 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:13:22.482407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:22.483300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:22.589024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dfb050d-a08c-4f64-94b5-7709ece54d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a99d00>]}
[0m22:13:22.872550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dfb050d-a08c-4f64-94b5-7709ece54d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9b7a0>]}
[0m22:13:22.873504 [info ] [MainThread]: Found 1 model, 3 seeds, 423 macros
[0m22:13:22.874778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dfb050d-a08c-4f64-94b5-7709ece54d54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120366c0>]}
[0m22:13:22.878270 [info ] [MainThread]: 
[0m22:13:22.881811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:22.889597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think_thrift_db'
[0m22:13:23.062031 [debug] [ThreadPool]: Using postgres connection "list_think_thrift_db"
[0m22:13:23.064070 [debug] [ThreadPool]: On list_think_thrift_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think_thrift_db"} */

    select distinct nspname from pg_namespace
  
[0m22:13:23.065438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:23.162623 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "think_thrift_db" does not exist

[0m22:13:23.179431 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think_thrift_db"} */

    select distinct nspname from pg_namespace
  
[0m22:13:23.180167 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:13:23.180902 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:13:23.181525 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:13:23.185412 [debug] [ThreadPool]: On list_think_thrift_db: No close available on handle
[0m22:13:23.189942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:23.191605 [debug] [MainThread]: Connection 'list_think_thrift_db' was properly closed.
[0m22:13:23.192879 [info ] [MainThread]: 
[0m22:13:23.195987 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m22:13:23.198072 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "think_thrift_db" does not exist
  
[0m22:13:23.215592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.829178, "process_user_time": 4.117918, "process_kernel_time": 0.923338, "process_mem_max_rss": "110567424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:13:23.228637 [debug] [MainThread]: Command `dbt run` failed at 22:13:23.228194 after 1.85 seconds
[0m22:13:23.230001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111520710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a686e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ff890>]}
[0m22:13:23.231278 [debug] [MainThread]: Flushing usage events
[0m22:13:45.506984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077987a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107798290>]}


============================== 22:13:45.530794 | e8a9bdd3-33fc-40ef-823c-213d4dae4963 ==============================
[0m22:13:45.530794 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:13:45.533245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:13:45.929473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4be30>]}
[0m22:13:46.055022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065be9f0>]}
[0m22:13:46.060316 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:13:46.114559 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:13:46.361058 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:13:46.362713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6ff50>]}
[0m22:13:48.955534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4a450>]}
[0m22:13:49.270226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108541be0>]}
[0m22:13:49.271359 [info ] [MainThread]: Found 1 model, 3 seeds, 423 macros
[0m22:13:49.272834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840bfe0>]}
[0m22:13:49.280178 [info ] [MainThread]: 
[0m22:13:49.282032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:49.285948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:13:49.448181 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:13:49.449473 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:13:49.450678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:49.577847 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.126 seconds
[0m22:13:49.581536 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:13:49.593639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:13:49.609508 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:13:49.610577 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:13:49.611588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:49.623150 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m22:13:49.624279 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:13:49.625565 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:13:49.649014 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.022 seconds
[0m22:13:49.651514 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:13:49.652823 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:13:49.663368 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:49.664101 [debug] [MainThread]: On master: BEGIN
[0m22:13:49.664677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:49.674908 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:13:49.675695 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:49.676477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:13:49.714438 [debug] [MainThread]: SQL status: SELECT 0 in 0.037 seconds
[0m22:13:49.716516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a96a0>]}
[0m22:13:49.718100 [debug] [MainThread]: On master: ROLLBACK
[0m22:13:49.721415 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:49.722239 [debug] [MainThread]: On master: BEGIN
[0m22:13:49.723612 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:13:49.724882 [debug] [MainThread]: On master: COMMIT
[0m22:13:49.725900 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:49.726537 [debug] [MainThread]: On master: COMMIT
[0m22:13:49.727657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:49.728605 [debug] [MainThread]: On master: Close
[0m22:13:49.730568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:13:49.731911 [info ] [MainThread]: 
[0m22:13:49.744150 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:13:49.745504 [info ] [Thread-1 (]: 1 of 1 START sql view model public.user_sales .................................. [RUN]
[0m22:13:49.746910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.user_sales)
[0m22:13:49.747750 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:13:49.766752 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:13:49.775180 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:13:49.885013 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:13:49.890097 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:13:49.892564 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:13:49.899179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:49.920623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m22:13:49.921666 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:13:49.922545 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions" s
JOIN "think-thrift-db"."public"."users" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products" p ON s.product_id = p.product_id
GROUP BY u.username;
  );
[0m22:13:49.925979 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12: GROUP BY u.username;
                            ^

[0m22:13:49.926949 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:13:49.928547 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:13:49.962622 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  syntax error at or near ";"
  LINE 12: GROUP BY u.username;
                              ^
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:13:49.966289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a9bdd3-33fc-40ef-823c-213d4dae4963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d99250>]}
[0m22:13:49.967865 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.22s]
[0m22:13:49.970802 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:13:49.976000 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:49.976762 [debug] [MainThread]: On master: BEGIN
[0m22:13:49.977458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:49.989124 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:13:49.991476 [debug] [MainThread]: On master: COMMIT
[0m22:13:49.992700 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:49.993869 [debug] [MainThread]: On master: COMMIT
[0m22:13:49.996411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:49.998077 [debug] [MainThread]: On master: Close
[0m22:13:49.999681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:50.000448 [debug] [MainThread]: Connection 'model.think_thrift_project.user_sales' was properly closed.
[0m22:13:50.001208 [info ] [MainThread]: 
[0m22:13:50.002848 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m22:13:50.006589 [debug] [MainThread]: Command end result
[0m22:13:50.072342 [info ] [MainThread]: 
[0m22:13:50.073448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:13:50.074313 [info ] [MainThread]: 
[0m22:13:50.075366 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  syntax error at or near ";"
  LINE 12: GROUP BY u.username;
                              ^
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:13:50.076118 [info ] [MainThread]: 
[0m22:13:50.076923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:13:50.084392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.7956343, "process_user_time": 6.672722, "process_kernel_time": 0.940483, "process_mem_max_rss": "115687424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:13:50.086889 [debug] [MainThread]: Command `dbt run` failed at 22:13:50.086585 after 4.80 seconds
[0m22:13:50.089031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107733a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076182c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087dcda0>]}
[0m22:13:50.090740 [debug] [MainThread]: Flushing usage events
[0m22:18:07.872803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d64b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ee48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ee4470>]}


============================== 22:18:07.893044 | 7cbc4bb8-9926-4407-91e8-4694def42cd9 ==============================
[0m22:18:07.893044 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:18:07.895715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:18:08.348254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121953a0>]}
[0m22:18:08.436585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11353da30>]}
[0m22:18:08.439198 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:18:08.476790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:18:08.747590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:18:08.748557 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/user_sales.sql
[0m22:18:09.096230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c7bef0>]}
[0m22:18:09.281995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c54aa0>]}
[0m22:18:09.283371 [info ] [MainThread]: Found 3 seeds, 1 model, 423 macros
[0m22:18:09.284426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c74710>]}
[0m22:18:09.287576 [info ] [MainThread]: 
[0m22:18:09.288660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:09.290290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:18:09.412327 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:18:09.413275 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:18:09.413956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:09.501496 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.086 seconds
[0m22:18:09.504234 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:18:09.512872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:18:09.521796 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:18:09.522485 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:18:09.523010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:09.530645 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:18:09.531332 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:18:09.531913 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:18:09.536909 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:18:09.539548 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:18:09.540554 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:18:09.548896 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:09.549546 [debug] [MainThread]: On master: BEGIN
[0m22:18:09.550064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:09.561175 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:18:09.561891 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:09.562789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:18:09.582509 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m22:18:09.586939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150023c0>]}
[0m22:18:09.587943 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:09.589575 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:09.591076 [debug] [MainThread]: On master: BEGIN
[0m22:18:09.593260 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:18:09.595078 [debug] [MainThread]: On master: COMMIT
[0m22:18:09.596000 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:09.596708 [debug] [MainThread]: On master: COMMIT
[0m22:18:09.597935 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:09.599614 [debug] [MainThread]: On master: Close
[0m22:18:09.602183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:18:09.604666 [info ] [MainThread]: 
[0m22:18:09.615445 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:18:09.617782 [info ] [Thread-1 (]: 1 of 1 START sql view model public.user_sales .................................. [RUN]
[0m22:18:09.618955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.user_sales)
[0m22:18:09.619807 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:18:09.635930 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:18:09.640119 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:18:09.714464 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:18:09.715759 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:18:09.716594 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:18:09.717264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:09.725284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:18:09.726032 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:18:09.726973 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
SUM(s.quantity * p.price) AS total_sales
FROM public.transactions s
JOIN public.users u ON s.user_id = u.user_id
JOIN public.products p ON s.product_id = p.product_id
GROUP BY u.username;
  );
[0m22:18:09.729758 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12: GROUP BY u.username;
                            ^

[0m22:18:09.730711 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:18:09.732772 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:18:09.759912 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  syntax error at or near ";"
  LINE 12: GROUP BY u.username;
                              ^
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:18:09.762031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cbc4bb8-9926-4407-91e8-4694def42cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e5280>]}
[0m22:18:09.763056 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.14s]
[0m22:18:09.764282 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:18:09.769516 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:09.770743 [debug] [MainThread]: On master: BEGIN
[0m22:18:09.771523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:09.782191 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:18:09.783037 [debug] [MainThread]: On master: COMMIT
[0m22:18:09.783838 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:09.784582 [debug] [MainThread]: On master: COMMIT
[0m22:18:09.786478 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:18:09.787439 [debug] [MainThread]: On master: Close
[0m22:18:09.789242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:09.790376 [debug] [MainThread]: Connection 'model.think_thrift_project.user_sales' was properly closed.
[0m22:18:09.791582 [info ] [MainThread]: 
[0m22:18:09.792586 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m22:18:09.793993 [debug] [MainThread]: Command end result
[0m22:18:09.841387 [info ] [MainThread]: 
[0m22:18:09.842510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:18:09.843325 [info ] [MainThread]: 
[0m22:18:09.844207 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  syntax error at or near ";"
  LINE 12: GROUP BY u.username;
                              ^
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:18:09.844921 [info ] [MainThread]: 
[0m22:18:09.845667 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:18:09.851003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1991518, "process_user_time": 4.481577, "process_kernel_time": 0.962865, "process_mem_max_rss": "116355072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:18:09.852715 [debug] [MainThread]: Command `dbt run` failed at 22:18:09.852375 after 2.20 seconds
[0m22:18:09.854205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113923aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11443a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e57a40>]}
[0m22:18:09.855370 [debug] [MainThread]: Flushing usage events
[0m22:21:16.362355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb49190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e764500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e764080>]}


============================== 22:21:16.378295 | 38260e51-3603-41b5-9871-dbc5a973e6bc ==============================
[0m22:21:16.378295 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:21:16.380558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:21:17.005561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38260e51-3603-41b5-9871-dbc5a973e6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62f140>]}
[0m22:21:17.100955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38260e51-3603-41b5-9871-dbc5a973e6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d775820>]}
[0m22:21:17.103515 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:17.150018 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:21:17.500173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m22:21:17.501064 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/transactions.sql
[0m22:21:17.501684 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/products.sql
[0m22:21:17.502298 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/users.sql
[0m22:21:17.503815 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/user_sales.sql
[0m22:21:17.952757 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""think-thrift-db"."public"."transactions"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - seed.think_thrift_project.transactions (seeds/transactions.csv)
  - model.think_thrift_project.transactions (models/transactions.sql)
[0m22:21:17.959995 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.751744, "process_user_time": 4.248416, "process_kernel_time": 0.894897, "process_mem_max_rss": "105603072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:17.961604 [debug] [MainThread]: Command `dbt seed` failed at 22:21:17.961346 after 1.76 seconds
[0m22:21:17.962911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e764080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f34f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec43110>]}
[0m22:21:17.964534 [debug] [MainThread]: Flushing usage events
[0m22:22:35.416488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a886b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a881d0>]}


============================== 22:22:35.436612 | 9799c819-dd0e-4789-a293-62556be13206 ==============================
[0m22:22:35.436612 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:22:35.438729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m22:22:35.924726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9799c819-dd0e-4789-a293-62556be13206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f3a420>]}
[0m22:22:36.025035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9799c819-dd0e-4789-a293-62556be13206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113affa10>]}
[0m22:22:36.027629 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:22:36.072033 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:22:36.351977 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 2 files changed.
[0m22:22:36.352853 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://seeds/transactions_seed.csv
[0m22:22:36.353480 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://seeds/products_seed.csv
[0m22:22:36.354073 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://seeds/users_seed.csv
[0m22:22:36.354608 [debug] [MainThread]: Partial parsing: deleted file: think_thrift_project://seeds/users.csv
[0m22:22:36.355136 [debug] [MainThread]: Partial parsing: deleted file: think_thrift_project://seeds/transactions.csv
[0m22:22:36.355670 [debug] [MainThread]: Partial parsing: deleted file: think_thrift_project://seeds/products.csv
[0m22:22:36.356363 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/users.sql
[0m22:22:36.357048 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/transactions.sql
[0m22:22:37.118523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9799c819-dd0e-4789-a293-62556be13206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146650d0>]}
[0m22:22:37.316978 [error] [MainThread]: Encountered an error:
Found a cycle: model.think_thrift_project.products
[0m22:22:37.331164 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/cli/main.py", line 701, in seed
    results = task.run()
              ^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/olikelly/Documents/Coding/think-thrift/think-thrift-env/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.think_thrift_project.products

[0m22:22:37.340463 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.056125, "process_user_time": 4.367593, "process_kernel_time": 0.915942, "process_mem_max_rss": "108584960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:22:37.341625 [debug] [MainThread]: Command `dbt seed` failed at 22:22:37.341434 after 2.06 seconds
[0m22:22:37.342316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a88770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146e61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146e7980>]}
[0m22:22:37.342944 [debug] [MainThread]: Flushing usage events
[0m22:25:16.379883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a43890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc4380>]}


============================== 22:25:16.395159 | cf78b636-5ac7-4166-90b2-39ceed406223 ==============================
[0m22:25:16.395159 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:25:16.397173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:25:16.843519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b40110>]}
[0m22:25:16.947381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d60c0>]}
[0m22:25:16.950355 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:25:16.998658 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:25:17.297447 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m22:25:17.298216 [debug] [MainThread]: Partial parsing: deleted file: think_thrift_project://models/user_sales.sql
[0m22:25:17.298989 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/transactions.sql
[0m22:25:17.299689 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/products.sql
[0m22:25:17.300374 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/users.sql
[0m22:25:17.773977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108958d40>]}
[0m22:25:17.994618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108276750>]}
[0m22:25:17.995777 [info ] [MainThread]: Found 3 seeds, 3 models, 423 macros
[0m22:25:17.996778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082152b0>]}
[0m22:25:17.999776 [info ] [MainThread]: 
[0m22:25:18.000839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:25:18.008245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:25:18.133889 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:25:18.134654 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:25:18.135228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:18.197495 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m22:25:18.199923 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:25:18.203484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:25:18.213356 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:25:18.214063 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:25:18.214681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:18.222778 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:25:18.223458 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:25:18.224066 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:25:18.229494 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:25:18.231607 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:25:18.232464 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:25:18.240511 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:18.241198 [debug] [MainThread]: On master: BEGIN
[0m22:25:18.241869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:18.253476 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:25:18.260449 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:18.263049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:25:18.285175 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m22:25:18.288519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e34d0>]}
[0m22:25:18.289470 [debug] [MainThread]: On master: ROLLBACK
[0m22:25:18.290934 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:18.291766 [debug] [MainThread]: On master: BEGIN
[0m22:25:18.293049 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:25:18.294541 [debug] [MainThread]: On master: COMMIT
[0m22:25:18.296672 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:18.297580 [debug] [MainThread]: On master: COMMIT
[0m22:25:18.299089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:25:18.300161 [debug] [MainThread]: On master: Close
[0m22:25:18.301793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:25:18.303112 [info ] [MainThread]: 
[0m22:25:18.318214 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.products_seed
[0m22:25:18.321285 [info ] [Thread-1 (]: 1 of 3 START seed file public.products_seed .................................... [RUN]
[0m22:25:18.323010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now seed.think_thrift_project.products_seed)
[0m22:25:18.324370 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.products_seed
[0m22:25:18.325534 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.products_seed
[0m22:25:18.406172 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:25:18.407221 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: BEGIN
[0m22:25:18.407893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:18.415713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:25:18.416493 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:25:18.417224 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.products_seed"} */

    create table "think-thrift-db"."public"."products_seed" ("product_id" integer,"product_name" text,"category" text,"price" integer)
  
[0m22:25:18.431769 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.013 seconds
[0m22:25:18.476566 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:25:18.477782 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: 
          insert into "think-thrift-db"."public"."products_seed" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:25:18.483629 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m22:25:18.495554 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.products_seed"
[0m22:25:18.525509 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:25:18.526276 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:25:18.526899 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:25:18.530242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:25:18.535080 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: Close
[0m22:25:18.538108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a1370>]}
[0m22:25:18.539362 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.products_seed ................................ [[32mINSERT 10[0m in 0.21s]
[0m22:25:18.540760 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.products_seed
[0m22:25:18.541562 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.transactions_seed
[0m22:25:18.542545 [info ] [Thread-1 (]: 2 of 3 START seed file public.transactions_seed ................................ [RUN]
[0m22:25:18.543429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.products_seed, now seed.think_thrift_project.transactions_seed)
[0m22:25:18.544174 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.transactions_seed
[0m22:25:18.544839 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.transactions_seed
[0m22:25:18.553064 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:25:18.553932 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: BEGIN
[0m22:25:18.554673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:18.562760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:25:18.563998 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:25:18.564888 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.transactions_seed"} */

    create table "think-thrift-db"."public"."transactions_seed" ("transaction_id" integer,"sale_id" integer,"user_id" integer,"product_id" integer,"quantity" integer,"sale_date" date)
  
[0m22:25:18.570736 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m22:25:18.634203 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:25:18.635110 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: 
          insert into "think-thrift-db"."public"."transactions_seed" ("transaction_id", "sale_id", "user_id", "product_id", "quantity", "sale_date") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m22:25:18.637999 [debug] [Thread-1 (]: SQL status: INSERT 0 29 in 0.002 seconds
[0m22:25:18.639205 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.transactions_seed"
[0m22:25:18.642562 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:25:18.643287 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:25:18.644109 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:25:18.646551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:25:18.648335 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: Close
[0m22:25:18.649416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc4f20>]}
[0m22:25:18.650364 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.transactions_seed ............................ [[32mINSERT 29[0m in 0.11s]
[0m22:25:18.652263 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.transactions_seed
[0m22:25:18.653233 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.users_seed
[0m22:25:18.654199 [info ] [Thread-1 (]: 3 of 3 START seed file public.users_seed ....................................... [RUN]
[0m22:25:18.655063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.transactions_seed, now seed.think_thrift_project.users_seed)
[0m22:25:18.655810 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.users_seed
[0m22:25:18.656773 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.users_seed
[0m22:25:18.665121 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:25:18.666072 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: BEGIN
[0m22:25:18.667067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:18.676130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:25:18.676891 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:25:18.677684 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.users_seed"} */

    create table "think-thrift-db"."public"."users_seed" ("user_id" integer," username" text,"country" text,"join_date" date,"email" text,"user_rating" float8,"items_sold" integer,"items_bought" integer)
  
[0m22:25:18.685099 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.007 seconds
[0m22:25:18.711679 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:25:18.713649 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: 
          insert into "think-thrift-db"."public"."users_seed" ("user_id", " username", "country", "join_date", "email", "user_rating", "items_sold", "items_bought") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:25:18.716542 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m22:25:18.718113 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.users_seed"
[0m22:25:18.721174 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: COMMIT
[0m22:25:18.721868 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:25:18.722487 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: COMMIT
[0m22:25:18.724990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:25:18.727393 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: Close
[0m22:25:18.730044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf78b636-5ac7-4166-90b2-39ceed406223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d24fb0>]}
[0m22:25:18.731487 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.users_seed ................................... [[32mINSERT 10[0m in 0.07s]
[0m22:25:18.733178 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.users_seed
[0m22:25:18.736621 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:18.737504 [debug] [MainThread]: On master: BEGIN
[0m22:25:18.739942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:25:18.752708 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:25:18.753597 [debug] [MainThread]: On master: COMMIT
[0m22:25:18.754164 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:18.754703 [debug] [MainThread]: On master: COMMIT
[0m22:25:18.755623 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:25:18.756467 [debug] [MainThread]: On master: Close
[0m22:25:18.757308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:18.757948 [debug] [MainThread]: Connection 'seed.think_thrift_project.users_seed' was properly closed.
[0m22:25:18.758603 [info ] [MainThread]: 
[0m22:25:18.759708 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m22:25:18.764006 [debug] [MainThread]: Command end result
[0m22:25:18.836086 [info ] [MainThread]: 
[0m22:25:18.837408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:25:18.838763 [info ] [MainThread]: 
[0m22:25:18.839865 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:25:18.849061 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.5875316, "process_user_time": 4.707779, "process_kernel_time": 0.952065, "process_mem_max_rss": "115412992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:25:18.850345 [debug] [MainThread]: Command `dbt seed` succeeded at 22:25:18.850114 after 2.59 seconds
[0m22:25:18.852110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107712030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b40050>]}
[0m22:25:18.853156 [debug] [MainThread]: Flushing usage events
[0m22:26:47.350830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef0320>]}


============================== 22:26:47.372915 | 30314303-f6b5-40bd-b375-359d53f85444 ==============================
[0m22:26:47.372915 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:26:47.375622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:26:47.762661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d73110>]}
[0m22:26:47.852459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11236e540>]}
[0m22:26:47.855014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:26:47.893925 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:26:48.308980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:48.309636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:48.369400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11342a6f0>]}
[0m22:26:48.563707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197f8c0>]}
[0m22:26:48.565068 [info ] [MainThread]: Found 3 seeds, 3 models, 423 macros
[0m22:26:48.566248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a0a6c0>]}
[0m22:26:48.569839 [info ] [MainThread]: 
[0m22:26:48.571235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:26:48.577901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:26:48.699715 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:26:48.700511 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:26:48.701091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:48.761713 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m22:26:48.764143 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:26:48.767654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:26:48.779190 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:26:48.779863 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:26:48.780392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:48.788391 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:26:48.789196 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:26:48.789833 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:26:48.794882 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m22:26:48.797080 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:26:48.798102 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:26:48.807459 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:48.808206 [debug] [MainThread]: On master: BEGIN
[0m22:26:48.808835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:48.819479 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:26:48.820485 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:48.821628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:26:48.840662 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m22:26:48.842568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e5a000>]}
[0m22:26:48.843319 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:48.844228 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:48.844826 [debug] [MainThread]: On master: BEGIN
[0m22:26:48.845837 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:26:48.846537 [debug] [MainThread]: On master: COMMIT
[0m22:26:48.847109 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:48.847645 [debug] [MainThread]: On master: COMMIT
[0m22:26:48.848446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:26:48.849196 [debug] [MainThread]: On master: Close
[0m22:26:48.851084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:48.853069 [info ] [MainThread]: 
[0m22:26:48.860478 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:26:48.861556 [info ] [Thread-1 (]: 1 of 3 START sql view model public.products .................................... [RUN]
[0m22:26:48.862574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:26:48.863278 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:26:48.877799 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:26:48.879075 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:26:48.941444 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:26:48.942845 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:26:48.943670 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:26:48.944311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:48.952220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:26:48.952999 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:26:48.954034 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed";
  );
[0m22:26:48.956847 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: FROM "think-thrift-db"."public"."products_seed";
                                                       ^

[0m22:26:48.958286 [debug] [Thread-1 (]: On model.think_thrift_project.products: ROLLBACK
[0m22:26:48.965551 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:26:48.988230 [debug] [Thread-1 (]: Database Error in model products (models/products.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."products_seed";
                                                         ^
  compiled code at target/run/think_thrift_project/models/products.sql
[0m22:26:48.990436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113352e70>]}
[0m22:26:48.991496 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.products ........................... [[31mERROR[0m in 0.13s]
[0m22:26:48.992743 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:26:48.993568 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:26:48.995441 [info ] [Thread-1 (]: 2 of 3 START sql view model public.transactions ................................ [RUN]
[0m22:26:48.996346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.transactions)
[0m22:26:48.997031 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:26:49.003226 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:26:49.004661 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:26:49.012300 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:26:49.013585 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:26:49.014480 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:26:49.015268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:49.028949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m22:26:49.029719 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:26:49.030360 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed";
  );
[0m22:26:49.031509 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: FROM "think-thrift-db"."public"."transactions_seed";
                                                           ^

[0m22:26:49.032236 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: ROLLBACK
[0m22:26:49.033632 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:26:49.039136 [debug] [Thread-1 (]: Database Error in model transactions (models/transactions.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."transactions_seed";
                                                             ^
  compiled code at target/run/think_thrift_project/models/transactions.sql
[0m22:26:49.040221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f85a00>]}
[0m22:26:49.041685 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.transactions ....................... [[31mERROR[0m in 0.04s]
[0m22:26:49.043720 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:26:49.044577 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:26:49.045564 [info ] [Thread-1 (]: 3 of 3 START sql view model public.users ....................................... [RUN]
[0m22:26:49.046496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.users)
[0m22:26:49.047180 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:26:49.053430 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:26:49.055196 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:26:49.061554 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:26:49.062731 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:26:49.063504 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:26:49.064189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:49.075645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:26:49.076402 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:26:49.077030 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed";
  );
[0m22:26:49.078180 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: FROM "think-thrift-db"."public"."users_seed";
                                                    ^

[0m22:26:49.078905 [debug] [Thread-1 (]: On model.think_thrift_project.users: ROLLBACK
[0m22:26:49.079885 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:26:49.085012 [debug] [Thread-1 (]: Database Error in model users (models/users.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."users_seed";
                                                      ^
  compiled code at target/run/think_thrift_project/models/users.sql
[0m22:26:49.086463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30314303-f6b5-40bd-b375-359d53f85444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fa37d0>]}
[0m22:26:49.087780 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model public.users .............................. [[31mERROR[0m in 0.04s]
[0m22:26:49.089803 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:26:49.093469 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:49.094134 [debug] [MainThread]: On master: BEGIN
[0m22:26:49.095064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:49.107071 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:26:49.108248 [debug] [MainThread]: On master: COMMIT
[0m22:26:49.108834 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:49.109370 [debug] [MainThread]: On master: COMMIT
[0m22:26:49.110201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:26:49.110827 [debug] [MainThread]: On master: Close
[0m22:26:49.111633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:49.112269 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:26:49.112988 [info ] [MainThread]: 
[0m22:26:49.114169 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m22:26:49.116430 [debug] [MainThread]: Command end result
[0m22:26:49.184046 [info ] [MainThread]: 
[0m22:26:49.185338 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:26:49.186159 [info ] [MainThread]: 
[0m22:26:49.187101 [error] [MainThread]:   Database Error in model products (models/products.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."products_seed";
                                                         ^
  compiled code at target/run/think_thrift_project/models/products.sql
[0m22:26:49.188103 [info ] [MainThread]: 
[0m22:26:49.189021 [error] [MainThread]:   Database Error in model transactions (models/transactions.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."transactions_seed";
                                                             ^
  compiled code at target/run/think_thrift_project/models/transactions.sql
[0m22:26:49.190644 [info ] [MainThread]: 
[0m22:26:49.192887 [error] [MainThread]:   Database Error in model users (models/users.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."users_seed";
                                                      ^
  compiled code at target/run/think_thrift_project/models/users.sql
[0m22:26:49.194168 [info ] [MainThread]: 
[0m22:26:49.195313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m22:26:49.202682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9867806, "process_user_time": 4.182931, "process_kernel_time": 0.944999, "process_mem_max_rss": "112537600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:26:49.206091 [debug] [MainThread]: Command `dbt run` failed at 22:26:49.205837 after 1.99 seconds
[0m22:26:49.207426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d137a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebced50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2fd70>]}
[0m22:26:49.209188 [debug] [MainThread]: Flushing usage events
[0m22:28:18.953790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1c5c0>]}


============================== 22:28:18.969313 | 3f58af98-548c-48a5-96fd-017db526315b ==============================
[0m22:28:18.969313 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:28:18.970821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:28:19.386432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2c9e0>]}
[0m22:28:19.505341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2c770>]}
[0m22:28:19.508716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:28:19.545791 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:28:19.878481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m22:28:19.879374 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/top_selling_products.sql
[0m22:28:19.880145 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/user_sales.sql
[0m22:28:20.250560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a283350>]}
[0m22:28:20.434731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8be720>]}
[0m22:28:20.436138 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:28:20.437043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0ff80>]}
[0m22:28:20.440627 [info ] [MainThread]: 
[0m22:28:20.441772 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:28:20.449214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:28:20.566047 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:28:20.566748 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:28:20.567325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:20.634372 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m22:28:20.637045 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:28:20.640990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:28:20.650698 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:28:20.651633 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:28:20.653053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:20.662309 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:28:20.662986 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:28:20.663566 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:28:20.668185 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m22:28:20.670840 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:28:20.671814 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:28:20.679945 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:20.680602 [debug] [MainThread]: On master: BEGIN
[0m22:28:20.681130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:20.688879 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.689611 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:20.690286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:28:20.704051 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m22:28:20.706046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a932630>]}
[0m22:28:20.706809 [debug] [MainThread]: On master: ROLLBACK
[0m22:28:20.707679 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:20.708289 [debug] [MainThread]: On master: BEGIN
[0m22:28:20.709350 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:28:20.710040 [debug] [MainThread]: On master: COMMIT
[0m22:28:20.710601 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:20.711144 [debug] [MainThread]: On master: COMMIT
[0m22:28:20.711938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:28:20.712542 [debug] [MainThread]: On master: Close
[0m22:28:20.713461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:28:20.714478 [info ] [MainThread]: 
[0m22:28:20.720884 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:28:20.721957 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:28:20.723152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:28:20.723943 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:28:20.735047 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:28:20.736266 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:28:20.790991 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:28:20.792329 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:28:20.793117 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:28:20.793775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:20.802015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.802861 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:28:20.803612 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed";
  );
[0m22:28:20.806411 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: FROM "think-thrift-db"."public"."products_seed";
                                                       ^

[0m22:28:20.807515 [debug] [Thread-1 (]: On model.think_thrift_project.products: ROLLBACK
[0m22:28:20.809091 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:28:20.824289 [debug] [Thread-1 (]: Database Error in model products (models/products.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."products_seed";
                                                         ^
  compiled code at target/run/think_thrift_project/models/products.sql
[0m22:28:20.826417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f93a0>]}
[0m22:28:20.827440 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model public.products ........................... [[31mERROR[0m in 0.10s]
[0m22:28:20.828717 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:28:20.829658 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:28:20.831765 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:28:20.833053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:28:20.834075 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:28:20.838787 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:28:20.840121 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:28:20.845895 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:28:20.847143 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:28:20.847893 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:28:20.848553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:20.856302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.857097 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:28:20.857757 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC;
  );
[0m22:28:20.859040 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12: ORDER BY total_quantity DESC;
                                     ^

[0m22:28:20.859872 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: ROLLBACK
[0m22:28:20.860922 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:28:20.865504 [debug] [Thread-1 (]: Database Error in model top_selling_products (models/top_selling_products.sql)
  syntax error at or near ";"
  LINE 12: ORDER BY total_quantity DESC;
                                       ^
  compiled code at target/run/think_thrift_project/models/top_selling_products.sql
[0m22:28:20.866342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afaf710>]}
[0m22:28:20.867281 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model public.top_selling_products ............... [[31mERROR[0m in 0.03s]
[0m22:28:20.868407 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:28:20.869175 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:28:20.870165 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:28:20.871055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:28:20.871761 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:28:20.875922 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:28:20.877157 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:28:20.883023 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:28:20.884280 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:28:20.885025 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:28:20.885675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:20.893978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.894750 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:28:20.895387 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed";
  );
[0m22:28:20.896584 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: FROM "think-thrift-db"."public"."transactions_seed";
                                                           ^

[0m22:28:20.897349 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: ROLLBACK
[0m22:28:20.898380 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:28:20.902652 [debug] [Thread-1 (]: Database Error in model transactions (models/transactions.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."transactions_seed";
                                                             ^
  compiled code at target/run/think_thrift_project/models/transactions.sql
[0m22:28:20.903782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d05c6e0>]}
[0m22:28:20.904986 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.transactions ....................... [[31mERROR[0m in 0.03s]
[0m22:28:20.906241 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:28:20.907046 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:28:20.908101 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:28:20.908999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:28:20.909706 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:28:20.914652 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:28:20.915881 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:28:20.920877 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:28:20.922152 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:28:20.922913 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:28:20.923559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:20.931313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.932074 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:28:20.932718 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username;
  );
[0m22:28:20.933943 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12: GROUP BY u.username;
                            ^

[0m22:28:20.934661 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:28:20.935632 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:28:20.940838 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  syntax error at or near ";"
  LINE 12: GROUP BY u.username;
                              ^
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:28:20.941690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d084ec0>]}
[0m22:28:20.942685 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.03s]
[0m22:28:20.943854 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:28:20.944651 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:28:20.945633 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:28:20.946531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:28:20.947220 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:28:20.951397 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:28:20.952619 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:28:20.957820 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:28:20.959085 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:28:20.960013 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:28:20.960709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:20.968405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.969286 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:28:20.969978 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed";
  );
[0m22:28:20.971171 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: FROM "think-thrift-db"."public"."users_seed";
                                                    ^

[0m22:28:20.971967 [debug] [Thread-1 (]: On model.think_thrift_project.users: ROLLBACK
[0m22:28:20.973284 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:28:20.977859 [debug] [Thread-1 (]: Database Error in model users (models/users.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."users_seed";
                                                      ^
  compiled code at target/run/think_thrift_project/models/users.sql
[0m22:28:20.978715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f58af98-548c-48a5-96fd-017db526315b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa80e00>]}
[0m22:28:20.979760 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model public.users .............................. [[31mERROR[0m in 0.03s]
[0m22:28:20.980944 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:28:20.984451 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:20.985153 [debug] [MainThread]: On master: BEGIN
[0m22:28:20.985690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:20.993896 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:28:20.994660 [debug] [MainThread]: On master: COMMIT
[0m22:28:20.995273 [debug] [MainThread]: Using postgres connection "master"
[0m22:28:20.995851 [debug] [MainThread]: On master: COMMIT
[0m22:28:20.996705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:28:20.997332 [debug] [MainThread]: On master: Close
[0m22:28:20.998221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:20.998924 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:28:20.999712 [info ] [MainThread]: 
[0m22:28:21.001130 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m22:28:21.003710 [debug] [MainThread]: Command end result
[0m22:28:21.045976 [info ] [MainThread]: 
[0m22:28:21.046964 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m22:28:21.047686 [info ] [MainThread]: 
[0m22:28:21.048606 [error] [MainThread]:   Database Error in model products (models/products.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."products_seed";
                                                         ^
  compiled code at target/run/think_thrift_project/models/products.sql
[0m22:28:21.049404 [info ] [MainThread]: 
[0m22:28:21.050217 [error] [MainThread]:   Database Error in model top_selling_products (models/top_selling_products.sql)
  syntax error at or near ";"
  LINE 12: ORDER BY total_quantity DESC;
                                       ^
  compiled code at target/run/think_thrift_project/models/top_selling_products.sql
[0m22:28:21.050910 [info ] [MainThread]: 
[0m22:28:21.051723 [error] [MainThread]:   Database Error in model transactions (models/transactions.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."transactions_seed";
                                                             ^
  compiled code at target/run/think_thrift_project/models/transactions.sql
[0m22:28:21.052744 [info ] [MainThread]: 
[0m22:28:21.053829 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  syntax error at or near ";"
  LINE 12: GROUP BY u.username;
                              ^
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:28:21.054751 [info ] [MainThread]: 
[0m22:28:21.056072 [error] [MainThread]:   Database Error in model users (models/users.sql)
  syntax error at or near ";"
  LINE 8: FROM "think-thrift-db"."public"."users_seed";
                                                      ^
  compiled code at target/run/think_thrift_project/models/users.sql
[0m22:28:21.057064 [info ] [MainThread]: 
[0m22:28:21.058381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m22:28:21.063306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.255558, "process_user_time": 4.669342, "process_kernel_time": 0.963813, "process_mem_max_rss": "115699712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:28:21.064927 [debug] [MainThread]: Command `dbt run` failed at 22:28:21.064453 after 2.26 seconds
[0m22:28:21.065990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109866c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109866330>]}
[0m22:28:21.066858 [debug] [MainThread]: Flushing usage events
[0m22:29:19.830947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4810a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e8380>]}


============================== 22:29:19.846363 | 1dc0691e-2e83-4cd8-ac15-12a4d103fab1 ==============================
[0m22:29:19.846363 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:19.847725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:20.357660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32ae70>]}
[0m22:29:20.448930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4e87a0>]}
[0m22:29:20.451568 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:29:20.489051 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:20.737282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m22:29:20.738259 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/transactions.sql
[0m22:29:20.738957 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/user_sales.sql
[0m22:29:20.739633 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/top_selling_products.sql
[0m22:29:20.740470 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/products.sql
[0m22:29:20.741326 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/users.sql
[0m22:29:21.151548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d163230>]}
[0m22:29:21.330241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbafe30>]}
[0m22:29:21.331359 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:29:21.332284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d270080>]}
[0m22:29:21.335602 [info ] [MainThread]: 
[0m22:29:21.336987 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:21.345004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:29:21.477292 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:29:21.491780 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:29:21.493374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:21.567160 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.072 seconds
[0m22:29:21.572041 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:29:21.579996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:29:21.596492 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:29:21.597239 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:29:21.597816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:21.607792 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m22:29:21.608840 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:29:21.610501 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:29:21.619082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m22:29:21.622511 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:29:21.623481 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:29:21.636022 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:21.636717 [debug] [MainThread]: On master: BEGIN
[0m22:29:21.637277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:21.648992 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:29:21.650178 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:21.651379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:29:21.671752 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m22:29:21.675090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d12e060>]}
[0m22:29:21.676357 [debug] [MainThread]: On master: ROLLBACK
[0m22:29:21.678347 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:21.679526 [debug] [MainThread]: On master: BEGIN
[0m22:29:21.683169 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:29:21.684145 [debug] [MainThread]: On master: COMMIT
[0m22:29:21.684761 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:21.685308 [debug] [MainThread]: On master: COMMIT
[0m22:29:21.686171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:29:21.686821 [debug] [MainThread]: On master: Close
[0m22:29:21.688180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:21.690363 [info ] [MainThread]: 
[0m22:29:21.700939 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:29:21.702148 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:29:21.703253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:29:21.704096 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:29:21.723842 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:29:21.726091 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:29:21.808773 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:29:21.815195 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:21.818443 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:29:21.820510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:21.831610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:29:21.832648 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:21.833880 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:29:21.842296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:29:21.861736 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:21.864259 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:29:21.867019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:21.871330 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:21.872089 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:29:21.879973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:21.924401 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:29:21.925842 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:21.926686 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:29:21.929831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:29:21.944755 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:29:21.958501 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:21.959367 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop table if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:29:21.971661 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m22:29:21.978155 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:29:21.981045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aded520>]}
[0m22:29:21.982438 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.28s]
[0m22:29:21.983638 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:29:21.984504 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:29:21.985683 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:29:21.986577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:29:21.987272 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:29:21.992441 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:29:21.995028 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:29:22.003044 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:29:22.004252 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:22.005130 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:29:22.006072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:22.016675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:29:22.017526 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:22.018179 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:29:22.028265 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m22:29:22.034032 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:22.034786 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:29:22.036009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:22.038391 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:29:22.039123 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:22.039863 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:29:22.042269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:29:22.049602 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:29:22.054280 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:22.055019 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:29:22.056061 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:29:22.058363 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:29:22.060029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d717cb0>]}
[0m22:29:22.061999 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:29:22.063458 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:29:22.064291 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:29:22.065304 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:29:22.066193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:29:22.066956 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:29:22.070787 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:29:22.072110 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:29:22.081213 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:29:22.082600 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:22.083327 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:29:22.083941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:22.091863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:29:22.093031 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:22.094500 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:29:22.099477 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:29:22.108713 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:22.110169 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:29:22.113285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:22.117445 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:22.118148 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:29:22.119406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:22.122439 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:29:22.123193 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:22.123897 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:29:22.126192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:29:22.130647 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:29:22.131957 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:22.132621 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop table if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:29:22.137336 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m22:29:22.139523 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:29:22.140724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d73fef0>]}
[0m22:29:22.142423 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:29:22.144092 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:29:22.145027 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:29:22.146159 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:29:22.147307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:29:22.148551 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:29:22.154636 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:29:22.155882 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:29:22.165661 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:29:22.167016 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:29:22.167856 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:29:22.168593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:22.180569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:29:22.181882 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:29:22.183240 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:29:22.189362 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column u.username does not exist
LINE 7:     SELECT u.username, 
                   ^
HINT:  Perhaps you meant to reference the column "u. username".

[0m22:29:22.190226 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:29:22.191763 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:29:22.214174 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:29:22.215498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d715b50>]}
[0m22:29:22.217182 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.07s]
[0m22:29:22.218524 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:29:22.219291 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:29:22.221132 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:29:22.222021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:29:22.222704 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:29:22.228243 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:29:22.229625 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:29:22.236900 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:29:22.238097 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:22.238790 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:29:22.239458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:22.249709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:29:22.250480 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:22.251134 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:29:22.254530 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:29:22.259840 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:22.261338 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m22:29:22.263356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:22.268659 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:22.269381 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m22:29:22.270537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:29:22.273112 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:29:22.274016 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:22.274667 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:29:22.277671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:29:22.283053 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m22:29:22.284360 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:22.285005 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop table if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m22:29:22.290835 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:29:22.293646 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:29:22.295378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc0691e-2e83-4cd8-ac15-12a4d103fab1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6fc470>]}
[0m22:29:22.296662 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m22:29:22.298469 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:29:22.302337 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:22.303576 [debug] [MainThread]: On master: BEGIN
[0m22:29:22.304682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:22.319735 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m22:29:22.320501 [debug] [MainThread]: On master: COMMIT
[0m22:29:22.321513 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:22.322622 [debug] [MainThread]: On master: COMMIT
[0m22:29:22.324074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:29:22.325327 [debug] [MainThread]: On master: Close
[0m22:29:22.329290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:22.330485 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:29:22.331636 [info ] [MainThread]: 
[0m22:29:22.332800 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m22:29:22.336083 [debug] [MainThread]: Command end result
[0m22:29:22.398384 [info ] [MainThread]: 
[0m22:29:22.399330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:29:22.400037 [info ] [MainThread]: 
[0m22:29:22.400854 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:29:22.401625 [info ] [MainThread]: 
[0m22:29:22.402535 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:29:22.407159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.740632, "process_user_time": 4.891462, "process_kernel_time": 0.993479, "process_mem_max_rss": "115908608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:22.409252 [debug] [MainThread]: Command `dbt run` failed at 22:29:22.408829 after 2.74 seconds
[0m22:29:22.411226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0972c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be77170>]}
[0m22:29:22.413214 [debug] [MainThread]: Flushing usage events
[0m22:29:48.013203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeaf830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f00680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f00230>]}


============================== 22:29:48.030059 | 7cb63f20-45c0-49dd-abcd-c5a02eca6a8e ==============================
[0m22:29:48.030059 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:48.032405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:48.465882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7be2d0>]}
[0m22:29:48.565899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110927a40>]}
[0m22:29:48.568280 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:29:48.606326 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:48.925166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:48.926120 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/user_sales.sql
[0m22:29:49.277505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c452b0>]}
[0m22:29:49.468931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fe6f0>]}
[0m22:29:49.470306 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:29:49.471362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c13020>]}
[0m22:29:49.474895 [info ] [MainThread]: 
[0m22:29:49.475966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:49.488211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:29:49.613838 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:29:49.614817 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:29:49.615403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:49.686927 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.071 seconds
[0m22:29:49.689254 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:29:49.692010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:29:49.702951 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:29:49.704460 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:29:49.705102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:49.715149 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m22:29:49.715825 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:29:49.716404 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:29:49.721011 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:29:49.723765 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:29:49.724680 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:29:49.734561 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:49.735223 [debug] [MainThread]: On master: BEGIN
[0m22:29:49.735747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:49.743439 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:29:49.744486 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:49.746040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:29:49.765126 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m22:29:49.769027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec8f50>]}
[0m22:29:49.769758 [debug] [MainThread]: On master: ROLLBACK
[0m22:29:49.770608 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:49.771237 [debug] [MainThread]: On master: BEGIN
[0m22:29:49.772293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:29:49.772976 [debug] [MainThread]: On master: COMMIT
[0m22:29:49.773537 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:49.774072 [debug] [MainThread]: On master: COMMIT
[0m22:29:49.774948 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:29:49.775580 [debug] [MainThread]: On master: Close
[0m22:29:49.776471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:49.777827 [info ] [MainThread]: 
[0m22:29:49.785248 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:29:49.786443 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:29:49.788772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:29:49.790144 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:29:49.805635 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:29:49.808221 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:29:49.882228 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:29:49.883634 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:49.884379 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:29:49.884987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:49.893303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:29:49.894097 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:49.894792 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:29:49.899973 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:29:49.911310 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:49.912086 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:29:49.913320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:49.918730 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:49.919496 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:29:49.920729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:49.953178 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:29:49.953926 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:49.954541 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:29:49.957813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:29:49.968350 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:29:49.976403 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:29:49.977157 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:29:49.980015 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:29:49.984037 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:29:49.986500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7bd340>]}
[0m22:29:49.987775 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:29:49.988960 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:29:49.989760 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:29:49.990730 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:29:49.991616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:29:49.992296 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:29:49.996817 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:29:49.998181 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:29:50.003804 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:29:50.004995 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:50.005853 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:29:50.006551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:50.015029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:29:50.016492 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:50.017328 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:29:50.021351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:29:50.026660 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:50.027888 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m22:29:50.030623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:29:50.036786 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:50.037515 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:29:50.038713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:50.041311 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:29:50.041978 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:50.042585 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:29:50.044875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:29:50.050787 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:29:50.052233 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:29:50.053003 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:29:50.056162 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:29:50.058548 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:29:50.059578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114210d0>]}
[0m22:29:50.060949 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:29:50.063501 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:29:50.064368 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:29:50.065312 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:29:50.066253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:29:50.066945 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:29:50.071653 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:29:50.073507 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:29:50.081776 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:29:50.082965 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:50.083792 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:29:50.084441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:50.092051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:29:50.092809 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:50.093466 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:29:50.102135 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m22:29:50.106741 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:50.107473 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:29:50.111118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:50.116699 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:50.117430 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:29:50.118597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:29:50.121417 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:29:50.122102 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:50.122712 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:29:50.125073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:29:50.129020 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:29:50.131741 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:29:50.132841 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:29:50.135789 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:29:50.138301 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:29:50.139435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11211eed0>]}
[0m22:29:50.140696 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:29:50.142308 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:29:50.143088 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:29:50.144305 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:29:50.146288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:29:50.147873 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:29:50.152831 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:29:50.154377 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:29:50.160534 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:29:50.162618 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:29:50.164602 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:29:50.166364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:50.174709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:29:50.175454 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:29:50.176097 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u. username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:29:50.180783 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column u.username does not exist
LINE 7:     SELECT u. username, 
                   ^
HINT:  Perhaps you meant to reference the column "u. username".

[0m22:29:50.181766 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:29:50.183775 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:29:50.200828 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u. username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:29:50.201615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d5d90>]}
[0m22:29:50.202618 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.06s]
[0m22:29:50.203861 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:29:50.204695 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:29:50.206513 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:29:50.207414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:29:50.208143 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:29:50.215048 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:29:50.216561 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:29:50.237169 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:29:50.238541 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:50.246971 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:29:50.247818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:50.303395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m22:29:50.304235 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:50.304985 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:29:50.310087 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:29:50.317635 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:50.318584 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m22:29:50.321055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:50.326377 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:50.327464 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m22:29:50.329113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:29:50.331946 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:29:50.332730 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:50.333437 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:29:50.335898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:29:50.339715 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m22:29:50.341042 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:29:50.341729 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m22:29:50.346966 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:29:50.350032 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:29:50.351271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb63f20-45c0-49dd-abcd-c5a02eca6a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ed070>]}
[0m22:29:50.352853 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.14s]
[0m22:29:50.354431 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:29:50.356412 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:50.357108 [debug] [MainThread]: On master: BEGIN
[0m22:29:50.357680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:29:50.370314 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:29:50.371460 [debug] [MainThread]: On master: COMMIT
[0m22:29:50.372259 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:50.373506 [debug] [MainThread]: On master: COMMIT
[0m22:29:50.374965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:29:50.376680 [debug] [MainThread]: On master: Close
[0m22:29:50.379073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:50.380904 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:29:50.382686 [info ] [MainThread]: 
[0m22:29:50.383825 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m22:29:50.386811 [debug] [MainThread]: Command end result
[0m22:29:50.462585 [info ] [MainThread]: 
[0m22:29:50.463674 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:29:50.464657 [info ] [MainThread]: 
[0m22:29:50.466544 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u. username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:29:50.467645 [info ] [MainThread]: 
[0m22:29:50.469691 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:29:50.473617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.592359, "process_user_time": 4.637461, "process_kernel_time": 0.960105, "process_mem_max_rss": "116142080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:50.487259 [debug] [MainThread]: Command `dbt run` failed at 22:29:50.476175 after 2.60 seconds
[0m22:29:50.492454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e73bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f83350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f812180>]}
[0m22:29:50.499352 [debug] [MainThread]: Flushing usage events
[0m22:30:32.686353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea673b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7d4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f954380>]}


============================== 22:30:32.708678 | 86832493-4bc8-456c-b79e-b61a64ae5511 ==============================
[0m22:30:32.708678 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:30:32.711548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:30:33.077169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ddd60>]}
[0m22:30:33.164232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3da00>]}
[0m22:30:33.166869 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:30:33.206827 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:30:33.523418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:30:33.524391 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/user_sales.sql
[0m22:30:33.904706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106992b0>]}
[0m22:30:34.088163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055a7b0>]}
[0m22:30:34.088989 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:30:34.089743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110698c80>]}
[0m22:30:34.092824 [info ] [MainThread]: 
[0m22:30:34.093893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:30:34.101585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:30:34.220391 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:30:34.221247 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:30:34.221904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:34.285487 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m22:30:34.287901 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:30:34.291833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:30:34.301423 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:30:34.302115 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:30:34.302677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:30:34.310718 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:30:34.311379 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:30:34.311952 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:30:34.317080 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:30:34.319365 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:30:34.320229 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:30:34.329011 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:34.329727 [debug] [MainThread]: On master: BEGIN
[0m22:30:34.330373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:34.339307 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:30:34.340441 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:34.341419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:30:34.359143 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m22:30:34.362617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e1a60>]}
[0m22:30:34.363931 [debug] [MainThread]: On master: ROLLBACK
[0m22:30:34.366526 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:34.367723 [debug] [MainThread]: On master: BEGIN
[0m22:30:34.369112 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:30:34.369808 [debug] [MainThread]: On master: COMMIT
[0m22:30:34.370382 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:34.371057 [debug] [MainThread]: On master: COMMIT
[0m22:30:34.371868 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:30:34.372463 [debug] [MainThread]: On master: Close
[0m22:30:34.373315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:30:34.374500 [info ] [MainThread]: 
[0m22:30:34.384155 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:30:34.385274 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:30:34.386566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:30:34.388014 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:30:34.401564 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:30:34.403421 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:30:34.462375 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:30:34.463645 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:30:34.464371 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:30:34.464995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:34.472746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:30:34.473476 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:30:34.474099 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:30:34.482434 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:30:34.494579 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:30:34.495335 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:30:34.496677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:30:34.503438 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:30:34.504210 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:30:34.505456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:30:34.535051 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:30:34.535804 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:30:34.536492 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:30:34.538823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:30:34.549807 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:30:34.557916 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:30:34.558647 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:30:34.561713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:30:34.566186 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:30:34.568722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e209790>]}
[0m22:30:34.570001 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.18s]
[0m22:30:34.571563 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:30:34.572391 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:30:34.573410 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:30:34.574439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:30:34.575478 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:30:34.582623 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:30:34.584262 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:30:34.589972 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:30:34.591294 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:30:34.592047 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:30:34.592744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:34.601974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:30:34.602741 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:30:34.603386 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:30:34.607139 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:30:34.612363 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:30:34.613084 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m22:30:34.616745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:30:34.622693 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:30:34.623422 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:30:34.624644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:30:34.627258 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:30:34.627953 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:30:34.628551 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:30:34.630871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:30:34.636779 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:30:34.638044 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:30:34.638684 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:30:34.641684 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:30:34.644411 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:30:34.645429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ade660>]}
[0m22:30:34.646737 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:30:34.648407 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:30:34.650038 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:30:34.651073 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:30:34.651940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:30:34.652605 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:30:34.656784 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:30:34.658171 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:30:34.668086 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:30:34.670120 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:30:34.670833 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:30:34.671431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:34.679071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:30:34.679961 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:30:34.681070 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:30:34.685066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:30:34.690917 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:30:34.691674 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:30:34.695308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:30:34.701270 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:30:34.702258 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:30:34.703866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:30:34.706697 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:30:34.707375 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:30:34.707975 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:30:34.710150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:30:34.713926 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:30:34.716354 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:30:34.717090 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:30:34.720068 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:30:34.722437 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:30:34.723682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b73110>]}
[0m22:30:34.724833 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:30:34.726350 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:30:34.727313 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:30:34.728291 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:30:34.729174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:30:34.730114 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:30:34.735163 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:30:34.736767 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:30:34.742867 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:30:34.744015 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:30:34.744822 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:30:34.745712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:34.757180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:30:34.757959 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:30:34.758600 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:30:34.762054 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column u.username does not exist
LINE 7:     SELECT u.username, 
                   ^
HINT:  Perhaps you meant to reference the column "u. username".

[0m22:30:34.763360 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:30:34.766876 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:30:34.784691 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:30:34.786029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4da60>]}
[0m22:30:34.787067 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.06s]
[0m22:30:34.788202 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:30:34.788956 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:30:34.790783 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:30:34.791667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:30:34.792331 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:30:34.796318 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:30:34.798558 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:30:34.805927 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:30:34.807235 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:30:34.807997 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:30:34.808634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:34.821323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:30:34.822453 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:30:34.823882 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:30:34.827492 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:30:34.833801 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:30:34.834752 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m22:30:34.836858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:30:34.843805 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:30:34.845487 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m22:30:34.848904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:30:34.853797 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:30:34.854637 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:30:34.855306 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:30:34.856862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:30:34.860143 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m22:30:34.861603 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:30:34.862301 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m22:30:34.865794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:30:34.868080 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:30:34.869059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86832493-4bc8-456c-b79e-b61a64ae5511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b11280>]}
[0m22:30:34.870155 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m22:30:34.871621 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:30:34.875240 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:34.876209 [debug] [MainThread]: On master: BEGIN
[0m22:30:34.876757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:34.886923 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:30:34.887608 [debug] [MainThread]: On master: COMMIT
[0m22:30:34.888153 [debug] [MainThread]: Using postgres connection "master"
[0m22:30:34.888679 [debug] [MainThread]: On master: COMMIT
[0m22:30:34.889521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:30:34.890118 [debug] [MainThread]: On master: Close
[0m22:30:34.890906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:34.891554 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:30:34.892287 [info ] [MainThread]: 
[0m22:30:34.893447 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m22:30:34.895764 [debug] [MainThread]: Command end result
[0m22:30:34.947518 [info ] [MainThread]: 
[0m22:30:34.948564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:30:34.949454 [info ] [MainThread]: 
[0m22:30:34.950547 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:30:34.951325 [info ] [MainThread]: 
[0m22:30:34.952062 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:30:34.956835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4250557, "process_user_time": 4.55245, "process_kernel_time": 0.914192, "process_mem_max_rss": "116613120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:30:34.958326 [debug] [MainThread]: Command `dbt run` failed at 22:30:34.958067 after 2.43 seconds
[0m22:30:34.959402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea67170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef03d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f2db0>]}
[0m22:30:34.960272 [debug] [MainThread]: Flushing usage events
[0m22:31:23.212733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50320>]}


============================== 22:31:23.230382 | 39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9 ==============================
[0m22:31:23.230382 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:31:23.232277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:31:23.624141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bee390>]}
[0m22:31:23.750441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b62c90>]}
[0m22:31:23.753226 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:31:23.794515 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:31:24.071424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:31:24.072383 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://seeds/users_seed.csv
[0m22:31:24.422694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108861b80>]}
[0m22:31:24.610712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108834e30>]}
[0m22:31:24.612110 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:31:24.613201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac78c0>]}
[0m22:31:24.616818 [info ] [MainThread]: 
[0m22:31:24.618364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:24.627139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:31:24.745238 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:31:24.746657 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:31:24.747781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:24.820694 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m22:31:24.823173 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:31:24.825909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:31:24.835023 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:31:24.835687 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:31:24.836223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:24.844145 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:31:24.844823 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:31:24.845410 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:31:24.850060 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:31:24.852840 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:31:24.853750 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:31:24.862399 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:24.863158 [debug] [MainThread]: On master: BEGIN
[0m22:31:24.863706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:24.873024 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:31:24.873719 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:24.874383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:31:24.891775 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m22:31:24.895266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cc380>]}
[0m22:31:24.895987 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:24.896850 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:24.897456 [debug] [MainThread]: On master: BEGIN
[0m22:31:24.898492 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:31:24.899180 [debug] [MainThread]: On master: COMMIT
[0m22:31:24.899949 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:24.900842 [debug] [MainThread]: On master: COMMIT
[0m22:31:24.902819 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:24.903669 [debug] [MainThread]: On master: Close
[0m22:31:24.905254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:31:24.906105 [info ] [MainThread]: 
[0m22:31:24.912411 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:31:24.913391 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:31:24.914561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:31:24.915417 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:31:24.932658 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:31:24.935129 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:31:25.007191 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:31:25.008882 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:31:25.010349 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:31:25.011828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:25.023379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:31:25.024501 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:31:25.025183 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:31:25.028120 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:31:25.039644 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:31:25.040390 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:31:25.041629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.047374 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:31:25.048099 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:31:25.049261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.084708 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:31:25.085511 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:31:25.086239 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:31:25.088609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:31:25.097747 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:31:25.105760 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:31:25.106496 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:31:25.109495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:31:25.113483 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:31:25.116004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fd7c0>]}
[0m22:31:25.117323 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:31:25.118544 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:31:25.119350 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:31:25.120321 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:31:25.121210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:31:25.121889 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:31:25.126456 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:31:25.127839 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:31:25.133624 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:31:25.134899 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:31:25.135750 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:31:25.136550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:25.145854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:31:25.146620 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:31:25.147267 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:31:25.155177 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:31:25.160164 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:31:25.160997 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m22:31:25.162560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.167771 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:31:25.169581 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:31:25.172007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.175175 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:31:25.175904 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:31:25.176525 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:31:25.178761 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:31:25.182281 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:31:25.183859 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:31:25.185402 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:31:25.188756 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:31:25.191066 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:31:25.192184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67920>]}
[0m22:31:25.193283 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:31:25.194927 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:31:25.195784 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:31:25.196737 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:31:25.197623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:31:25.198289 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:31:25.203014 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:31:25.204337 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:31:25.211305 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:31:25.212488 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:31:25.213191 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:31:25.213804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:25.223594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:31:25.224415 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:31:25.225110 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:31:25.228052 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:31:25.233213 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:31:25.234675 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:31:25.237355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.242189 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:31:25.242899 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:31:25.244088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.248391 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:31:25.249134 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:31:25.250047 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:31:25.253623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:31:25.257255 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:31:25.258504 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:31:25.259145 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:31:25.262256 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:31:25.264973 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:31:25.266084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d23260>]}
[0m22:31:25.267837 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:31:25.270030 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:31:25.271071 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:31:25.272276 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:31:25.273200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:31:25.273871 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:31:25.278313 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:31:25.279440 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:31:25.284934 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:31:25.286106 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:31:25.286920 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:31:25.287712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:25.297310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:31:25.298209 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:31:25.298910 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:31:25.303487 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column u.username does not exist
LINE 7:     SELECT u.username, 
                   ^
HINT:  Perhaps you meant to reference the column "u. username".

[0m22:31:25.304422 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:31:25.305773 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:31:25.325025 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:31:25.325825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d23950>]}
[0m22:31:25.326747 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.05s]
[0m22:31:25.327942 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:31:25.328714 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:31:25.330729 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:31:25.331625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:31:25.332349 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:31:25.338778 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:31:25.340934 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:31:25.346031 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:31:25.347191 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:31:25.347842 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:31:25.349091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:25.361570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m22:31:25.362333 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:31:25.363006 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:31:25.366303 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:31:25.374570 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:31:25.375306 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m22:31:25.376768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.380952 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:31:25.381652 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m22:31:25.382906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:31:25.388115 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:31:25.388849 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:31:25.389454 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:31:25.391828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:31:25.395308 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m22:31:25.396493 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:31:25.397128 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m22:31:25.400302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:31:25.403451 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:31:25.404709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c25ee7-43d0-4cb8-9ce4-1b9e86c470a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdc3e0>]}
[0m22:31:25.405794 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m22:31:25.407195 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:31:25.410612 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:25.411257 [debug] [MainThread]: On master: BEGIN
[0m22:31:25.411788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:25.423024 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:31:25.423786 [debug] [MainThread]: On master: COMMIT
[0m22:31:25.424346 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:25.424963 [debug] [MainThread]: On master: COMMIT
[0m22:31:25.426029 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:31:25.426799 [debug] [MainThread]: On master: Close
[0m22:31:25.427958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:25.429065 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:31:25.430115 [info ] [MainThread]: 
[0m22:31:25.431287 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:31:25.434934 [debug] [MainThread]: Command end result
[0m22:31:25.508326 [info ] [MainThread]: 
[0m22:31:25.509596 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:31:25.512845 [info ] [MainThread]: 
[0m22:31:25.516061 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:31:25.517296 [info ] [MainThread]: 
[0m22:31:25.526936 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:31:25.542644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4746857, "process_user_time": 4.851158, "process_kernel_time": 0.96115, "process_mem_max_rss": "115552256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:31:25.544390 [debug] [MainThread]: Command `dbt run` failed at 22:31:25.544039 after 2.48 seconds
[0m22:31:25.545287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d2db0>]}
[0m22:31:25.546258 [debug] [MainThread]: Flushing usage events
[0m22:32:13.191776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f713fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f713d40>]}


============================== 22:32:13.211811 | 911f73a2-755c-4682-b1d7-c37f952e43ef ==============================
[0m22:32:13.211811 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:32:13.214988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:13.747290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c9910>]}
[0m22:32:13.869981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc3a40>]}
[0m22:32:13.873028 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:32:13.906110 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:32:14.173898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:32:14.174707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:32:14.237581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc2f260>]}
[0m22:32:14.446947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032d460>]}
[0m22:32:14.448073 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:32:14.449029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110326450>]}
[0m22:32:14.452244 [info ] [MainThread]: 
[0m22:32:14.453554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:32:14.461550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:32:14.628601 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:32:14.629854 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:32:14.630949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:14.713111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m22:32:14.718077 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:32:14.724764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:32:14.750667 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:32:14.752131 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:32:14.753542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:14.768172 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m22:32:14.768923 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:32:14.770405 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:32:14.780815 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:32:14.785650 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:32:14.787739 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:32:14.806674 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:14.807869 [debug] [MainThread]: On master: BEGIN
[0m22:32:14.809308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:32:14.821009 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:32:14.823013 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:14.825114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:32:14.852720 [debug] [MainThread]: SQL status: SELECT 5 in 0.026 seconds
[0m22:32:14.860138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd58410>]}
[0m22:32:14.861140 [debug] [MainThread]: On master: ROLLBACK
[0m22:32:14.862456 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:14.863270 [debug] [MainThread]: On master: BEGIN
[0m22:32:14.864673 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:32:14.865572 [debug] [MainThread]: On master: COMMIT
[0m22:32:14.866453 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:14.867206 [debug] [MainThread]: On master: COMMIT
[0m22:32:14.868175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:32:14.869110 [debug] [MainThread]: On master: Close
[0m22:32:14.871593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:32:14.872490 [info ] [MainThread]: 
[0m22:32:14.878249 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:32:14.879392 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:32:14.880780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:32:14.881646 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:32:14.900479 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:32:14.901987 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:32:14.972180 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:32:14.973765 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:32:14.974516 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:32:14.975179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:14.984574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:32:14.985338 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:32:14.985971 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:32:14.989099 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:32:14.999893 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:32:15.000637 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:32:15.002015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.006618 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:32:15.007326 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:32:15.008534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.045884 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:32:15.047495 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:32:15.048866 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:32:15.053179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:32:15.067873 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:32:15.078864 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:32:15.080063 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:32:15.083936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:32:15.088738 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:32:15.092480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e001370>]}
[0m22:32:15.093744 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:32:15.095004 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:32:15.097031 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:32:15.099390 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:32:15.102396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:32:15.104297 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:32:15.123389 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:32:15.126070 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:32:15.136562 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:32:15.139582 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:32:15.140445 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:32:15.141928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:15.151833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:32:15.152757 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:32:15.153634 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:32:15.160428 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:32:15.167909 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:32:15.168749 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m22:32:15.170554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.179468 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:32:15.180673 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:32:15.182338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.186700 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:32:15.188220 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:32:15.189919 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:32:15.191801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:15.197921 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:32:15.200741 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:32:15.201776 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:32:15.206062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:32:15.209844 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:32:15.212342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a2420>]}
[0m22:32:15.213593 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.11s]
[0m22:32:15.215491 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:32:15.217416 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:32:15.218659 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:32:15.219885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:32:15.220958 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:32:15.226464 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:32:15.227746 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:32:15.236600 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:32:15.239356 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:32:15.240239 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:32:15.241706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:15.253728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:32:15.255776 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:32:15.256757 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:32:15.261864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:32:15.268198 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:32:15.268939 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:32:15.270538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.276939 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:32:15.278724 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:32:15.280699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.284667 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:32:15.285747 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:32:15.286777 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:32:15.289249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:15.293404 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:32:15.295538 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:32:15.296377 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:32:15.299377 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:32:15.301826 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:32:15.302935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a2390>]}
[0m22:32:15.304089 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m22:32:15.305485 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:32:15.306296 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:32:15.307231 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:32:15.308232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:32:15.308942 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:32:15.313621 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:32:15.314741 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:32:15.323101 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:32:15.324572 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:32:15.325304 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:32:15.325918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:15.333986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:32:15.334735 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:32:15.335607 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:32:15.340324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column u.username does not exist
LINE 7:     SELECT u.username, 
                   ^
HINT:  Perhaps you meant to reference the column "u. username".

[0m22:32:15.341280 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: ROLLBACK
[0m22:32:15.342343 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:32:15.358038 [debug] [Thread-1 (]: Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:32:15.358873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112849040>]}
[0m22:32:15.359864 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_sales ......................... [[31mERROR[0m in 0.05s]
[0m22:32:15.361036 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:32:15.361801 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:32:15.364040 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:32:15.365026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:32:15.365699 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:32:15.369761 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:32:15.370959 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:32:15.376184 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:32:15.377330 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:32:15.378008 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:32:15.379063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:15.387341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:32:15.388289 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:32:15.388973 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:32:15.396054 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:32:15.400682 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:32:15.401649 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m22:32:15.403241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.407612 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:32:15.408318 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m22:32:15.409506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:32:15.412484 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:32:15.413479 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:32:15.414244 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:32:15.416357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:32:15.422383 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m22:32:15.423852 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:32:15.425016 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m22:32:15.428483 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:32:15.431521 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:32:15.432963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911f73a2-755c-4682-b1d7-c37f952e43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110764080>]}
[0m22:32:15.434572 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m22:32:15.436529 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:32:15.440195 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:15.440954 [debug] [MainThread]: On master: BEGIN
[0m22:32:15.441707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:32:15.452370 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:32:15.453644 [debug] [MainThread]: On master: COMMIT
[0m22:32:15.454742 [debug] [MainThread]: Using postgres connection "master"
[0m22:32:15.455904 [debug] [MainThread]: On master: COMMIT
[0m22:32:15.458266 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:32:15.460518 [debug] [MainThread]: On master: Close
[0m22:32:15.461827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:15.464984 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:32:15.467896 [info ] [MainThread]: 
[0m22:32:15.469107 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m22:32:15.472565 [debug] [MainThread]: Command end result
[0m22:32:15.545484 [info ] [MainThread]: 
[0m22:32:15.546647 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:32:15.547776 [info ] [MainThread]: 
[0m22:32:15.548616 [error] [MainThread]:   Database Error in model user_sales (models/user_sales.sql)
  column u.username does not exist
  LINE 7:     SELECT u.username, 
                     ^
  HINT:  Perhaps you meant to reference the column "u. username".
  compiled code at target/run/think_thrift_project/models/user_sales.sql
[0m22:32:15.549320 [info ] [MainThread]: 
[0m22:32:15.550023 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:32:15.556735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5118272, "process_user_time": 4.847974, "process_kernel_time": 1.045353, "process_mem_max_rss": "113045504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:32:15.558648 [debug] [MainThread]: Command `dbt run` failed at 22:32:15.558406 after 2.52 seconds
[0m22:32:15.560197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6bba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f713d40>]}
[0m22:32:15.566493 [debug] [MainThread]: Flushing usage events
[0m22:33:07.228213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a905220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cc320>]}


============================== 22:33:07.247065 | 7f6abe79-94fa-4864-b089-fe9382978d45 ==============================
[0m22:33:07.247065 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:33:07.249206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/olikelly/.dbt', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:33:07.699450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c494710>]}
[0m22:33:07.793611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef5a30>]}
[0m22:33:07.796359 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:33:07.828261 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:33:08.232664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:33:08.233330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:33:08.294612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca4dd00>]}
[0m22:33:08.491124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b1070>]}
[0m22:33:08.492257 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:33:08.493160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cacb5c0>]}
[0m22:33:08.496161 [info ] [MainThread]: 
[0m22:33:08.497245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:33:08.503890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:33:08.620813 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:33:08.621503 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:33:08.622072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:08.687223 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m22:33:08.689665 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:33:08.693596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:33:08.702853 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:33:08.703516 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:33:08.704045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:08.711904 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:33:08.712865 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:33:08.713851 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:33:08.719348 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:33:08.721669 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:33:08.722599 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:33:08.733875 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:08.734560 [debug] [MainThread]: On master: BEGIN
[0m22:33:08.735093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:08.745131 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:33:08.745824 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:08.746488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:33:08.763940 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m22:33:08.767465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4508f0>]}
[0m22:33:08.768186 [debug] [MainThread]: On master: ROLLBACK
[0m22:33:08.769066 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:08.769678 [debug] [MainThread]: On master: BEGIN
[0m22:33:08.770695 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:33:08.771391 [debug] [MainThread]: On master: COMMIT
[0m22:33:08.771957 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:08.772500 [debug] [MainThread]: On master: COMMIT
[0m22:33:08.774379 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:33:08.776587 [debug] [MainThread]: On master: Close
[0m22:33:08.777712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:33:08.779233 [info ] [MainThread]: 
[0m22:33:08.786500 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.products_seed
[0m22:33:08.788152 [info ] [Thread-1 (]: 1 of 3 START seed file public.products_seed .................................... [RUN]
[0m22:33:08.789967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now seed.think_thrift_project.products_seed)
[0m22:33:08.791796 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.products_seed
[0m22:33:08.793124 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.products_seed
[0m22:33:08.882021 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:33:08.883227 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: BEGIN
[0m22:33:08.884306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:08.894377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:33:08.895745 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:33:08.896782 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.products_seed"} */
truncate table "think-thrift-db"."public"."products_seed"
[0m22:33:08.901365 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m22:33:08.967642 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:33:08.969029 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: 
          insert into "think-thrift-db"."public"."products_seed" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:33:08.973769 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m22:33:08.990430 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.products_seed"
[0m22:33:09.035192 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:33:09.036215 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:33:09.037492 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:33:09.042011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:33:09.046808 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: Close
[0m22:33:09.050981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace95b0>]}
[0m22:33:09.052884 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.products_seed ................................ [[32mINSERT 10[0m in 0.26s]
[0m22:33:09.055031 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.products_seed
[0m22:33:09.056593 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.transactions_seed
[0m22:33:09.058459 [info ] [Thread-1 (]: 2 of 3 START seed file public.transactions_seed ................................ [RUN]
[0m22:33:09.060112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.products_seed, now seed.think_thrift_project.transactions_seed)
[0m22:33:09.061730 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.transactions_seed
[0m22:33:09.063199 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.transactions_seed
[0m22:33:09.081111 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:33:09.082488 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: BEGIN
[0m22:33:09.083789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:09.095754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:33:09.097086 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:33:09.098400 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.transactions_seed"} */
truncate table "think-thrift-db"."public"."transactions_seed"
[0m22:33:09.101457 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m22:33:09.195656 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:33:09.197073 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: 
          insert into "think-thrift-db"."public"."transactions_seed" ("transaction_id", "sale_id", "user_id", "product_id", "quantity", "sale_date") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m22:33:09.201169 [debug] [Thread-1 (]: SQL status: INSERT 0 29 in 0.003 seconds
[0m22:33:09.203303 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.transactions_seed"
[0m22:33:09.208519 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:33:09.209838 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:33:09.211117 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:33:09.215462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:33:09.218201 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: Close
[0m22:33:09.220073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf95c10>]}
[0m22:33:09.221769 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.transactions_seed ............................ [[32mINSERT 29[0m in 0.16s]
[0m22:33:09.224051 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.transactions_seed
[0m22:33:09.225555 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.users_seed
[0m22:33:09.227222 [info ] [Thread-1 (]: 3 of 3 START seed file public.users_seed ....................................... [RUN]
[0m22:33:09.228746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.transactions_seed, now seed.think_thrift_project.users_seed)
[0m22:33:09.229706 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.users_seed
[0m22:33:09.231029 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.users_seed
[0m22:33:09.243119 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:33:09.243977 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: BEGIN
[0m22:33:09.245033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:09.255393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:33:09.256793 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:33:09.258463 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.users_seed"} */
truncate table "think-thrift-db"."public"."users_seed"
[0m22:33:09.264250 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m22:33:09.310517 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:33:09.311525 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: 
          insert into "think-thrift-db"."public"."users_seed" ("user_id", "username", "country", "join_date", "email", "user_rating", "items_sold", "items_bought") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:33:09.315726 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "username" of relation "users_seed" does not exist
LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                             ^

[0m22:33:09.316969 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: ROLLBACK
[0m22:33:09.318662 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: Close
[0m22:33:09.346509 [debug] [Thread-1 (]: Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:33:09.348045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6abe79-94fa-4864-b089-fe9382978d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d50a720>]}
[0m22:33:09.349794 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.users_seed ............................... [[31mERROR[0m in 0.12s]
[0m22:33:09.352122 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.users_seed
[0m22:33:09.363636 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:09.364429 [debug] [MainThread]: On master: BEGIN
[0m22:33:09.365816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:09.376341 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:33:09.377252 [debug] [MainThread]: On master: COMMIT
[0m22:33:09.378965 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:09.380366 [debug] [MainThread]: On master: COMMIT
[0m22:33:09.381905 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:33:09.382741 [debug] [MainThread]: On master: Close
[0m22:33:09.383993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:09.385074 [debug] [MainThread]: Connection 'seed.think_thrift_project.users_seed' was properly closed.
[0m22:33:09.386268 [info ] [MainThread]: 
[0m22:33:09.387587 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m22:33:09.390258 [debug] [MainThread]: Command end result
[0m22:33:09.470245 [info ] [MainThread]: 
[0m22:33:09.471695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:33:09.472455 [info ] [MainThread]: 
[0m22:33:09.473394 [error] [MainThread]:   Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:33:09.474204 [info ] [MainThread]: 
[0m22:33:09.474963 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:33:09.485156 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.4015949, "process_user_time": 4.953824, "process_kernel_time": 0.966784, "process_mem_max_rss": "112803840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:33:09.487118 [debug] [MainThread]: Command `dbt seed` failed at 22:33:09.486726 after 2.40 seconds
[0m22:33:09.488651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b852900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9aec00>]}
[0m22:33:09.489591 [debug] [MainThread]: Flushing usage events
[0m22:34:52.217553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c341a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9c2c0>]}


============================== 22:34:52.236736 | 59ac0314-c011-4309-a280-7bf64a9fbe6a ==============================
[0m22:34:52.236736 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:34:52.238930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:52.752918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d13c80>]}
[0m22:34:52.843809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b59b20>]}
[0m22:34:52.846442 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:34:52.895032 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:34:53.257151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:34:53.258131 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/users.sql
[0m22:34:53.627605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107174380>]}
[0m22:34:53.830760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d1fa0>]}
[0m22:34:53.831991 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:34:53.833277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fecf0>]}
[0m22:34:53.836595 [info ] [MainThread]: 
[0m22:34:53.838044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:53.845514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:34:53.998249 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:34:53.998947 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:34:53.999516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:54.068661 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m22:34:54.071068 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:34:54.075494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:34:54.085238 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:34:54.085944 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:34:54.086669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:54.094836 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:34:54.095563 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:34:54.096163 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:34:54.101455 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m22:34:54.103668 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:34:54.104526 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:34:54.115989 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:54.117282 [debug] [MainThread]: On master: BEGIN
[0m22:34:54.118425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:54.127272 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:34:54.127960 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:54.128623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:54.156359 [debug] [MainThread]: SQL status: SELECT 5 in 0.027 seconds
[0m22:34:54.160530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b96a0>]}
[0m22:34:54.161519 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:54.163110 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:54.164313 [debug] [MainThread]: On master: BEGIN
[0m22:34:54.167158 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:34:54.168273 [debug] [MainThread]: On master: COMMIT
[0m22:34:54.169208 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:54.169877 [debug] [MainThread]: On master: COMMIT
[0m22:34:54.172122 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m22:34:54.173427 [debug] [MainThread]: On master: Close
[0m22:34:54.174818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:54.175830 [info ] [MainThread]: 
[0m22:34:54.189310 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.products_seed
[0m22:34:54.190383 [info ] [Thread-1 (]: 1 of 3 START seed file public.products_seed .................................... [RUN]
[0m22:34:54.191552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now seed.think_thrift_project.products_seed)
[0m22:34:54.192511 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.products_seed
[0m22:34:54.193347 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.products_seed
[0m22:34:54.262866 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:34:54.263642 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: BEGIN
[0m22:34:54.264262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:54.278361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m22:34:54.279751 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:34:54.280608 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.products_seed"} */
truncate table "think-thrift-db"."public"."products_seed"
[0m22:34:54.286267 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m22:34:54.354292 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:34:54.355237 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: 
          insert into "think-thrift-db"."public"."products_seed" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:34:54.358800 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m22:34:54.369437 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.products_seed"
[0m22:34:54.396313 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:34:54.397184 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:34:54.397878 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:34:54.402516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:34:54.410335 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: Close
[0m22:34:54.418799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ad6d0>]}
[0m22:34:54.421920 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.products_seed ................................ [[32mINSERT 10[0m in 0.22s]
[0m22:34:54.424330 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.products_seed
[0m22:34:54.425925 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.transactions_seed
[0m22:34:54.427673 [info ] [Thread-1 (]: 2 of 3 START seed file public.transactions_seed ................................ [RUN]
[0m22:34:54.429681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.products_seed, now seed.think_thrift_project.transactions_seed)
[0m22:34:54.435880 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.transactions_seed
[0m22:34:54.436830 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.transactions_seed
[0m22:34:54.455960 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:34:54.457600 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: BEGIN
[0m22:34:54.458838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:54.469860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:34:54.470656 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:34:54.471347 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.transactions_seed"} */
truncate table "think-thrift-db"."public"."transactions_seed"
[0m22:34:54.484300 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m22:34:54.562937 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:34:54.564092 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: 
          insert into "think-thrift-db"."public"."transactions_seed" ("transaction_id", "sale_id", "user_id", "product_id", "quantity", "sale_date") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m22:34:54.566618 [debug] [Thread-1 (]: SQL status: INSERT 0 29 in 0.002 seconds
[0m22:34:54.567898 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.transactions_seed"
[0m22:34:54.570912 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:34:54.571787 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:34:54.572672 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:34:54.575671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:34:54.577068 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: Close
[0m22:34:54.578219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb1490>]}
[0m22:34:54.580016 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.transactions_seed ............................ [[32mINSERT 29[0m in 0.15s]
[0m22:34:54.582142 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.transactions_seed
[0m22:34:54.583057 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.users_seed
[0m22:34:54.584115 [info ] [Thread-1 (]: 3 of 3 START seed file public.users_seed ....................................... [RUN]
[0m22:34:54.585149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.transactions_seed, now seed.think_thrift_project.users_seed)
[0m22:34:54.586052 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.users_seed
[0m22:34:54.586827 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.users_seed
[0m22:34:54.596702 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:34:54.597459 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: BEGIN
[0m22:34:54.598152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:54.607279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:34:54.608013 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:34:54.608655 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.users_seed"} */
truncate table "think-thrift-db"."public"."users_seed"
[0m22:34:54.612461 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m22:34:54.650668 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:34:54.651589 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: 
          insert into "think-thrift-db"."public"."users_seed" ("user_id", "username", "country", "join_date", "email", "user_rating", "items_sold", "items_bought") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:34:54.654864 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "username" of relation "users_seed" does not exist
LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                             ^

[0m22:34:54.655720 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: ROLLBACK
[0m22:34:54.656960 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: Close
[0m22:34:54.677749 [debug] [Thread-1 (]: Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:34:54.678710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ac0314-c011-4309-a280-7bf64a9fbe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a6360>]}
[0m22:34:54.679854 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.users_seed ............................... [[31mERROR[0m in 0.09s]
[0m22:34:54.684583 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.users_seed
[0m22:34:54.691461 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:54.692403 [debug] [MainThread]: On master: BEGIN
[0m22:34:54.693053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:54.705134 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:34:54.705989 [debug] [MainThread]: On master: COMMIT
[0m22:34:54.706649 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:54.707264 [debug] [MainThread]: On master: COMMIT
[0m22:34:54.708364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:54.709158 [debug] [MainThread]: On master: Close
[0m22:34:54.709989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:54.710614 [debug] [MainThread]: Connection 'seed.think_thrift_project.users_seed' was properly closed.
[0m22:34:54.711258 [info ] [MainThread]: 
[0m22:34:54.712524 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m22:34:54.717256 [debug] [MainThread]: Command end result
[0m22:34:54.791676 [info ] [MainThread]: 
[0m22:34:54.792936 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:54.793760 [info ] [MainThread]: 
[0m22:34:54.794694 [error] [MainThread]:   Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:34:54.795564 [info ] [MainThread]: 
[0m22:34:54.796528 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:34:54.803809 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.7201445, "process_user_time": 5.051427, "process_kernel_time": 0.995112, "process_mem_max_rss": "116101120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:54.806324 [debug] [MainThread]: Command `dbt seed` failed at 22:34:54.806022 after 2.73 seconds
[0m22:34:54.807158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105747170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c28c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9c7d0>]}
[0m22:34:54.807795 [debug] [MainThread]: Flushing usage events
[0m22:38:34.397431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6b7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc90650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc90260>]}


============================== 22:38:34.413803 | b84eafef-4dcf-4777-99b8-4f6471f85b60 ==============================
[0m22:38:34.413803 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:38:34.415483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:34.821745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa9940>]}
[0m22:38:34.935786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b6660>]}
[0m22:38:34.937807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:38:34.974709 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:38:35.294740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:35.295401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:35.355408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cca0590>]}
[0m22:38:35.557988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d878e30>]}
[0m22:38:35.559486 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:38:35.560739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1a0ec0>]}
[0m22:38:35.563981 [info ] [MainThread]: 
[0m22:38:35.565066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:38:35.572001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:38:35.698596 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:38:35.699405 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:38:35.700001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:35.768430 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m22:38:35.770811 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:38:35.774531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:38:35.785673 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:38:35.786422 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:38:35.787051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:35.795457 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:38:35.796157 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:38:35.796788 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:38:35.801707 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:38:35.805187 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:38:35.806594 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:38:35.820906 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:35.821604 [debug] [MainThread]: On master: BEGIN
[0m22:38:35.822184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:35.831434 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:38:35.832179 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:35.832942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:38:35.853332 [debug] [MainThread]: SQL status: SELECT 5 in 0.020 seconds
[0m22:38:35.857234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d211c10>]}
[0m22:38:35.858104 [debug] [MainThread]: On master: ROLLBACK
[0m22:38:35.859120 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:35.860169 [debug] [MainThread]: On master: BEGIN
[0m22:38:35.862264 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:38:35.863277 [debug] [MainThread]: On master: COMMIT
[0m22:38:35.863990 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:35.864586 [debug] [MainThread]: On master: COMMIT
[0m22:38:35.865489 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:38:35.866149 [debug] [MainThread]: On master: Close
[0m22:38:35.867065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:35.868050 [info ] [MainThread]: 
[0m22:38:35.875995 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.products_seed
[0m22:38:35.877739 [info ] [Thread-1 (]: 1 of 3 START seed file public.products_seed .................................... [RUN]
[0m22:38:35.880205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now seed.think_thrift_project.products_seed)
[0m22:38:35.881301 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.products_seed
[0m22:38:35.882596 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.products_seed
[0m22:38:35.944239 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:38:35.945085 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: BEGIN
[0m22:38:35.945764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:35.953871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:38:35.954639 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:38:35.955270 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.products_seed"} */
truncate table "think-thrift-db"."public"."products_seed"
[0m22:38:35.959896 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m22:38:36.006461 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:38:36.007494 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: 
          insert into "think-thrift-db"."public"."products_seed" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:38:36.013102 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m22:38:36.027527 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.products_seed"
[0m22:38:36.054870 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:38:36.055705 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:38:36.056558 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:38:36.060150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:38:36.062788 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: Close
[0m22:38:36.065396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b549460>]}
[0m22:38:36.066552 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.products_seed ................................ [[32mINSERT 10[0m in 0.18s]
[0m22:38:36.067764 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.products_seed
[0m22:38:36.068598 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.transactions_seed
[0m22:38:36.069805 [info ] [Thread-1 (]: 2 of 3 START seed file public.transactions_seed ................................ [RUN]
[0m22:38:36.071447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.products_seed, now seed.think_thrift_project.transactions_seed)
[0m22:38:36.073139 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.transactions_seed
[0m22:38:36.074335 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.transactions_seed
[0m22:38:36.086984 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:38:36.088101 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: BEGIN
[0m22:38:36.089174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:36.100492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:38:36.101449 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:38:36.102235 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.transactions_seed"} */
truncate table "think-thrift-db"."public"."transactions_seed"
[0m22:38:36.104205 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m22:38:36.158908 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:38:36.160016 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: 
          insert into "think-thrift-db"."public"."transactions_seed" ("transaction_id", "sale_id", "user_id", "product_id", "quantity", "sale_date") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m22:38:36.163658 [debug] [Thread-1 (]: SQL status: INSERT 0 29 in 0.002 seconds
[0m22:38:36.164938 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.transactions_seed"
[0m22:38:36.167899 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:38:36.168791 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:38:36.169468 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:38:36.172473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:38:36.173772 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: Close
[0m22:38:36.174850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de260c0>]}
[0m22:38:36.175875 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.transactions_seed ............................ [[32mINSERT 29[0m in 0.10s]
[0m22:38:36.177975 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.transactions_seed
[0m22:38:36.178840 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.users_seed
[0m22:38:36.179793 [info ] [Thread-1 (]: 3 of 3 START seed file public.users_seed ....................................... [RUN]
[0m22:38:36.180681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.transactions_seed, now seed.think_thrift_project.users_seed)
[0m22:38:36.181354 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.users_seed
[0m22:38:36.182249 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.users_seed
[0m22:38:36.191264 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:38:36.192057 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: BEGIN
[0m22:38:36.192873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:36.203350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:38:36.204094 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:38:36.204722 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.users_seed"} */
truncate table "think-thrift-db"."public"."users_seed"
[0m22:38:36.209222 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m22:38:36.247191 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:38:36.248066 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: 
          insert into "think-thrift-db"."public"."users_seed" ("user_id", "username", "country", "join_date", "email", "user_rating", "items_sold", "items_bought") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:38:36.251362 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "username" of relation "users_seed" does not exist
LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                             ^

[0m22:38:36.252216 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: ROLLBACK
[0m22:38:36.253324 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: Close
[0m22:38:36.275546 [debug] [Thread-1 (]: Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:38:36.276342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84eafef-4dcf-4777-99b8-4f6471f85b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de02630>]}
[0m22:38:36.277312 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.users_seed ............................... [[31mERROR[0m in 0.10s]
[0m22:38:36.281215 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.users_seed
[0m22:38:36.285624 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:36.286288 [debug] [MainThread]: On master: BEGIN
[0m22:38:36.286819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:38:36.297219 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:38:36.298805 [debug] [MainThread]: On master: COMMIT
[0m22:38:36.299511 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:36.300137 [debug] [MainThread]: On master: COMMIT
[0m22:38:36.301053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:38:36.301706 [debug] [MainThread]: On master: Close
[0m22:38:36.302773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:36.304942 [debug] [MainThread]: Connection 'seed.think_thrift_project.users_seed' was properly closed.
[0m22:38:36.305664 [info ] [MainThread]: 
[0m22:38:36.306824 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m22:38:36.309407 [debug] [MainThread]: Command end result
[0m22:38:36.364057 [info ] [MainThread]: 
[0m22:38:36.365274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:38:36.366042 [info ] [MainThread]: 
[0m22:38:36.366943 [error] [MainThread]:   Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:38:36.367715 [info ] [MainThread]: 
[0m22:38:36.368541 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:38:36.374079 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.1093874, "process_user_time": 4.227111, "process_kernel_time": 0.921649, "process_mem_max_rss": "113369088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:38:36.375825 [debug] [MainThread]: Command `dbt seed` failed at 22:38:36.375587 after 2.11 seconds
[0m22:38:36.377360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c83a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d90d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb78110>]}
[0m22:38:36.379330 [debug] [MainThread]: Flushing usage events
[0m22:40:53.690498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c37b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c64bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c680170>]}


============================== 22:40:53.707589 | 3c1ebf91-67c4-475a-8bab-a3198befcce8 ==============================
[0m22:40:53.707589 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:40:53.709222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m22:40:54.141645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3a5d0>]}
[0m22:40:54.233008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c10a360>]}
[0m22:40:54.235779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:40:54.275922 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:40:54.519823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:54.520616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:54.579343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5681d0>]}
[0m22:40:54.778638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d269130>]}
[0m22:40:54.780574 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:40:54.782557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc32e10>]}
[0m22:40:54.785958 [info ] [MainThread]: 
[0m22:40:54.787543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:54.794639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:40:54.915356 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:40:54.916043 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:40:54.916665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:54.991618 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.073 seconds
[0m22:40:54.994006 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:40:54.996883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:40:55.007408 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:40:55.008166 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:40:55.008740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:55.016514 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:40:55.017193 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:40:55.017770 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:40:55.024948 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m22:40:55.027118 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:40:55.027947 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:40:55.036751 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:55.037671 [debug] [MainThread]: On master: BEGIN
[0m22:40:55.038368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:55.047510 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:40:55.048242 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:55.048908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:55.065182 [debug] [MainThread]: SQL status: SELECT 4 in 0.016 seconds
[0m22:40:55.068589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c723b90>]}
[0m22:40:55.069925 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:55.071441 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:55.072298 [debug] [MainThread]: On master: BEGIN
[0m22:40:55.073915 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:40:55.075067 [debug] [MainThread]: On master: COMMIT
[0m22:40:55.075661 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:55.076193 [debug] [MainThread]: On master: COMMIT
[0m22:40:55.077016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:55.077819 [debug] [MainThread]: On master: Close
[0m22:40:55.078841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:55.079852 [info ] [MainThread]: 
[0m22:40:55.086355 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.products_seed
[0m22:40:55.089469 [info ] [Thread-1 (]: 1 of 3 START seed file public.products_seed .................................... [RUN]
[0m22:40:55.090695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now seed.think_thrift_project.products_seed)
[0m22:40:55.091563 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.products_seed
[0m22:40:55.092375 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.products_seed
[0m22:40:55.152199 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:40:55.152968 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: BEGIN
[0m22:40:55.153565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:55.161299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:40:55.162036 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:40:55.162654 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.products_seed"} */
truncate table "think-thrift-db"."public"."products_seed"
[0m22:40:55.168854 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m22:40:55.223825 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:40:55.224698 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: 
          insert into "think-thrift-db"."public"."products_seed" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:40:55.228169 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m22:40:55.237418 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.products_seed"
[0m22:40:55.261575 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:40:55.262556 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:40:55.263216 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:40:55.266875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:40:55.271732 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: Close
[0m22:40:55.276030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af39520>]}
[0m22:40:55.277560 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.products_seed ................................ [[32mINSERT 10[0m in 0.18s]
[0m22:40:55.279234 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.products_seed
[0m22:40:55.280089 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.transactions_seed
[0m22:40:55.281135 [info ] [Thread-1 (]: 2 of 3 START seed file public.transactions_seed ................................ [RUN]
[0m22:40:55.282140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.products_seed, now seed.think_thrift_project.transactions_seed)
[0m22:40:55.282826 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.transactions_seed
[0m22:40:55.283471 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.transactions_seed
[0m22:40:55.295580 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:40:55.296289 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: BEGIN
[0m22:40:55.296885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:55.307034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:40:55.307789 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:40:55.308418 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.transactions_seed"} */
truncate table "think-thrift-db"."public"."transactions_seed"
[0m22:40:55.310141 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m22:40:55.361964 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:40:55.362716 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: 
          insert into "think-thrift-db"."public"."transactions_seed" ("transaction_id", "sale_id", "user_id", "product_id", "quantity", "sale_date") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m22:40:55.365042 [debug] [Thread-1 (]: SQL status: INSERT 0 29 in 0.002 seconds
[0m22:40:55.366292 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.transactions_seed"
[0m22:40:55.369447 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:40:55.370215 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:40:55.370865 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:40:55.374354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:40:55.376034 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: Close
[0m22:40:55.377061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6de030>]}
[0m22:40:55.378011 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.transactions_seed ............................ [[32mINSERT 29[0m in 0.09s]
[0m22:40:55.379858 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.transactions_seed
[0m22:40:55.381233 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.users_seed
[0m22:40:55.382286 [info ] [Thread-1 (]: 3 of 3 START seed file public.users_seed ....................................... [RUN]
[0m22:40:55.383442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.transactions_seed, now seed.think_thrift_project.users_seed)
[0m22:40:55.384120 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.users_seed
[0m22:40:55.385033 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.users_seed
[0m22:40:55.393223 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:40:55.393937 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: BEGIN
[0m22:40:55.394525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:55.402241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:40:55.403117 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:40:55.403919 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.users_seed"} */
truncate table "think-thrift-db"."public"."users_seed"
[0m22:40:55.409286 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m22:40:55.440045 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:40:55.441271 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: 
          insert into "think-thrift-db"."public"."users_seed" ("user_id", "username", "country", "join_date", "email", "user_rating", "items_sold", "items_bought") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:40:55.444304 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "username" of relation "users_seed" does not exist
LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                             ^

[0m22:40:55.445271 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: ROLLBACK
[0m22:40:55.446357 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: Close
[0m22:40:55.465887 [debug] [Thread-1 (]: Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:40:55.466669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c1ebf91-67c4-475a-8bab-a3198befcce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc00f80>]}
[0m22:40:55.467482 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.users_seed ............................... [[31mERROR[0m in 0.08s]
[0m22:40:55.469015 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.users_seed
[0m22:40:55.478108 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:55.478913 [debug] [MainThread]: On master: BEGIN
[0m22:40:55.479508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:55.488328 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:40:55.489130 [debug] [MainThread]: On master: COMMIT
[0m22:40:55.489973 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:55.490982 [debug] [MainThread]: On master: COMMIT
[0m22:40:55.492367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:55.493045 [debug] [MainThread]: On master: Close
[0m22:40:55.494115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:55.495598 [debug] [MainThread]: Connection 'seed.think_thrift_project.users_seed' was properly closed.
[0m22:40:55.496552 [info ] [MainThread]: 
[0m22:40:55.497348 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m22:40:55.499047 [debug] [MainThread]: Command end result
[0m22:40:55.559253 [info ] [MainThread]: 
[0m22:40:55.560683 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:40:55.561802 [info ] [MainThread]: 
[0m22:40:55.562913 [error] [MainThread]:   Database Error in seed users_seed (seeds/users_seed.csv)
  column "username" of relation "users_seed" does not exist
  LINE 2: ...hink-thrift-db"."public"."users_seed" ("user_id", "username"...
                                                               ^
[0m22:40:55.563711 [info ] [MainThread]: 
[0m22:40:55.565151 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:40:55.574360 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.0149574, "process_user_time": 4.270457, "process_kernel_time": 0.981824, "process_mem_max_rss": "112893952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:40:55.575883 [debug] [MainThread]: Command `dbt seed` failed at 22:40:55.575643 after 2.02 seconds
[0m22:40:55.576693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c64bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb5e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0cacc0>]}
[0m22:40:55.577365 [debug] [MainThread]: Flushing usage events
[0m22:43:01.640003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b74080>]}


============================== 22:43:01.653723 | 1b247215-9157-4d27-a667-e4c2ea9863bd ==============================
[0m22:43:01.653723 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:43:01.655999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:43:02.021864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8bef0>]}
[0m22:43:02.112284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fdd30>]}
[0m22:43:02.114784 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:43:02.156326 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:43:02.504781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:02.505647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:02.561181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109096c00>]}
[0m22:43:02.754891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109758e00>]}
[0m22:43:02.756293 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:43:02.758101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109776000>]}
[0m22:43:02.762668 [info ] [MainThread]: 
[0m22:43:02.764135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:02.771011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:43:02.899750 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:43:02.900449 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:43:02.901029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:02.960530 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.059 seconds
[0m22:43:02.963236 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:43:02.966946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:43:02.976903 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:43:02.977633 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:43:02.978449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:02.986299 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:43:02.987099 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:43:02.987752 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:02.992834 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m22:43:02.995546 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:43:02.996474 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:43:03.005067 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:03.005751 [debug] [MainThread]: On master: BEGIN
[0m22:43:03.006286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:03.014548 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:43:03.015538 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:03.016735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:03.033867 [debug] [MainThread]: SQL status: SELECT 4 in 0.016 seconds
[0m22:43:03.037277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cee40>]}
[0m22:43:03.038076 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:03.038921 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:03.039512 [debug] [MainThread]: On master: BEGIN
[0m22:43:03.040574 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:43:03.041264 [debug] [MainThread]: On master: COMMIT
[0m22:43:03.041834 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:03.042442 [debug] [MainThread]: On master: COMMIT
[0m22:43:03.043643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:03.044503 [debug] [MainThread]: On master: Close
[0m22:43:03.046705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:03.047581 [info ] [MainThread]: 
[0m22:43:03.053213 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.products_seed
[0m22:43:03.054679 [info ] [Thread-1 (]: 1 of 3 START seed file public.products_seed .................................... [RUN]
[0m22:43:03.055812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now seed.think_thrift_project.products_seed)
[0m22:43:03.056522 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.products_seed
[0m22:43:03.057171 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.products_seed
[0m22:43:03.117358 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:43:03.118096 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: BEGIN
[0m22:43:03.118755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:03.126835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:43:03.127626 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:43:03.128258 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.products_seed"} */
truncate table "think-thrift-db"."public"."products_seed"
[0m22:43:03.131764 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m22:43:03.171926 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:43:03.172703 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: 
          insert into "think-thrift-db"."public"."products_seed" ("product_id", "product_name", "category", "price") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:43:03.174715 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m22:43:03.183766 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.products_seed"
[0m22:43:03.207757 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:43:03.208527 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.products_seed"
[0m22:43:03.209151 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: COMMIT
[0m22:43:03.212720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m22:43:03.215342 [debug] [Thread-1 (]: On seed.think_thrift_project.products_seed: Close
[0m22:43:03.217869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742d3d0>]}
[0m22:43:03.219075 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.products_seed ................................ [[32mINSERT 10[0m in 0.16s]
[0m22:43:03.220495 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.products_seed
[0m22:43:03.221292 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.transactions_seed
[0m22:43:03.222279 [info ] [Thread-1 (]: 2 of 3 START seed file public.transactions_seed ................................ [RUN]
[0m22:43:03.223339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.products_seed, now seed.think_thrift_project.transactions_seed)
[0m22:43:03.224064 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.transactions_seed
[0m22:43:03.224716 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.transactions_seed
[0m22:43:03.235780 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:43:03.236518 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: BEGIN
[0m22:43:03.237129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:03.245184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:43:03.246285 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:43:03.247288 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.transactions_seed"} */
truncate table "think-thrift-db"."public"."transactions_seed"
[0m22:43:03.249512 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m22:43:03.324365 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:43:03.325287 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: 
          insert into "think-thrift-db"."public"."transactions_seed" ("transaction_id", "sale_id", "user_id", "product_id", "quantity", "sale_date") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%...
[0m22:43:03.328584 [debug] [Thread-1 (]: SQL status: INSERT 0 29 in 0.002 seconds
[0m22:43:03.329903 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.transactions_seed"
[0m22:43:03.333651 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:43:03.334736 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.transactions_seed"
[0m22:43:03.336161 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: COMMIT
[0m22:43:03.339807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:03.341114 [debug] [Thread-1 (]: On seed.think_thrift_project.transactions_seed: Close
[0m22:43:03.342297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbb8f0>]}
[0m22:43:03.343590 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file public.transactions_seed ............................ [[32mINSERT 29[0m in 0.12s]
[0m22:43:03.345207 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.transactions_seed
[0m22:43:03.346003 [debug] [Thread-1 (]: Began running node seed.think_thrift_project.users_seed
[0m22:43:03.346961 [info ] [Thread-1 (]: 3 of 3 START seed file public.users_seed ....................................... [RUN]
[0m22:43:03.348140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.think_thrift_project.transactions_seed, now seed.think_thrift_project.users_seed)
[0m22:43:03.348833 [debug] [Thread-1 (]: Began compiling node seed.think_thrift_project.users_seed
[0m22:43:03.349471 [debug] [Thread-1 (]: Began executing node seed.think_thrift_project.users_seed
[0m22:43:03.369295 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:43:03.370033 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: BEGIN
[0m22:43:03.370636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:03.381373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:03.382616 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:43:03.383328 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "seed.think_thrift_project.users_seed"} */

    create table "think-thrift-db"."public"."users_seed" ("user_id" integer,"username" text,"country" text,"join_date" date,"email" text,"user_rating" float8,"items_sold" integer,"items_bought" integer)
  
[0m22:43:03.389499 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m22:43:03.430910 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:43:03.431762 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: 
          insert into "think-thrift-db"."public"."users_seed" ("user_id", "username", "country", "join_date", "email", "user_rating", "items_sold", "items_bought") values
          (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s)
      ...
[0m22:43:03.434087 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m22:43:03.435597 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.think_thrift_project.users_seed"
[0m22:43:03.449541 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: COMMIT
[0m22:43:03.450800 [debug] [Thread-1 (]: Using postgres connection "seed.think_thrift_project.users_seed"
[0m22:43:03.451863 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: COMMIT
[0m22:43:03.454292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:43:03.455940 [debug] [Thread-1 (]: On seed.think_thrift_project.users_seed: Close
[0m22:43:03.457298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b247215-9157-4d27-a667-e4c2ea9863bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbb950>]}
[0m22:43:03.458760 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.users_seed ................................... [[32mINSERT 10[0m in 0.11s]
[0m22:43:03.460764 [debug] [Thread-1 (]: Finished running node seed.think_thrift_project.users_seed
[0m22:43:03.462962 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:03.463752 [debug] [MainThread]: On master: BEGIN
[0m22:43:03.464429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:03.481235 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m22:43:03.482221 [debug] [MainThread]: On master: COMMIT
[0m22:43:03.482972 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:03.484353 [debug] [MainThread]: On master: COMMIT
[0m22:43:03.485549 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:03.487084 [debug] [MainThread]: On master: Close
[0m22:43:03.488517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:03.489588 [debug] [MainThread]: Connection 'seed.think_thrift_project.users_seed' was properly closed.
[0m22:43:03.490831 [info ] [MainThread]: 
[0m22:43:03.492178 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m22:43:03.502359 [debug] [MainThread]: Command end result
[0m22:43:03.564632 [info ] [MainThread]: 
[0m22:43:03.566071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:03.567104 [info ] [MainThread]: 
[0m22:43:03.568140 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:43:03.573871 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.0569744, "process_user_time": 4.34934, "process_kernel_time": 0.913463, "process_mem_max_rss": "113102848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:03.581729 [debug] [MainThread]: Command `dbt seed` succeeded at 22:43:03.581405 after 2.06 seconds
[0m22:43:03.582807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ea330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f6db0>]}
[0m22:43:03.583819 [debug] [MainThread]: Flushing usage events
[0m22:43:18.422309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d16060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107624650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107626150>]}


============================== 22:43:18.434969 | 69633b44-22dd-4029-bfad-d17776bd7602 ==============================
[0m22:43:18.434969 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:43:18.436374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:18.741533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c53f20>]}
[0m22:43:18.829061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b6a80>]}
[0m22:43:18.831630 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:43:18.866147 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:43:19.265730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:19.266388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:19.319253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c51040>]}
[0m22:43:19.590649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093853a0>]}
[0m22:43:19.591457 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:43:19.592213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cbe270>]}
[0m22:43:19.595347 [info ] [MainThread]: 
[0m22:43:19.596488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:19.603378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:43:19.733802 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:43:19.734525 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:43:19.735168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:19.782274 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m22:43:19.784877 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:43:19.787955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:43:19.797623 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:43:19.798386 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:43:19.799145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:19.807186 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:43:19.807870 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:43:19.808449 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:19.813600 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m22:43:19.815836 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:43:19.816689 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:43:19.825085 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:19.826134 [debug] [MainThread]: On master: BEGIN
[0m22:43:19.827012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:19.836496 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:43:19.837184 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:19.837850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:19.854331 [debug] [MainThread]: SQL status: SELECT 4 in 0.016 seconds
[0m22:43:19.857643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b5fd0>]}
[0m22:43:19.858369 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:19.859216 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:19.859817 [debug] [MainThread]: On master: BEGIN
[0m22:43:19.861029 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:19.861884 [debug] [MainThread]: On master: COMMIT
[0m22:43:19.863603 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:19.864398 [debug] [MainThread]: On master: COMMIT
[0m22:43:19.865728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:19.867112 [debug] [MainThread]: On master: Close
[0m22:43:19.868334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:19.869098 [info ] [MainThread]: 
[0m22:43:19.874006 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:43:19.874948 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:43:19.876076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:43:19.877058 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:43:19.891430 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:43:19.892647 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:43:19.956124 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:43:19.957982 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:19.959438 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:43:19.961039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:19.970781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:43:19.971615 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:19.972397 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:43:19.976519 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:43:19.994134 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:19.997554 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:43:20.001590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.009847 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:20.010793 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:43:20.013791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.050605 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:43:20.051373 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:20.052100 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:43:20.054359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:43:20.063487 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:43:20.071463 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:20.072192 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:43:20.075054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:43:20.078748 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:43:20.081271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973ecc0>]}
[0m22:43:20.082450 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m22:43:20.083721 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:43:20.084508 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:43:20.085472 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:43:20.086392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:43:20.087077 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:43:20.093460 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:43:20.094668 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:43:20.101181 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:43:20.102365 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:20.103027 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:43:20.103671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:20.111279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:43:20.112485 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:20.114228 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:43:20.118874 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:43:20.123865 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:20.124620 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m22:43:20.125887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.131699 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:20.132934 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:43:20.134617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.137214 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:43:20.137885 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:20.138497 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:43:20.140732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:43:20.145016 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:43:20.147629 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:20.148915 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:43:20.152122 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:43:20.154479 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:43:20.155515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702000>]}
[0m22:43:20.156587 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:43:20.157975 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:43:20.158801 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:43:20.159739 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:43:20.160771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:43:20.161799 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:43:20.167162 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:43:20.169205 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:43:20.174555 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:43:20.175743 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:20.176435 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:43:20.177038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:20.187720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:20.188488 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:20.189170 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:43:20.192112 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:20.198608 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:20.199768 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:43:20.201907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.206415 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:20.207130 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:43:20.208301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.211052 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:43:20.211943 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:20.214289 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:43:20.217298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:20.220638 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:43:20.221940 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:20.222582 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:43:20.225670 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:43:20.228984 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:43:20.230787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c91c0>]}
[0m22:43:20.231889 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m22:43:20.233479 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:43:20.234398 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:43:20.235342 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:43:20.236284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:43:20.236955 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:43:20.249362 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:43:20.250508 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:43:20.257231 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:43:20.258426 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:20.259101 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:43:20.259771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:20.269289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:43:20.270053 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:20.270702 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:43:20.281669 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m22:43:20.286449 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:20.287156 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m22:43:20.288386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:20.290848 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m22:43:20.291545 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:20.292156 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m22:43:20.295394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:20.300338 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m22:43:20.301616 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:20.302280 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m22:43:20.303315 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:20.305407 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:43:20.306919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bb170>]}
[0m22:43:20.308062 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m22:43:20.309568 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:43:20.310346 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:43:20.311582 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:43:20.313681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:43:20.314434 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:43:20.321679 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:43:20.322903 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:43:20.331081 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:43:20.332571 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:20.333440 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:43:20.334247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:20.342144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:43:20.342910 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:20.343543 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    drop table if exists "think-thrift-db"."public"."users_seed";

SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:43:20.346944 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "drop"
LINE 7:     drop table if exists "think-thrift-db"."public"."users_s...
            ^

[0m22:43:20.347821 [debug] [Thread-1 (]: On model.think_thrift_project.users: ROLLBACK
[0m22:43:20.349555 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:43:20.370933 [debug] [Thread-1 (]: Database Error in model users (models/users.sql)
  syntax error at or near "drop"
  LINE 7:     drop table if exists "think-thrift-db"."public"."users_s...
              ^
  compiled code at target/run/think_thrift_project/models/users.sql
[0m22:43:20.371721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69633b44-22dd-4029-bfad-d17776bd7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109861d30>]}
[0m22:43:20.372636 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model public.users .............................. [[31mERROR[0m in 0.06s]
[0m22:43:20.373796 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:43:20.376512 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:20.377160 [debug] [MainThread]: On master: BEGIN
[0m22:43:20.377718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:20.387990 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:43:20.388677 [debug] [MainThread]: On master: COMMIT
[0m22:43:20.389226 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:20.389759 [debug] [MainThread]: On master: COMMIT
[0m22:43:20.390707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:20.391505 [debug] [MainThread]: On master: Close
[0m22:43:20.392696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:20.393469 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:43:20.395440 [info ] [MainThread]: 
[0m22:43:20.397363 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m22:43:20.400131 [debug] [MainThread]: Command end result
[0m22:43:20.465665 [info ] [MainThread]: 
[0m22:43:20.466933 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:43:20.467908 [info ] [MainThread]: 
[0m22:43:20.468784 [error] [MainThread]:   Database Error in model users (models/users.sql)
  syntax error at or near "drop"
  LINE 7:     drop table if exists "think-thrift-db"."public"."users_s...
              ^
  compiled code at target/run/think_thrift_project/models/users.sql
[0m22:43:20.469664 [info ] [MainThread]: 
[0m22:43:20.470510 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:43:20.483516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.181344, "process_user_time": 3.902484, "process_kernel_time": 0.712579, "process_mem_max_rss": "113008640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:20.486567 [debug] [MainThread]: Command `dbt run` failed at 22:43:20.485883 after 2.18 seconds
[0m22:43:20.488001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10433adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973c4a0>]}
[0m22:43:20.488865 [debug] [MainThread]: Flushing usage events
[0m22:43:49.411664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119dfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba0110>]}


============================== 22:43:49.425497 | df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7 ==============================
[0m22:43:49.425497 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:43:49.427148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:49.890375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119de120>]}
[0m22:43:49.996524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a880e0>]}
[0m22:43:50.000577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:43:50.040662 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:43:50.349811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:50.350930 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/users.sql
[0m22:43:50.768433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e94c0>]}
[0m22:43:50.957048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112797a70>]}
[0m22:43:50.957873 [info ] [MainThread]: Found 3 seeds, 5 models, 423 macros
[0m22:43:50.958653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ae240>]}
[0m22:43:50.961938 [info ] [MainThread]: 
[0m22:43:50.963354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:43:50.973054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m22:43:51.091033 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m22:43:51.091733 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m22:43:51.092301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:51.173718 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.081 seconds
[0m22:43:51.178836 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m22:43:51.191088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m22:43:51.218179 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:43:51.220430 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m22:43:51.221814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:51.235540 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m22:43:51.236651 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m22:43:51.238407 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:43:51.247173 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:43:51.253244 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m22:43:51.254410 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m22:43:51.270248 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:51.271034 [debug] [MainThread]: On master: BEGIN
[0m22:43:51.271685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:43:51.279926 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:43:51.280805 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:51.283270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:43:51.303989 [debug] [MainThread]: SQL status: SELECT 7 in 0.019 seconds
[0m22:43:51.311068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112644a10>]}
[0m22:43:51.311944 [debug] [MainThread]: On master: ROLLBACK
[0m22:43:51.314401 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:51.316899 [debug] [MainThread]: On master: BEGIN
[0m22:43:51.319688 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:43:51.320573 [debug] [MainThread]: On master: COMMIT
[0m22:43:51.321476 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:51.322206 [debug] [MainThread]: On master: COMMIT
[0m22:43:51.323121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:51.323873 [debug] [MainThread]: On master: Close
[0m22:43:51.325287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:51.326644 [info ] [MainThread]: 
[0m22:43:51.336857 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m22:43:51.338922 [info ] [Thread-1 (]: 1 of 5 START sql view model public.products .................................... [RUN]
[0m22:43:51.340128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m22:43:51.340949 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m22:43:51.360866 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m22:43:51.364533 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m22:43:51.445751 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m22:43:51.449454 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:51.450386 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m22:43:51.451137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:51.465883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m22:43:51.467681 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:51.470465 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m22:43:51.487805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:43:51.524456 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:51.525813 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m22:43:51.527458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.535631 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:51.536352 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m22:43:51.537583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:51.568377 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:43:51.569157 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:51.569802 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m22:43:51.572190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:43:51.583392 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m22:43:51.591490 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m22:43:51.592230 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m22:43:51.595483 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m22:43:51.602162 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m22:43:51.605091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110451700>]}
[0m22:43:51.606351 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:43:51.607566 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m22:43:51.608361 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m22:43:51.609332 [info ] [Thread-1 (]: 2 of 5 START sql view model public.top_selling_products ........................ [RUN]
[0m22:43:51.610435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m22:43:51.611171 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m22:43:51.617969 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m22:43:51.619697 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m22:43:51.624651 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m22:43:51.625839 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:51.626685 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m22:43:51.627315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:51.639868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:43:51.640633 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:51.641279 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m22:43:51.645001 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:43:51.654019 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:51.654908 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m22:43:51.656256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.660660 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:51.661385 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m22:43:51.662755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.668429 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:43:51.669167 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:51.669781 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m22:43:51.672276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:51.677552 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m22:43:51.678844 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m22:43:51.679965 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m22:43:51.685175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:43:51.687555 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m22:43:51.688627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7b0b0>]}
[0m22:43:51.689724 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.08s]
[0m22:43:51.691301 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m22:43:51.692146 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m22:43:51.693089 [info ] [Thread-1 (]: 3 of 5 START sql view model public.transactions ................................ [RUN]
[0m22:43:51.693959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m22:43:51.694626 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m22:43:51.700819 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m22:43:51.702450 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m22:43:51.708816 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m22:43:51.710017 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:51.710708 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m22:43:51.711347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:51.723887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:43:51.724904 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:51.725979 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m22:43:51.729699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:51.737431 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:51.738906 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m22:43:51.742390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.749522 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:51.750688 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m22:43:51.752014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:43:51.754946 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:43:51.755674 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:51.756291 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m22:43:51.758499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:43:51.761823 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m22:43:51.764104 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m22:43:51.766390 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m22:43:51.769680 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:43:51.772030 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m22:43:51.773054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dadf10>]}
[0m22:43:51.774111 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m22:43:51.775540 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m22:43:51.776341 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m22:43:51.777254 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_sales .................................. [RUN]
[0m22:43:51.778141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m22:43:51.778971 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m22:43:51.785547 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m22:43:51.787004 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m22:43:51.792145 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m22:43:51.793334 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:51.794024 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m22:43:51.794668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:51.805606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m22:43:51.806489 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:51.807416 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m22:43:51.812285 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:43:51.820799 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:51.821537 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m22:43:51.822779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.826998 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:51.827737 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m22:43:51.828932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.834133 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m22:43:51.835501 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:51.836202 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m22:43:51.838417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:43:51.842257 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m22:43:51.843660 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m22:43:51.844348 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m22:43:51.850002 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m22:43:51.852632 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m22:43:51.853680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7b920>]}
[0m22:43:51.854815 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m22:43:51.856277 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m22:43:51.857194 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m22:43:51.858124 [info ] [Thread-1 (]: 5 of 5 START sql view model public.users ....................................... [RUN]
[0m22:43:51.859235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m22:43:51.859940 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m22:43:51.864723 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m22:43:51.866837 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m22:43:51.874500 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m22:43:51.876017 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:51.876949 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m22:43:51.878038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:51.889675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:43:51.890433 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:51.891181 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m22:43:51.894256 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:43:51.901948 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:51.903207 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m22:43:51.905141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:43:51.907658 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:43:51.908353 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:51.908960 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m22:43:51.911246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:43:51.918442 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m22:43:51.919789 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m22:43:51.920504 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m22:43:51.921632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:43:51.924275 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m22:43:51.925363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df032f8e-7a3f-46c9-8bd9-8ee3c3643bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d99fd0>]}
[0m22:43:51.926453 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m22:43:51.928000 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m22:43:51.930219 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:51.932041 [debug] [MainThread]: On master: BEGIN
[0m22:43:51.933408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:43:51.943312 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m22:43:51.944003 [debug] [MainThread]: On master: COMMIT
[0m22:43:51.944557 [debug] [MainThread]: Using postgres connection "master"
[0m22:43:51.945095 [debug] [MainThread]: On master: COMMIT
[0m22:43:51.946086 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:43:51.946980 [debug] [MainThread]: On master: Close
[0m22:43:51.949661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:51.950726 [debug] [MainThread]: Connection 'model.think_thrift_project.users' was properly closed.
[0m22:43:51.952039 [info ] [MainThread]: 
[0m22:43:51.953383 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m22:43:51.956917 [debug] [MainThread]: Command end result
[0m22:43:52.039302 [info ] [MainThread]: 
[0m22:43:52.040400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:52.041248 [info ] [MainThread]: 
[0m22:43:52.042459 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:43:52.046488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7758832, "process_user_time": 4.688928, "process_kernel_time": 0.851927, "process_mem_max_rss": "116129792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:52.049319 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:52.049047 after 2.78 seconds
[0m22:43:52.050607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ba0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d83edb0>]}
[0m22:43:52.051498 [debug] [MainThread]: Flushing usage events
[0m23:34:37.921489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7e3fe0>]}


============================== 23:34:37.940800 | 0f742706-b723-426b-91ca-8790cb56bd2d ==============================
[0m23:34:37.940800 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:34:37.942402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:34:38.462473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92dd00>]}
[0m23:34:38.565257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d897980>]}
[0m23:34:38.568125 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:38.605852 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:34:38.910315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:34:38.911198 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/users_since_2022.sql
[0m23:34:39.347781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f82c0>]}
[0m23:34:39.560297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92ff20>]}
[0m23:34:39.561147 [info ] [MainThread]: Found 3 seeds, 6 models, 423 macros
[0m23:34:39.561911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc3fe0>]}
[0m23:34:39.565452 [info ] [MainThread]: 
[0m23:34:39.567906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:39.577592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:34:39.700262 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:34:39.701819 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:34:39.702542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:39.788902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.085 seconds
[0m23:34:39.792138 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:34:39.795058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:34:39.805882 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:34:39.806613 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:34:39.807183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:39.817311 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m23:34:39.817989 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:34:39.818575 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:34:39.824819 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m23:34:39.827509 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:34:39.828786 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:34:39.839228 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.840591 [debug] [MainThread]: On master: BEGIN
[0m23:34:39.841699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:39.852583 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:34:39.853949 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.855110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:39.882481 [debug] [MainThread]: SQL status: SELECT 8 in 0.026 seconds
[0m23:34:39.893130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8de7b0>]}
[0m23:34:39.894404 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:39.895596 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.896439 [debug] [MainThread]: On master: BEGIN
[0m23:34:39.897864 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:34:39.899404 [debug] [MainThread]: On master: COMMIT
[0m23:34:39.900892 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.901630 [debug] [MainThread]: On master: COMMIT
[0m23:34:39.902755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:39.903884 [debug] [MainThread]: On master: Close
[0m23:34:39.905750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:34:39.907254 [info ] [MainThread]: 
[0m23:34:39.916056 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:34:39.917512 [info ] [Thread-1 (]: 1 of 6 START sql view model public.products .................................... [RUN]
[0m23:34:39.918609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m23:34:39.919605 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:34:39.939712 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:34:39.942009 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:34:40.015295 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:34:40.017181 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:34:40.017908 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:34:40.018522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:40.026611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:34:40.027359 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:34:40.028205 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:34:40.035395 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:34:40.046793 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:34:40.047872 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:34:40.049867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.054292 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:34:40.055004 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:34:40.056533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.097922 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:34:40.098831 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:34:40.100089 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:34:40.104375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:34:40.115199 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:34:40.123897 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:34:40.125526 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:34:40.128641 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:34:40.133071 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:34:40.135744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c56d0>]}
[0m23:34:40.137287 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.22s]
[0m23:34:40.139477 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:34:40.140339 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:34:40.141316 [info ] [Thread-1 (]: 2 of 6 START sql view model public.top_selling_products ........................ [RUN]
[0m23:34:40.142310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:34:40.143009 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:34:40.151544 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:34:40.153243 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:34:40.158610 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:34:40.161330 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:34:40.165175 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:34:40.166664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:40.175790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:34:40.176677 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:34:40.177361 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:34:40.189173 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:34:40.197758 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:34:40.198820 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:34:40.200878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.205038 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:34:40.205751 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:34:40.207521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.211666 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:34:40.212397 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:34:40.213012 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:34:40.215366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:34:40.219895 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:34:40.221311 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:34:40.222021 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:34:40.225057 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:34:40.227271 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:34:40.228366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8ffd10>]}
[0m23:34:40.229476 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.09s]
[0m23:34:40.231025 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:34:40.232131 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:34:40.233970 [info ] [Thread-1 (]: 3 of 6 START sql view model public.transactions ................................ [RUN]
[0m23:34:40.235027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:34:40.235725 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:34:40.239979 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:34:40.242144 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:34:40.251261 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:34:40.252865 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:34:40.253949 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:34:40.255149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:40.264695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:34:40.265780 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:34:40.267297 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:34:40.272810 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:34:40.279045 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:34:40.279830 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:34:40.281541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.286652 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:34:40.287402 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:34:40.288887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.292799 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:34:40.293536 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:34:40.294147 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:34:40.296656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:34:40.302025 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:34:40.303453 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:34:40.304178 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:34:40.307283 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:34:40.309815 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:34:40.310915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea12810>]}
[0m23:34:40.312057 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:34:40.313701 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:34:40.314826 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:34:40.316072 [info ] [Thread-1 (]: 4 of 6 START sql view model public.user_sales .................................. [RUN]
[0m23:34:40.318354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:34:40.319339 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:34:40.325365 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:34:40.328198 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:34:40.334398 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:34:40.335579 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:34:40.336339 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:34:40.337176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:40.347816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:34:40.348960 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:34:40.350513 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:34:40.358010 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:34:40.363874 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:34:40.364879 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:34:40.366954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.371345 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:34:40.372052 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:34:40.373867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.378513 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:34:40.379245 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:34:40.379855 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:34:40.382329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:34:40.386454 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:34:40.387793 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:34:40.388545 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:34:40.393578 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:34:40.396484 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:34:40.397863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e8fb0>]}
[0m23:34:40.399775 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m23:34:40.403823 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:34:40.408277 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:34:40.409904 [info ] [Thread-1 (]: 5 of 6 START sql view model public.users ....................................... [RUN]
[0m23:34:40.411952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:34:40.412869 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:34:40.420820 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:34:40.422213 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:34:40.438840 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:34:40.443569 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:34:40.444484 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:34:40.445265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:40.459590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:34:40.460793 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:34:40.461726 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:34:40.468152 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:34:40.483943 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:34:40.484870 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:34:40.486305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.494708 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:34:40.495622 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:34:40.497175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.502236 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:34:40.508347 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:34:40.509835 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:34:40.512525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:34:40.517881 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:34:40.519257 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:34:40.519916 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:34:40.522853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:34:40.526421 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:34:40.527501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9fbb00>]}
[0m23:34:40.528607 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:34:40.530831 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:34:40.533682 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:34:40.534572 [info ] [Thread-1 (]: 6 of 6 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:34:40.536321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.users_since_2022)
[0m23:34:40.537055 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:34:40.545108 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:34:40.546471 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:34:40.552063 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:34:40.553366 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:34:40.554239 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:34:40.554867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:40.568795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:34:40.570080 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:34:40.571503 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:34:40.582489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:34:40.590226 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:34:40.591069 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:34:40.593193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:34:40.596680 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:34:40.598318 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:34:40.600020 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:34:40.603411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:34:40.609013 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:34:40.610853 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:34:40.611729 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:34:40.612988 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:34:40.615547 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:34:40.617724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f742706-b723-426b-91ca-8790cb56bd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d902870>]}
[0m23:34:40.619021 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:34:40.620439 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:34:40.623138 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:40.623821 [debug] [MainThread]: On master: BEGIN
[0m23:34:40.624355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:40.634253 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:34:40.634980 [debug] [MainThread]: On master: COMMIT
[0m23:34:40.635792 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:40.636408 [debug] [MainThread]: On master: COMMIT
[0m23:34:40.637273 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:40.637883 [debug] [MainThread]: On master: Close
[0m23:34:40.638791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:40.639459 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:34:40.640191 [info ] [MainThread]: 
[0m23:34:40.641430 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m23:34:40.645147 [debug] [MainThread]: Command end result
[0m23:34:40.780681 [info ] [MainThread]: 
[0m23:34:40.782475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:40.784044 [info ] [MainThread]: 
[0m23:34:40.785802 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:34:40.797901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.030328, "process_user_time": 4.841543, "process_kernel_time": 1.078981, "process_mem_max_rss": "115548160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:40.799492 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:40.799101 after 3.03 seconds
[0m23:34:40.800692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2669f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d265eb0>]}
[0m23:34:40.801417 [debug] [MainThread]: Flushing usage events
[0m23:41:22.440359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109931520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10140>]}


============================== 23:41:22.460749 | 4d0a0c41-efe0-48f5-b984-92abef344675 ==============================
[0m23:41:22.460749 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:41:22.462659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:41:23.047422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a304d0>]}
[0m23:41:23.158135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10590>]}
[0m23:41:23.161184 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:41:23.203996 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:41:23.518451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:41:23.519413 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/total_sales_per_user.sql
[0m23:41:23.928892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a722990>]}
[0m23:41:24.144954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b73e0>]}
[0m23:41:24.145962 [info ] [MainThread]: Found 3 seeds, 7 models, 423 macros
[0m23:41:24.146745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f22ba0>]}
[0m23:41:24.150770 [info ] [MainThread]: 
[0m23:41:24.152395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:24.161869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:41:24.280647 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:41:24.281598 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:41:24.282391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:24.388745 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.105 seconds
[0m23:41:24.393879 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:41:24.403820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:41:24.420630 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:41:24.421883 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:41:24.422716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:24.432115 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:41:24.432876 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:41:24.433545 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:41:24.443810 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m23:41:24.448532 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:41:24.450658 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:41:24.472033 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.473879 [debug] [MainThread]: On master: BEGIN
[0m23:41:24.476054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:24.496331 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m23:41:24.497150 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.498265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:24.525658 [debug] [MainThread]: SQL status: SELECT 9 in 0.027 seconds
[0m23:41:24.530488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6fb0b0>]}
[0m23:41:24.531241 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:24.532100 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.532708 [debug] [MainThread]: On master: BEGIN
[0m23:41:24.536523 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:41:24.537374 [debug] [MainThread]: On master: COMMIT
[0m23:41:24.538084 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:24.538682 [debug] [MainThread]: On master: COMMIT
[0m23:41:24.539724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:41:24.540536 [debug] [MainThread]: On master: Close
[0m23:41:24.543740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:24.544834 [info ] [MainThread]: 
[0m23:41:24.555108 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:41:24.556551 [info ] [Thread-1 (]: 1 of 7 START sql view model public.products .................................... [RUN]
[0m23:41:24.557757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m23:41:24.559306 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:41:24.576214 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:41:24.577599 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:41:24.644728 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:41:24.648233 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:41:24.649335 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:41:24.650003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:24.658877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:24.659813 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:41:24.660616 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:41:24.666198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:41:24.677688 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:41:24.678429 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:41:24.679680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.685453 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:41:24.686181 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:41:24.687342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.719724 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:41:24.720638 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:41:24.721372 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:41:24.725919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:41:24.736600 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:41:24.745366 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:41:24.746092 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:41:24.749836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:24.753930 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:41:24.756731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac66db0>]}
[0m23:41:24.758614 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:41:24.759876 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:41:24.760685 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:41:24.761661 [info ] [Thread-1 (]: 2 of 7 START sql view model public.top_selling_products ........................ [RUN]
[0m23:41:24.762543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:41:24.763322 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:41:24.768778 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:41:24.770196 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:41:24.777069 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:41:24.778297 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:41:24.779038 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:41:24.779686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:24.789829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:24.790838 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:41:24.791942 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:41:24.799147 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:41:24.806147 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:41:24.807248 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:41:24.809477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.815687 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:41:24.816807 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:41:24.818192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.820761 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:41:24.821438 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:41:24.822046 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:41:24.824209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:41:24.828898 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:41:24.830179 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:41:24.830852 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:41:24.834733 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:24.836916 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:41:24.837953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abcb800>]}
[0m23:41:24.839113 [info ] [Thread-1 (]: 2 of 7 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:41:24.840834 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:41:24.842283 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:41:24.843337 [info ] [Thread-1 (]: 3 of 7 START sql view model public.transactions ................................ [RUN]
[0m23:41:24.844201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:41:24.844873 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:41:24.850069 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:41:24.851998 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:41:24.860621 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:41:24.861798 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:41:24.862677 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:41:24.863396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:24.873264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:24.874210 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:41:24.875821 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:41:24.879028 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:41:24.886406 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:41:24.887366 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:41:24.888691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.894336 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:41:24.895118 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:41:24.897338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.901665 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:41:24.902445 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:41:24.903104 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:41:24.905297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:41:24.910595 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:41:24.912150 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:41:24.912953 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:41:24.915976 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:41:24.918322 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:41:24.919292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace4f50>]}
[0m23:41:24.920366 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:41:24.921762 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:41:24.922613 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:41:24.923963 [info ] [Thread-1 (]: 4 of 7 START sql view model public.user_sales .................................. [RUN]
[0m23:41:24.925640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:41:24.926457 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:41:24.931342 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:41:24.933716 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:41:24.941999 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:41:24.943236 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:41:24.944147 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:41:24.944890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:24.954525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:24.955310 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:41:24.955953 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:41:24.963392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:41:24.973787 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:41:24.975278 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:41:24.977860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.983847 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:41:24.985297 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:41:24.987713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:24.994739 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:41:24.996052 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:41:24.997340 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:41:25.003699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:41:25.010364 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:41:25.012582 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:41:25.016645 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:41:25.021630 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:25.025646 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:41:25.027207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace6450>]}
[0m23:41:25.029131 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m23:41:25.031998 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:41:25.033138 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:41:25.034329 [info ] [Thread-1 (]: 5 of 7 START sql view model public.users ....................................... [RUN]
[0m23:41:25.036671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:41:25.037571 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:41:25.044096 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:41:25.047502 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:41:25.057126 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:41:25.059290 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:41:25.060253 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:41:25.061177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:25.072453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:41:25.073893 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:41:25.086903 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:41:25.093699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:41:25.107273 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:41:25.109617 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:41:25.111551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:25.118201 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:41:25.119140 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:41:25.120461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:41:25.123504 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:41:25.124395 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:41:25.125871 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:41:25.128190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:41:25.131763 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:41:25.133024 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:41:25.133957 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:41:25.137736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:41:25.140877 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:41:25.142581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accb7d0>]}
[0m23:41:25.143667 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:41:25.145040 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:41:25.145884 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:41:25.147161 [info ] [Thread-1 (]: 6 of 7 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:41:25.148644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.total_sales_per_user)
[0m23:41:25.149329 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:41:25.153600 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.154781 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:41:25.162098 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.163494 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.164314 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:41:25.165629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:25.175307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:41:25.176315 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.177188 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:41:25.182218 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:41:25.187260 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.187977 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:41:25.189336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:25.192967 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:41:25.193730 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.194401 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:41:25.196716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:41:25.203003 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:41:25.204578 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:41:25.205488 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:41:25.207483 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:41:25.210449 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:41:25.211552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8168d0>]}
[0m23:41:25.212647 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.06s]
[0m23:41:25.214480 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:41:25.215969 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:41:25.217398 [info ] [Thread-1 (]: 7 of 7 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:41:25.218613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:41:25.219515 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:41:25.223850 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:41:25.226985 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:41:25.234284 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:41:25.236231 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:41:25.237121 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:41:25.238138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:25.248650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:41:25.250297 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:41:25.251012 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:41:25.259461 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:41:25.265514 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:41:25.267371 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:41:25.269120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:41:25.271456 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:41:25.272138 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:41:25.272800 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:41:25.275607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:41:25.278847 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:41:25.280071 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:41:25.280715 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:41:25.282214 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:41:25.285898 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:41:25.287006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0a0c41-efe0-48f5-b984-92abef344675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb3020>]}
[0m23:41:25.288129 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:41:25.290004 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:41:25.294041 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:25.294693 [debug] [MainThread]: On master: BEGIN
[0m23:41:25.295245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:25.304026 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:41:25.305246 [debug] [MainThread]: On master: COMMIT
[0m23:41:25.306577 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:25.307904 [debug] [MainThread]: On master: COMMIT
[0m23:41:25.311397 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:41:25.312313 [debug] [MainThread]: On master: Close
[0m23:41:25.313723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:25.315339 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:41:25.316682 [info ] [MainThread]: 
[0m23:41:25.317893 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m23:41:25.320748 [debug] [MainThread]: Command end result
[0m23:41:25.476262 [info ] [MainThread]: 
[0m23:41:25.477353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:25.478649 [info ] [MainThread]: 
[0m23:41:25.479463 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:41:25.485647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1908796, "process_user_time": 4.93807, "process_kernel_time": 1.064654, "process_mem_max_rss": "115306496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:41:25.487800 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:25.487378 after 3.19 seconds
[0m23:41:25.490162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6916d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107580da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a304d0>]}
[0m23:41:25.491961 [debug] [MainThread]: Flushing usage events
[0m23:49:18.194211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e38f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea0200>]}


============================== 23:49:18.212079 | 58ddaf7e-7642-4d3e-9a22-32387b2f9e6e ==============================
[0m23:49:18.212079 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:49:18.215331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:18.815602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ddaf7e-7642-4d3e-9a22-32387b2f9e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10375a420>]}
[0m23:49:18.913949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ddaf7e-7642-4d3e-9a22-32387b2f9e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a45c0>]}
[0m23:49:18.916653 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:49:18.958271 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:49:19.267501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:49:19.268593 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/highest_and_lowest_price_product_per_category.sql
[0m23:49:19.557616 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.think_thrift_project.highest_and_lowest_price_product_per_category' (models/highest_and_lowest_price_product_per_category.sql) depends on a node named 'products_seet' which was not found
[0m23:49:19.565352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5114149, "process_user_time": 3.870153, "process_kernel_time": 0.938469, "process_mem_max_rss": "104857600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:49:19.566949 [debug] [MainThread]: Command `dbt run` failed at 23:49:19.566675 after 1.52 seconds
[0m23:49:19.567946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053be2d0>]}
[0m23:49:19.568701 [debug] [MainThread]: Flushing usage events
[0m23:49:32.280886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae8e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef40b0>]}


============================== 23:49:32.294708 | 79e2a1de-a7ce-4cd6-a173-e18b5b3d5391 ==============================
[0m23:49:32.294708 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:49:32.296019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:32.680012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d8200>]}
[0m23:49:32.773750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109794fb0>]}
[0m23:49:32.776570 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:49:32.822152 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:49:33.111883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:49:33.112770 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/highest_and_lowest_price_product_per_category.sql
[0m23:49:33.485265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebfd70>]}
[0m23:49:33.700261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8eba10>]}
[0m23:49:33.701452 [info ] [MainThread]: Found 3 seeds, 8 models, 423 macros
[0m23:49:33.702778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ffc80>]}
[0m23:49:33.706389 [info ] [MainThread]: 
[0m23:49:33.708177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:33.717993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:49:33.841147 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:49:33.841924 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:33.842649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:33.911581 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m23:49:33.914689 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:49:33.919812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:49:33.934065 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:49:33.934966 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:49:33.935871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:33.944546 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:49:33.945309 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:49:33.945890 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:49:33.951599 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m23:49:33.953982 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:49:33.954918 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:49:33.966037 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:33.967123 [debug] [MainThread]: On master: BEGIN
[0m23:49:33.967731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:33.976893 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:49:33.977702 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:33.978945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:49:34.010908 [debug] [MainThread]: SQL status: SELECT 11 in 0.031 seconds
[0m23:49:34.020484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3237d0>]}
[0m23:49:34.022279 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:34.025105 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:34.026873 [debug] [MainThread]: On master: BEGIN
[0m23:49:34.029381 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:49:34.031309 [debug] [MainThread]: On master: COMMIT
[0m23:49:34.032621 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:34.033605 [debug] [MainThread]: On master: COMMIT
[0m23:49:34.035447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:34.038803 [debug] [MainThread]: On master: Close
[0m23:49:34.040957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:49:34.043148 [info ] [MainThread]: 
[0m23:49:34.058525 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:49:34.061870 [info ] [Thread-1 (]: 1 of 8 START sql view model public.highest_and_lowest_price_product_per_category  [RUN]
[0m23:49:34.065379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.highest_and_lowest_price_product_per_category)
[0m23:49:34.067835 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:49:34.193528 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:49:34.198163 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:49:34.300409 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:49:34.302568 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:49:34.303962 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: BEGIN
[0m23:49:34.305162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.318323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:49:34.319916 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:49:34.321553 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_and_lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_and_lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category);

SELECT 
product_name, category, price
FROM produ"think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:49:34.326332 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                       ^

[0m23:49:34.327610 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: ROLLBACK
[0m23:49:34.332183 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: Close
[0m23:49:34.355279 [debug] [Thread-1 (]: Database Error in model highest_and_lowest_price_product_per_category (models/highest_and_lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_and_lowest_price_product_per_category.sql
[0m23:49:34.358274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a338cb0>]}
[0m23:49:34.359344 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model public.highest_and_lowest_price_product_per_category  [[31mERROR[0m in 0.29s]
[0m23:49:34.360854 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:49:34.361897 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:49:34.366828 [info ] [Thread-1 (]: 2 of 8 START sql view model public.products .................................... [RUN]
[0m23:49:34.368123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_and_lowest_price_product_per_category, now model.think_thrift_project.products)
[0m23:49:34.368938 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:49:34.381405 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:49:34.383574 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:49:34.390641 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:49:34.392041 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:49:34.392794 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:49:34.393856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.403807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:49:34.404974 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:49:34.406549 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:49:34.413840 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:49:34.426839 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:49:34.427735 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:49:34.429616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.435105 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:49:34.435911 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:49:34.437255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.465688 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:49:34.466478 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:49:34.467162 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:49:34.469745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:34.483280 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:49:34.492101 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:49:34.492852 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:49:34.496581 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:49:34.500700 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:49:34.501815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109611430>]}
[0m23:49:34.503167 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:49:34.505147 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:49:34.506314 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:49:34.507329 [info ] [Thread-1 (]: 3 of 8 START sql view model public.top_selling_products ........................ [RUN]
[0m23:49:34.508200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:49:34.508877 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:49:34.513868 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:49:34.515174 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:49:34.521121 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:49:34.522513 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:49:34.523567 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:49:34.524355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.535772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:49:34.536713 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:49:34.537434 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:49:34.544836 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:49:34.553362 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:49:34.554509 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:49:34.556703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.561097 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:49:34.561947 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:49:34.563530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.567404 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:49:34.569143 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:49:34.569937 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:49:34.572905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.577777 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:49:34.579712 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:49:34.580840 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:49:34.583698 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:34.586762 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:49:34.588140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0caea0>]}
[0m23:49:34.589264 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:49:34.590695 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:49:34.591511 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:49:34.592504 [info ] [Thread-1 (]: 4 of 8 START sql view model public.transactions ................................ [RUN]
[0m23:49:34.593535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:49:34.594221 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:49:34.598131 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:49:34.599350 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:49:34.606268 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:49:34.607466 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:49:34.608194 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:49:34.608964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.618425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:49:34.619527 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:49:34.620358 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:49:34.625607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:49:34.630266 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:49:34.631149 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:49:34.633448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.639263 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:49:34.640233 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:49:34.641556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:49:34.644316 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:49:34.645247 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:49:34.646686 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:49:34.649140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.655965 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:49:34.661839 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:49:34.662996 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:49:34.666241 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:34.669272 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:49:34.671595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba41a30>]}
[0m23:49:34.673619 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:49:34.676012 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:49:34.677969 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:49:34.680356 [info ] [Thread-1 (]: 5 of 8 START sql view model public.user_sales .................................. [RUN]
[0m23:49:34.682705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:49:34.684070 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:49:34.692726 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:49:34.697527 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:49:34.703429 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:49:34.705862 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:49:34.707647 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:49:34.708686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.719513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:49:34.720472 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:49:34.721464 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:49:34.728050 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:34.737908 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:49:34.739520 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:49:34.741088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.747694 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:49:34.748832 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:49:34.750102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.752816 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:49:34.753811 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:49:34.754701 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:49:34.757723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:34.764495 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:49:34.765755 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:49:34.766396 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:49:34.769359 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:49:34.772355 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:49:34.773734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e12aab0>]}
[0m23:49:34.775382 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m23:49:34.777519 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:49:34.780480 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:49:34.781744 [info ] [Thread-1 (]: 6 of 8 START sql view model public.users ....................................... [RUN]
[0m23:49:34.782888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:49:34.783692 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:49:34.789579 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:49:34.791093 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:49:34.798531 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:49:34.801154 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:49:34.803397 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:49:34.804863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.822252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m23:49:34.824515 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:49:34.826772 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:49:34.833229 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:34.842578 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:49:34.843793 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:49:34.846012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.854740 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:49:34.856332 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:49:34.858567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.862400 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:49:34.864046 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:49:34.865528 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:49:34.867887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:34.877008 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:49:34.878821 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:49:34.880282 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:49:34.885557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:49:34.890896 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:49:34.892861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ea8d0>]}
[0m23:49:34.894715 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:49:34.897416 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:49:34.899274 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:49:34.901448 [info ] [Thread-1 (]: 7 of 8 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:49:34.903256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.total_sales_per_user)
[0m23:49:34.904584 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:49:34.919662 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.922524 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:49:34.943792 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.947303 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.948686 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:49:34.950042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:34.961397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:49:34.962270 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.963034 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:49:34.968889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:34.976701 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.979321 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:49:34.980901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:34.983694 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:49:34.984682 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.985951 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:49:34.988509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:34.995498 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:49:34.997885 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:49:34.998833 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:49:35.000427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:35.004365 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:49:35.005774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09a840>]}
[0m23:49:35.007005 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.10s]
[0m23:49:35.009340 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:49:35.011008 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:49:35.012240 [info ] [Thread-1 (]: 8 of 8 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:49:35.025122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:49:35.032922 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:49:35.042520 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:49:35.044667 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:49:35.064334 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:49:35.066010 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:49:35.067292 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:49:35.068151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:35.087743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m23:49:35.090073 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:49:35.091612 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:49:35.099759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:49:35.220140 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:49:35.221328 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:49:35.223238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:35.227633 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:49:35.228781 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:49:35.229874 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:49:35.232302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:35.237806 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:49:35.239669 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:49:35.240830 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:49:35.242388 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:49:35.245629 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:49:35.246927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e2a1de-a7ce-4cd6-a173-e18b5b3d5391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e117e60>]}
[0m23:49:35.248515 [info ] [Thread-1 (]: 8 of 8 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:49:35.251160 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:49:35.253781 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:35.254760 [debug] [MainThread]: On master: BEGIN
[0m23:49:35.255630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:35.267445 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m23:49:35.268610 [debug] [MainThread]: On master: COMMIT
[0m23:49:35.269727 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:35.270971 [debug] [MainThread]: On master: COMMIT
[0m23:49:35.272734 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:35.275755 [debug] [MainThread]: On master: Close
[0m23:49:35.277214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:35.278326 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:49:35.279722 [info ] [MainThread]: 
[0m23:49:35.281577 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m23:49:35.287697 [debug] [MainThread]: Command end result
[0m23:49:35.369017 [info ] [MainThread]: 
[0m23:49:35.370565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:49:35.371813 [info ] [MainThread]: 
[0m23:49:35.373175 [error] [MainThread]:   Database Error in model highest_and_lowest_price_product_per_category (models/highest_and_lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_and_lowest_price_product_per_category.sql
[0m23:49:35.374430 [info ] [MainThread]: 
[0m23:49:35.375798 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m23:49:35.379805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3727608, "process_user_time": 4.68083, "process_kernel_time": 0.738437, "process_mem_max_rss": "116006912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:49:35.381845 [debug] [MainThread]: Command `dbt run` failed at 23:49:35.381540 after 3.38 seconds
[0m23:49:35.383075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26b9e0>]}
[0m23:49:35.384185 [debug] [MainThread]: Flushing usage events
[0m23:50:57.612431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e73fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e73fe0>]}


============================== 23:50:57.630080 | d5c6fe50-15ec-4dd4-a3d7-64102be44b05 ==============================
[0m23:50:57.630080 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:50:57.632013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'debug': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:50:57.998641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eaaa20>]}
[0m23:50:58.096610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109936090>]}
[0m23:50:58.099508 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:50:58.138224 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:50:58.469868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:50:58.470745 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/lowest_price_product_per_category.sql
[0m23:50:58.844400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf6330>]}
[0m23:50:59.047950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abace60>]}
[0m23:50:59.049350 [info ] [MainThread]: Found 3 seeds, 9 models, 423 macros
[0m23:50:59.050479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf23f0>]}
[0m23:50:59.054578 [info ] [MainThread]: 
[0m23:50:59.055990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:50:59.065737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:50:59.184566 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:50:59.185254 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:50:59.185814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:59.256398 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m23:50:59.259019 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:50:59.264582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:50:59.273981 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:50:59.274685 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:50:59.275265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:59.283830 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:50:59.284623 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:50:59.285216 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:50:59.290248 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m23:50:59.292848 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:50:59.293824 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:50:59.305488 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:59.306141 [debug] [MainThread]: On master: BEGIN
[0m23:50:59.306682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:59.315025 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:50:59.315823 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:59.317167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:50:59.339024 [debug] [MainThread]: SQL status: SELECT 11 in 0.021 seconds
[0m23:50:59.347314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa5040>]}
[0m23:50:59.348316 [debug] [MainThread]: On master: ROLLBACK
[0m23:50:59.349815 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:59.350873 [debug] [MainThread]: On master: BEGIN
[0m23:50:59.352803 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:50:59.354131 [debug] [MainThread]: On master: COMMIT
[0m23:50:59.355298 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:59.356392 [debug] [MainThread]: On master: COMMIT
[0m23:50:59.357860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:50:59.358797 [debug] [MainThread]: On master: Close
[0m23:50:59.360713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:50:59.362632 [info ] [MainThread]: 
[0m23:50:59.370491 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:50:59.372955 [info ] [Thread-1 (]: 1 of 9 START sql view model public.highest_and_lowest_price_product_per_category  [RUN]
[0m23:50:59.374585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.highest_and_lowest_price_product_per_category)
[0m23:50:59.375712 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:50:59.403602 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:50:59.405734 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:50:59.469601 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:50:59.471412 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:50:59.472407 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: BEGIN
[0m23:50:59.473197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.481631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:50:59.482429 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:50:59.483255 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_and_lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_and_lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category);

SELECT 
product_name, category, price
FROM produ"think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:50:59.486112 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                       ^

[0m23:50:59.487071 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: ROLLBACK
[0m23:50:59.488796 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: Close
[0m23:50:59.504400 [debug] [Thread-1 (]: Database Error in model highest_and_lowest_price_product_per_category (models/highest_and_lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_and_lowest_price_product_per_category.sql
[0m23:50:59.506575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa32f0>]}
[0m23:50:59.507604 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model public.highest_and_lowest_price_product_per_category  [[31mERROR[0m in 0.13s]
[0m23:50:59.508998 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:50:59.510110 [debug] [Thread-1 (]: Began running node model.think_thrift_project.lowest_price_product_per_category
[0m23:50:59.513251 [info ] [Thread-1 (]: 2 of 9 START sql view model public.lowest_price_product_per_category ........... [RUN]
[0m23:50:59.514580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_and_lowest_price_product_per_category, now model.think_thrift_project.lowest_price_product_per_category)
[0m23:50:59.515623 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.lowest_price_product_per_category
[0m23:50:59.522413 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:50:59.524524 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.lowest_price_product_per_category
[0m23:50:59.531716 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:50:59.533252 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:50:59.534372 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: BEGIN
[0m23:50:59.535651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.546624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:50:59.547439 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:50:59.548082 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM produ"think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:50:59.549683 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 9: FROM produ"think-thrift-db"."public"."products_seed"
                                   ^

[0m23:50:59.550821 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: ROLLBACK
[0m23:50:59.552767 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: Close
[0m23:50:59.557000 [debug] [Thread-1 (]: Database Error in model lowest_price_product_per_category (models/lowest_price_product_per_category.sql)
  syntax error at or near "."
  LINE 9: FROM produ"think-thrift-db"."public"."products_seed"
                                     ^
  compiled code at target/run/think_thrift_project/models/lowest_price_product_per_category.sql
[0m23:50:59.557874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a9f10>]}
[0m23:50:59.558914 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model public.lowest_price_product_per_category .. [[31mERROR[0m in 0.04s]
[0m23:50:59.560282 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.lowest_price_product_per_category
[0m23:50:59.562080 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:50:59.563359 [info ] [Thread-1 (]: 3 of 9 START sql view model public.products .................................... [RUN]
[0m23:50:59.564277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.lowest_price_product_per_category, now model.think_thrift_project.products)
[0m23:50:59.565087 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:50:59.569793 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:50:59.571947 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:50:59.579331 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:50:59.580595 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:50:59.581573 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:50:59.582420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.591992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:50:59.593021 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:50:59.593898 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:50:59.598686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:50:59.611131 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:50:59.612587 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:50:59.614060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.618648 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:50:59.619881 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:50:59.621891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.649937 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:50:59.650722 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:50:59.651439 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:50:59.653902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:50:59.666245 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:50:59.674649 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:50:59.675412 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:50:59.679108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:50:59.683131 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:50:59.684251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0cf080>]}
[0m23:50:59.685835 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:50:59.687483 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:50:59.688236 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:50:59.689096 [info ] [Thread-1 (]: 4 of 9 START sql view model public.top_selling_products ........................ [RUN]
[0m23:50:59.689999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:50:59.690671 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:50:59.696288 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:50:59.697487 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:50:59.705604 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:50:59.706786 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:50:59.707485 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:50:59.708091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.719817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:50:59.720783 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:50:59.721435 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:50:59.726114 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:50:59.732255 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:50:59.733049 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:50:59.734694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.740824 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:50:59.741793 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:50:59.743350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.746998 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:50:59.747797 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:50:59.748498 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:50:59.752094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:50:59.755613 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:50:59.756862 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:50:59.757675 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:50:59.761305 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:50:59.763766 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:50:59.764846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af84590>]}
[0m23:50:59.766161 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:50:59.768014 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:50:59.768877 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:50:59.769954 [info ] [Thread-1 (]: 5 of 9 START sql view model public.transactions ................................ [RUN]
[0m23:50:59.770991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:50:59.771701 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:50:59.779818 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:50:59.781772 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:50:59.789239 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:50:59.790556 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:50:59.791538 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:50:59.792668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.802863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:50:59.803620 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:50:59.804248 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:50:59.807726 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:50:59.817573 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:50:59.818389 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:50:59.819700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.824001 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:50:59.824696 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:50:59.825881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.829816 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:50:59.830592 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:50:59.831254 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:50:59.833494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:50:59.837197 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:50:59.838677 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:50:59.839336 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:50:59.842525 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:50:59.844888 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:50:59.846009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11ad20>]}
[0m23:50:59.848966 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:50:59.850513 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:50:59.851345 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:50:59.852546 [info ] [Thread-1 (]: 6 of 9 START sql view model public.user_sales .................................. [RUN]
[0m23:50:59.853697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:50:59.854448 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:50:59.859376 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:50:59.860747 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:50:59.870081 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:50:59.872461 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:50:59.873513 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:50:59.874471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.886492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:50:59.887343 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:50:59.888093 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:50:59.892055 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:50:59.902426 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:50:59.904256 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:50:59.905722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.911364 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:50:59.912568 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:50:59.913868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.916813 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:50:59.918259 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:50:59.919401 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:50:59.921863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:50:59.925317 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:50:59.928226 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:50:59.929301 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:50:59.932674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:50:59.935189 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:50:59.936312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b159490>]}
[0m23:50:59.937416 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m23:50:59.938767 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:50:59.939582 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:50:59.940677 [info ] [Thread-1 (]: 7 of 9 START sql view model public.users ....................................... [RUN]
[0m23:50:59.942554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:50:59.943800 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:50:59.949086 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:50:59.950469 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:50:59.956981 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:50:59.958273 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:50:59.959016 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:50:59.959693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:59.969483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:50:59.970327 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:50:59.971092 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:50:59.978146 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:50:59.984758 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:50:59.986020 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:50:59.989313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:59.995318 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:50:59.996242 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:50:59.997454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:00.000342 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:51:00.004922 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:00.005912 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:51:00.008492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:00.013276 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:51:00.015883 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:00.016753 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:51:00.020086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:51:00.022606 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:51:00.023694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af93b00>]}
[0m23:51:00.024828 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m23:51:00.027060 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:51:00.027887 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:51:00.028976 [info ] [Thread-1 (]: 8 of 9 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:51:00.030077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.total_sales_per_user)
[0m23:51:00.030897 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:51:00.040374 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.041666 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:51:00.049349 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.052786 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.054308 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:51:00.055477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:00.065414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:51:00.066861 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.068181 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:51:00.078934 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:51:00.086757 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.087817 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:51:00.089143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:00.096130 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:51:00.096980 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.097792 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:51:00.100124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:00.190077 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:51:00.193381 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:00.195660 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:51:00.197501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:51:00.201006 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:51:00.202409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1489e0>]}
[0m23:51:00.204128 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.17s]
[0m23:51:00.206856 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:51:00.208020 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:51:00.209002 [info ] [Thread-1 (]: 9 of 9 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:51:00.210185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:51:00.212516 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:51:00.224649 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:51:00.226413 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:51:00.239841 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:51:00.242047 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:00.243693 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:51:00.245835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:00.264308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m23:51:00.266147 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:00.267537 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:51:00.273116 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:51:00.278969 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:00.279848 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:51:00.281247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:00.290328 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:51:00.291195 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:00.292215 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:51:00.295822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:00.299910 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:51:00.303595 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:00.304437 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:51:00.305836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:51:00.309153 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:51:00.313493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c6fe50-15ec-4dd4-a3d7-64102be44b05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa97fb0>]}
[0m23:51:00.321141 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m23:51:00.323577 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:51:00.327866 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:00.329190 [debug] [MainThread]: On master: BEGIN
[0m23:51:00.330255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:00.340378 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:51:00.341271 [debug] [MainThread]: On master: COMMIT
[0m23:51:00.341998 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:00.342683 [debug] [MainThread]: On master: COMMIT
[0m23:51:00.343946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:00.345530 [debug] [MainThread]: On master: Close
[0m23:51:00.346762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:00.347721 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:51:00.348861 [info ] [MainThread]: 
[0m23:51:00.349990 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m23:51:00.354604 [debug] [MainThread]: Command end result
[0m23:51:00.429019 [info ] [MainThread]: 
[0m23:51:00.430174 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:51:00.431318 [info ] [MainThread]: 
[0m23:51:00.433863 [error] [MainThread]:   Database Error in model highest_and_lowest_price_product_per_category (models/highest_and_lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_and_lowest_price_product_per_category.sql
[0m23:51:00.435476 [info ] [MainThread]: 
[0m23:51:00.436990 [error] [MainThread]:   Database Error in model lowest_price_product_per_category (models/lowest_price_product_per_category.sql)
  syntax error at or near "."
  LINE 9: FROM produ"think-thrift-db"."public"."products_seed"
                                     ^
  compiled code at target/run/think_thrift_project/models/lowest_price_product_per_category.sql
[0m23:51:00.438130 [info ] [MainThread]: 
[0m23:51:00.439322 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m23:51:00.445613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.976556, "process_user_time": 5.021617, "process_kernel_time": 0.999753, "process_mem_max_rss": "116400128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:51:00.448258 [debug] [MainThread]: Command `dbt run` failed at 23:51:00.447807 after 2.98 seconds
[0m23:51:00.449494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a0a70>]}
[0m23:51:00.450771 [debug] [MainThread]: Flushing usage events
[0m23:51:20.397911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107110740>]}


============================== 23:51:20.410710 | 5a560a5a-a528-4361-be66-cf2fe83bb88c ==============================
[0m23:51:20.410710 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:51:20.412662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:20.821749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de15e0>]}
[0m23:51:20.915443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573afc0>]}
[0m23:51:20.918209 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:51:20.952031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:51:21.256582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:51:21.257580 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/lowest_price_product_per_category.sql
[0m23:51:21.258286 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/highest_and_lowest_price_product_per_category.sql
[0m23:51:21.667488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107662990>]}
[0m23:51:21.873725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c1b20>]}
[0m23:51:21.875176 [info ] [MainThread]: Found 3 seeds, 9 models, 423 macros
[0m23:51:21.876334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e21a60>]}
[0m23:51:21.880325 [info ] [MainThread]: 
[0m23:51:21.881691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:21.889243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:51:22.018472 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:51:22.019326 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:51:22.020303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:22.123340 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.103 seconds
[0m23:51:22.126236 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:51:22.136050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:51:22.152464 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:51:22.153552 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:51:22.154137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:22.168666 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m23:51:22.169692 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:51:22.170485 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:51:22.185847 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m23:51:22.188988 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:51:22.190103 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:51:22.220392 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:22.221626 [debug] [MainThread]: On master: BEGIN
[0m23:51:22.222466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:22.237940 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m23:51:22.238701 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:22.239487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:22.276194 [debug] [MainThread]: SQL status: SELECT 11 in 0.036 seconds
[0m23:51:22.289170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107692390>]}
[0m23:51:22.290282 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:22.291728 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:22.292880 [debug] [MainThread]: On master: BEGIN
[0m23:51:22.298543 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:51:22.300283 [debug] [MainThread]: On master: COMMIT
[0m23:51:22.301071 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:22.301747 [debug] [MainThread]: On master: COMMIT
[0m23:51:22.302667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:22.303588 [debug] [MainThread]: On master: Close
[0m23:51:22.304621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:22.306441 [info ] [MainThread]: 
[0m23:51:22.322552 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:51:22.323529 [info ] [Thread-1 (]: 1 of 9 START sql view model public.highest_and_lowest_price_product_per_category  [RUN]
[0m23:51:22.325161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.highest_and_lowest_price_product_per_category)
[0m23:51:22.326114 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:51:22.351283 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:51:22.352481 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:51:22.424885 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:51:22.426634 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:51:22.427661 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: BEGIN
[0m23:51:22.428375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.436768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:22.437612 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_and_lowest_price_product_per_category"
[0m23:51:22.438495 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_and_lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_and_lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:51:22.441348 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                       ^

[0m23:51:22.443257 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: ROLLBACK
[0m23:51:22.444495 [debug] [Thread-1 (]: On model.think_thrift_project.highest_and_lowest_price_product_per_category: Close
[0m23:51:22.459307 [debug] [Thread-1 (]: Database Error in model highest_and_lowest_price_product_per_category (models/highest_and_lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_and_lowest_price_product_per_category.sql
[0m23:51:22.461548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f11c0>]}
[0m23:51:22.462608 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model public.highest_and_lowest_price_product_per_category  [[31mERROR[0m in 0.14s]
[0m23:51:22.463886 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_and_lowest_price_product_per_category
[0m23:51:22.464692 [debug] [Thread-1 (]: Began running node model.think_thrift_project.lowest_price_product_per_category
[0m23:51:22.466869 [info ] [Thread-1 (]: 2 of 9 START sql view model public.lowest_price_product_per_category ........... [RUN]
[0m23:51:22.467849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_and_lowest_price_product_per_category, now model.think_thrift_project.lowest_price_product_per_category)
[0m23:51:22.468582 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.lowest_price_product_per_category
[0m23:51:22.473461 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:51:22.474867 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.lowest_price_product_per_category
[0m23:51:22.480642 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:51:22.482083 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:51:22.482879 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: BEGIN
[0m23:51:22.483557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.491581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:22.492378 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:51:22.493234 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products_seed"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:51:22.494777 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                       ^

[0m23:51:22.495837 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: ROLLBACK
[0m23:51:22.497680 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: Close
[0m23:51:22.501848 [debug] [Thread-1 (]: Database Error in model lowest_price_product_per_category (models/lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/lowest_price_product_per_category.sql
[0m23:51:22.502669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108311b80>]}
[0m23:51:22.503603 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model public.lowest_price_product_per_category .. [[31mERROR[0m in 0.03s]
[0m23:51:22.504838 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.lowest_price_product_per_category
[0m23:51:22.505819 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:51:22.506888 [info ] [Thread-1 (]: 3 of 9 START sql view model public.products .................................... [RUN]
[0m23:51:22.507945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.lowest_price_product_per_category, now model.think_thrift_project.products)
[0m23:51:22.508709 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:51:22.513089 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:51:22.514460 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:51:22.519873 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:51:22.521067 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:51:22.522043 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:51:22.522739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.531371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:51:22.532154 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:51:22.532872 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:51:22.538287 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:51:22.548741 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:51:22.549858 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:51:22.551747 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:22.556883 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:51:22.557610 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:51:22.559095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:22.586730 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:51:22.587483 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:51:22.588109 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:51:22.590490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:22.600289 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:51:22.609681 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:51:22.610627 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:51:22.614047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:51:22.618251 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:51:22.619421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cd190>]}
[0m23:51:22.620564 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:51:22.621955 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:51:22.622786 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:51:22.623726 [info ] [Thread-1 (]: 4 of 9 START sql view model public.top_selling_products ........................ [RUN]
[0m23:51:22.624768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:51:22.625536 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:51:22.633019 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:51:22.634423 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:51:22.639516 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:51:22.640717 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:51:22.641764 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:51:22.642699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.650441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:22.651222 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:51:22.651879 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:51:22.656425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:51:22.662230 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:51:22.662952 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:51:22.664199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:22.669848 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:51:22.671264 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:51:22.672843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:22.677503 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:51:22.678503 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:51:22.679322 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:51:22.681871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:22.686621 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:51:22.689539 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:51:22.690577 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:51:22.694171 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:51:22.697268 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:51:22.699110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083477a0>]}
[0m23:51:22.700885 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:51:22.702807 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:51:22.703836 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:51:22.705656 [info ] [Thread-1 (]: 5 of 9 START sql view model public.transactions ................................ [RUN]
[0m23:51:22.707598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:51:22.709408 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:51:22.718240 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:51:22.719664 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:51:22.726964 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:51:22.729197 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:51:22.732220 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:51:22.734201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.751950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:51:22.752834 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:51:22.753638 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:51:22.767215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:51:22.775353 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:51:22.776225 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:51:22.781007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:51:22.789349 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:51:22.790145 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:51:22.792059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:51:22.800700 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:51:22.802038 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:51:22.803381 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:51:22.806338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:22.820341 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:51:22.822788 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:51:22.824176 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:51:22.831081 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:51:22.835663 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:51:22.837107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e19250>]}
[0m23:51:22.838487 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:51:22.840191 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:51:22.841445 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:51:22.843202 [info ] [Thread-1 (]: 6 of 9 START sql view model public.user_sales .................................. [RUN]
[0m23:51:22.850999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:51:22.851952 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:51:22.858868 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:51:22.860637 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:51:22.872044 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:51:22.873989 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:51:22.875921 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:51:22.876701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.888488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:51:22.889263 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:51:22.889918 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:51:22.900746 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:51:22.908352 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:51:22.909635 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:51:22.914248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:51:22.922017 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:51:22.923142 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:51:22.924531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:22.928875 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:51:22.932492 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:51:22.933961 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:51:22.936423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:22.940754 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:51:22.942449 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:51:22.943330 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:51:22.951125 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m23:51:22.953458 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:51:22.954542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d0b00>]}
[0m23:51:22.955692 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:51:22.957131 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:51:22.957952 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:51:22.959193 [info ] [Thread-1 (]: 7 of 9 START sql view model public.users ....................................... [RUN]
[0m23:51:22.960210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:51:22.961896 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:51:22.970080 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:51:22.971452 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:51:22.977488 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:51:22.981954 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:22.983474 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:51:22.984711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:22.993287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:51:22.994457 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:22.995549 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:51:23.000662 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:51:23.008106 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:23.009184 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:51:23.010762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:23.016085 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:23.018246 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:51:23.020055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:23.022770 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:51:23.023475 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:23.024129 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:51:23.027936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:51:23.034580 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:51:23.036600 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:51:23.037324 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:51:23.040700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:51:23.044601 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:51:23.048202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083073e0>]}
[0m23:51:23.049556 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m23:51:23.051234 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:51:23.052072 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:51:23.053175 [info ] [Thread-1 (]: 8 of 9 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:51:23.054089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.total_sales_per_user)
[0m23:51:23.054773 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:51:23.059949 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.061772 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:51:23.069300 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.070617 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.071497 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:51:23.073803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.090574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:51:23.092221 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.093651 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:51:23.100372 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:51:23.105329 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.106093 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:51:23.107538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:23.110761 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:51:23.115265 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.116539 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:51:23.118953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:51:23.124538 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:51:23.126289 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:51:23.127198 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:51:23.128860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:51:23.131982 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:51:23.133279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a4080>]}
[0m23:51:23.134378 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:51:23.135876 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:51:23.136733 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:51:23.137656 [info ] [Thread-1 (]: 9 of 9 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:51:23.138632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:51:23.139494 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:51:23.144799 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:51:23.146116 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:51:23.248045 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:51:23.252220 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:23.253217 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:51:23.253952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:23.263723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:51:23.265361 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:23.268673 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:51:23.274672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:51:23.285441 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:23.286859 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:51:23.289226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:51:23.297886 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:51:23.302204 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:23.303553 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:51:23.306024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:51:23.315203 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:51:23.318855 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:51:23.320251 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:51:23.321674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:51:23.324219 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:51:23.325788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a560a5a-a528-4361-be66-cf2fe83bb88c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a7710>]}
[0m23:51:23.330686 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.19s]
[0m23:51:23.334133 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:51:23.336088 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.336734 [debug] [MainThread]: On master: BEGIN
[0m23:51:23.337272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:23.349026 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:51:23.350367 [debug] [MainThread]: On master: COMMIT
[0m23:51:23.351120 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:23.351681 [debug] [MainThread]: On master: COMMIT
[0m23:51:23.352525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:51:23.353151 [debug] [MainThread]: On master: Close
[0m23:51:23.353978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:23.354619 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:51:23.355593 [info ] [MainThread]: 
[0m23:51:23.356924 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m23:51:23.361433 [debug] [MainThread]: Command end result
[0m23:51:23.426939 [info ] [MainThread]: 
[0m23:51:23.428580 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:51:23.430168 [info ] [MainThread]: 
[0m23:51:23.431514 [error] [MainThread]:   Database Error in model highest_and_lowest_price_product_per_category (models/highest_and_lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_and_lowest_price_product_per_category.sql
[0m23:51:23.434222 [info ] [MainThread]: 
[0m23:51:23.435399 [error] [MainThread]:   Database Error in model lowest_price_product_per_category (models/lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/lowest_price_product_per_category.sql
[0m23:51:23.436440 [info ] [MainThread]: 
[0m23:51:23.437768 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m23:51:23.441497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.171014, "process_user_time": 5.061373, "process_kernel_time": 0.974424, "process_mem_max_rss": "116215808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:51:23.444620 [debug] [MainThread]: Command `dbt run` failed at 23:51:23.444253 after 3.17 seconds
[0m23:51:23.445822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d365d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718d490>]}
[0m23:51:23.446870 [debug] [MainThread]: Flushing usage events
[0m23:52:33.140297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114434680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114434170>]}


============================== 23:52:33.155045 | b12d227f-ee5a-4b5a-a4ba-58dd528a893f ==============================
[0m23:52:33.155045 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:52:33.156695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'profiles_dir': '/Users/olikelly/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:52:33.601928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114434650>]}
[0m23:52:33.689264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113774290>]}
[0m23:52:33.692035 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:52:33.730720 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:52:34.137485 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m23:52:34.138363 [debug] [MainThread]: Partial parsing: added file: think_thrift_project://models/highest_price_product_per_category.sql
[0m23:52:34.138921 [debug] [MainThread]: Partial parsing: deleted file: think_thrift_project://models/highest_and_lowest_price_product_per_category.sql
[0m23:52:34.139609 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/lowest_price_product_per_category.sql
[0m23:52:34.516956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115060140>]}
[0m23:52:34.697795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a35d60>]}
[0m23:52:34.699225 [info ] [MainThread]: Found 3 seeds, 9 models, 423 macros
[0m23:52:34.700606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150246e0>]}
[0m23:52:34.706594 [info ] [MainThread]: 
[0m23:52:34.708058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:34.719020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:52:34.946439 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:52:34.948076 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:52:34.949780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:35.042107 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.092 seconds
[0m23:52:35.045564 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:52:35.051904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:52:35.064390 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:52:35.065630 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:52:35.067066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:35.083627 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m23:52:35.085173 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:52:35.085935 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:52:35.091435 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m23:52:35.094774 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:52:35.098469 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:52:35.114277 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:35.115224 [debug] [MainThread]: On master: BEGIN
[0m23:52:35.115999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:35.126278 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:52:35.127253 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:35.128418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:35.152904 [debug] [MainThread]: SQL status: SELECT 11 in 0.023 seconds
[0m23:52:35.159717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d4a270>]}
[0m23:52:35.160609 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:35.161488 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:35.162100 [debug] [MainThread]: On master: BEGIN
[0m23:52:35.163136 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:52:35.163834 [debug] [MainThread]: On master: COMMIT
[0m23:52:35.164394 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:35.164939 [debug] [MainThread]: On master: COMMIT
[0m23:52:35.165907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:52:35.166765 [debug] [MainThread]: On master: Close
[0m23:52:35.168891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:52:35.169820 [info ] [MainThread]: 
[0m23:52:35.175861 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:52:35.177310 [info ] [Thread-1 (]: 1 of 9 START sql view model public.products .................................... [RUN]
[0m23:52:35.178572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m23:52:35.179420 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:52:35.198811 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:52:35.201650 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:52:35.282053 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:52:35.283949 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:52:35.284866 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:52:35.285922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.294889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:52:35.295781 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:52:35.296460 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:52:35.301640 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:52:35.312638 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:52:35.313876 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:52:35.315337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.320775 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:52:35.321584 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:52:35.323427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.353784 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:52:35.354578 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:52:35.355248 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:52:35.357781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:52:35.368129 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:52:35.377309 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:52:35.378202 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:52:35.381731 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:52:35.386304 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:52:35.389322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a15190>]}
[0m23:52:35.390962 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:52:35.392301 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:52:35.393135 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:52:35.394373 [info ] [Thread-1 (]: 2 of 9 START sql view model public.top_selling_products ........................ [RUN]
[0m23:52:35.395285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:52:35.395984 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:52:35.401727 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:52:35.402949 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:52:35.409584 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:52:35.411625 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:52:35.412490 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:52:35.413160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.422497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:52:35.423606 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:52:35.424719 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:52:35.430350 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:52:35.437189 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:52:35.438065 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:52:35.439583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.446135 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:52:35.446928 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:52:35.448381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.452574 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:52:35.453353 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:52:35.454027 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:52:35.456245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:52:35.461057 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:52:35.462400 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:52:35.463100 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:52:35.466083 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:52:35.472015 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:52:35.473427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11563fe30>]}
[0m23:52:35.474823 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:52:35.476359 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:52:35.477241 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:52:35.478215 [info ] [Thread-1 (]: 3 of 9 START sql view model public.transactions ................................ [RUN]
[0m23:52:35.479085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:52:35.479748 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:52:35.484778 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:52:35.485985 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:52:35.493873 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:52:35.495108 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:52:35.495835 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:52:35.496473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.504736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:52:35.505730 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:52:35.507170 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:52:35.510855 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:52:35.517120 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:52:35.518940 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:52:35.520485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.527006 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:52:35.528546 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:52:35.530550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.537405 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:52:35.538468 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:52:35.539339 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:52:35.542224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:52:35.547102 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:52:35.549360 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:52:35.551455 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:52:35.556225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:52:35.559491 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:52:35.560761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11562d1c0>]}
[0m23:52:35.561987 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:52:35.563573 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:52:35.564596 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:52:35.566391 [info ] [Thread-1 (]: 4 of 9 START sql view model public.user_sales .................................. [RUN]
[0m23:52:35.573379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:52:35.580477 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:52:35.593449 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:52:35.595568 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:52:35.603861 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:52:35.605295 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:52:35.609236 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:52:35.610963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.623225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:52:35.624911 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:52:35.626064 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:52:35.636029 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m23:52:35.648045 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:52:35.649684 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:52:35.652513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.657713 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:52:35.658581 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:52:35.660944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.664055 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:52:35.664759 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:52:35.665844 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:52:35.668582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:52:35.672158 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:52:35.673993 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:52:35.674827 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:52:35.677969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:52:35.680346 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:52:35.681375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115515cd0>]}
[0m23:52:35.682669 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:52:35.684107 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:52:35.684968 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:52:35.685881 [info ] [Thread-1 (]: 5 of 9 START sql view model public.users ....................................... [RUN]
[0m23:52:35.686742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:52:35.687411 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:52:35.691543 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:52:35.692911 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:52:35.704627 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:52:35.706313 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:52:35.707866 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:52:35.708593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.717225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:52:35.718726 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:52:35.719697 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:52:35.723456 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:52:35.730218 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:52:35.731222 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:52:35.732994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.738519 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:52:35.739518 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:52:35.741565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.745164 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:52:35.745945 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:52:35.746611 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:52:35.749082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:52:35.753852 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:52:35.755266 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:52:35.755963 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:52:35.759438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:52:35.762150 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:52:35.763105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154995b0>]}
[0m23:52:35.764171 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m23:52:35.765696 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:52:35.766582 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_price_product_per_category
[0m23:52:35.767659 [info ] [Thread-1 (]: 6 of 9 START sql view model public.highest_price_product_per_category .......... [RUN]
[0m23:52:35.768639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.highest_price_product_per_category)
[0m23:52:35.769359 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_price_product_per_category
[0m23:52:35.773692 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:52:35.775627 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_price_product_per_category
[0m23:52:35.782866 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:52:35.785279 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:52:35.786143 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: BEGIN
[0m23:52:35.786833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.795157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:52:35.796408 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:52:35.797333 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:52:35.801051 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                       ^

[0m23:52:35.802163 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: ROLLBACK
[0m23:52:35.803393 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: Close
[0m23:52:35.819961 [debug] [Thread-1 (]: Database Error in model highest_price_product_per_category (models/highest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_price_product_per_category.sql
[0m23:52:35.820800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11564c050>]}
[0m23:52:35.821904 [error] [Thread-1 (]: 6 of 9 ERROR creating sql view model public.highest_price_product_per_category . [[31mERROR[0m in 0.05s]
[0m23:52:35.823483 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_price_product_per_category
[0m23:52:35.824821 [debug] [Thread-1 (]: Began running node model.think_thrift_project.lowest_price_product_per_category
[0m23:52:35.826999 [info ] [Thread-1 (]: 7 of 9 START sql view model public.lowest_price_product_per_category ........... [RUN]
[0m23:52:35.828218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_price_product_per_category, now model.think_thrift_project.lowest_price_product_per_category)
[0m23:52:35.829182 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.lowest_price_product_per_category
[0m23:52:35.834847 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:52:35.836418 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.lowest_price_product_per_category
[0m23:52:35.842558 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:52:35.844293 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:52:35.846028 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: BEGIN
[0m23:52:35.847117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.857230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:52:35.858511 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:52:35.859775 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category);
  );
[0m23:52:35.861187 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                       ^

[0m23:52:35.862005 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: ROLLBACK
[0m23:52:35.863109 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: Close
[0m23:52:35.869365 [debug] [Thread-1 (]: Database Error in model lowest_price_product_per_category (models/lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/lowest_price_product_per_category.sql
[0m23:52:35.870312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11562fbf0>]}
[0m23:52:35.871879 [error] [Thread-1 (]: 7 of 9 ERROR creating sql view model public.lowest_price_product_per_category .. [[31mERROR[0m in 0.04s]
[0m23:52:35.873624 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.lowest_price_product_per_category
[0m23:52:35.874897 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:52:35.876963 [info ] [Thread-1 (]: 8 of 9 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:52:35.878337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.lowest_price_product_per_category, now model.think_thrift_project.total_sales_per_user)
[0m23:52:35.879171 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:52:35.885420 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.886704 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:52:35.893494 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.895942 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.896818 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:52:35.897613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:35.908251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:52:35.909599 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.910438 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:52:35.922333 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:52:35.928846 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.930853 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:52:35.932909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:35.938227 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:52:35.939135 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.940040 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:52:35.943050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:52:35.951124 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:52:35.952585 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:52:35.953304 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:52:35.954572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:52:35.956846 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:52:35.957997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e8260>]}
[0m23:52:35.959119 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:52:35.960534 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:52:35.961391 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:52:35.962352 [info ] [Thread-1 (]: 9 of 9 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:52:35.963236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:52:35.963931 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:52:36.044676 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:52:36.045905 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:52:36.053287 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:52:36.055212 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:52:36.056382 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:52:36.057244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:36.066460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:52:36.067976 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:52:36.069593 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:52:36.077541 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:52:36.084993 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:52:36.085912 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:52:36.087831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:36.090744 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:52:36.092017 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:52:36.093427 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:52:36.096406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:52:36.103577 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:52:36.106952 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:52:36.108767 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:52:36.110387 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:52:36.113166 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:52:36.114533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b12d227f-ee5a-4b5a-a4ba-58dd528a893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f51220>]}
[0m23:52:36.116583 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m23:52:36.119013 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:52:36.121817 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:36.122716 [debug] [MainThread]: On master: BEGIN
[0m23:52:36.123453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:36.141066 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:52:36.141939 [debug] [MainThread]: On master: COMMIT
[0m23:52:36.142621 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:36.143302 [debug] [MainThread]: On master: COMMIT
[0m23:52:36.144733 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:52:36.146162 [debug] [MainThread]: On master: Close
[0m23:52:36.147940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:36.149374 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:52:36.151023 [info ] [MainThread]: 
[0m23:52:36.153393 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m23:52:36.159595 [debug] [MainThread]: Command end result
[0m23:52:36.234027 [info ] [MainThread]: 
[0m23:52:36.237099 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:52:36.238371 [info ] [MainThread]: 
[0m23:52:36.240941 [error] [MainThread]:   Database Error in model highest_price_product_per_category (models/highest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/highest_price_product_per_category.sql
[0m23:52:36.242230 [info ] [MainThread]: 
[0m23:52:36.243702 [error] [MainThread]:   Database Error in model lowest_price_product_per_category (models/lowest_price_product_per_category.sql)
  syntax error at or near ";"
  LINE 10: ...e) FROM products AS p WHERE p.category = products.category);
                                                                         ^
  compiled code at target/run/think_thrift_project/models/lowest_price_product_per_category.sql
[0m23:52:36.245154 [info ] [MainThread]: 
[0m23:52:36.246911 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m23:52:36.253872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2358491, "process_user_time": 5.062227, "process_kernel_time": 1.031261, "process_mem_max_rss": "116690944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:52:36.258325 [debug] [MainThread]: Command `dbt run` failed at 23:52:36.257016 after 3.24 seconds
[0m23:52:36.260926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fff2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137a19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144f5a90>]}
[0m23:52:36.262518 [debug] [MainThread]: Flushing usage events
[0m23:53:21.272968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ec560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ec110>]}


============================== 23:53:21.292526 | d8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00 ==============================
[0m23:53:21.292526 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:53:21.294479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:53:21.942497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c2ffb0>]}
[0m23:53:22.101116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097862d0>]}
[0m23:53:22.107056 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:53:22.158973 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:53:22.467792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:53:22.468860 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/lowest_price_product_per_category.sql
[0m23:53:22.469585 [debug] [MainThread]: Partial parsing: updated file: think_thrift_project://models/highest_price_product_per_category.sql
[0m23:53:22.912683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6e4b0>]}
[0m23:53:23.225761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a28e900>]}
[0m23:53:23.226768 [info ] [MainThread]: Found 3 seeds, 9 models, 423 macros
[0m23:53:23.227753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fe420>]}
[0m23:53:23.231081 [info ] [MainThread]: 
[0m23:53:23.232303 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:23.240797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:53:23.397364 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:53:23.398676 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:53:23.402057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:23.537796 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.130 seconds
[0m23:53:23.540585 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:53:23.546530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:53:23.563876 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:53:23.564940 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:53:23.567591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:23.577662 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m23:53:23.578336 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:53:23.578913 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:53:23.591339 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m23:53:23.595619 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:53:23.596796 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:53:23.615119 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.616150 [debug] [MainThread]: On master: BEGIN
[0m23:53:23.618962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:23.635852 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m23:53:23.638533 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.640125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:23.673278 [debug] [MainThread]: SQL status: SELECT 11 in 0.031 seconds
[0m23:53:23.681941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5146e0>]}
[0m23:53:23.682972 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:23.684448 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.685451 [debug] [MainThread]: On master: BEGIN
[0m23:53:23.687895 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:53:23.689277 [debug] [MainThread]: On master: COMMIT
[0m23:53:23.690009 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:23.690592 [debug] [MainThread]: On master: COMMIT
[0m23:53:23.691537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:53:23.692706 [debug] [MainThread]: On master: Close
[0m23:53:23.694754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:23.695582 [info ] [MainThread]: 
[0m23:53:23.702482 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:53:23.704161 [info ] [Thread-1 (]: 1 of 9 START sql view model public.products .................................... [RUN]
[0m23:53:23.705334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m23:53:23.706221 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:53:23.731734 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:53:23.734603 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:53:23.829434 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:53:23.831166 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:53:23.832177 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:53:23.834090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:23.844072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:53:23.844864 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:53:23.846138 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:53:23.852900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:53:23.866501 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:53:23.867355 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:53:23.869599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:23.875385 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:53:23.876114 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:53:23.877840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:23.936845 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:53:23.937619 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:53:23.938274 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:53:23.940671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:23.952280 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:53:23.961296 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:53:23.962039 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:53:23.965316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:53:23.970365 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:53:23.972951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a28ca70>]}
[0m23:53:23.974631 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.27s]
[0m23:53:23.976193 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:53:23.977024 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:53:23.978213 [info ] [Thread-1 (]: 2 of 9 START sql view model public.top_selling_products ........................ [RUN]
[0m23:53:23.979109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:53:23.979791 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:53:23.985729 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:53:23.986933 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:53:23.993063 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:53:23.994240 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:53:23.994989 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:53:23.996025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:24.004933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:53:24.005716 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:53:24.010111 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:53:24.015426 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:53:24.029569 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:53:24.030712 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:53:24.034098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.044236 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:53:24.045080 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:53:24.046570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.049166 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:53:24.052244 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:53:24.053121 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:53:24.056442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:24.060960 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:53:24.062514 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:53:24.063257 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:53:24.066624 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:53:24.077767 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:53:24.079088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aacfc80>]}
[0m23:53:24.080412 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.10s]
[0m23:53:24.084067 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:53:24.085570 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:53:24.088486 [info ] [Thread-1 (]: 3 of 9 START sql view model public.transactions ................................ [RUN]
[0m23:53:24.090038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:53:24.091630 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:53:24.095565 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:53:24.096978 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:53:24.107963 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:53:24.109269 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:53:24.110026 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:53:24.110861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:24.124649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:53:24.125707 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:53:24.126997 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:53:24.130443 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:53:24.138649 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:53:24.139718 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:53:24.141722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.146587 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:53:24.147319 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:53:24.148808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.155066 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:53:24.156549 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:53:24.158053 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:53:24.159688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:53:24.163445 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:53:24.164725 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:53:24.165835 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:53:24.169244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:53:24.171673 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:53:24.173068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaccd70>]}
[0m23:53:24.175368 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:53:24.176805 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:53:24.177633 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:53:24.178805 [info ] [Thread-1 (]: 4 of 9 START sql view model public.user_sales .................................. [RUN]
[0m23:53:24.179696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:53:24.180377 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:53:24.189594 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:53:24.191853 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:53:24.197158 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:53:24.198648 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:53:24.204541 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:53:24.205637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:24.214297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:53:24.217606 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:53:24.219100 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:53:24.225999 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:53:24.231525 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:53:24.232243 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:53:24.237708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:53:24.245588 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:53:24.246586 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:53:24.248497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.259216 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:53:24.260870 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:53:24.261811 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:53:24.264689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:24.269056 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:53:24.271451 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:53:24.272642 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:53:24.277349 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:53:24.280321 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:53:24.281742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a98e510>]}
[0m23:53:24.284171 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m23:53:24.287989 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:53:24.289229 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:53:24.291368 [info ] [Thread-1 (]: 5 of 9 START sql view model public.users ....................................... [RUN]
[0m23:53:24.292756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:53:24.294111 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:53:24.304298 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:53:24.306711 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:53:24.326019 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:53:24.328703 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:53:24.330238 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:53:24.332480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:24.355899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m23:53:24.357462 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:53:24.399272 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:53:24.423289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m23:53:24.433591 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:53:24.435360 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:53:24.438087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.447667 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:53:24.450048 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:53:24.453245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.460221 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:53:24.461750 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:53:24.463274 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:53:24.466945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:24.475783 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:53:24.478651 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:53:24.480325 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:53:24.485675 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:53:24.489598 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:53:24.492902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaec0b0>]}
[0m23:53:24.494394 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.20s]
[0m23:53:24.496390 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:53:24.497455 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_price_product_per_category
[0m23:53:24.499370 [info ] [Thread-1 (]: 6 of 9 START sql view model public.highest_price_product_per_category .......... [RUN]
[0m23:53:24.502392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.highest_price_product_per_category)
[0m23:53:24.504775 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_price_product_per_category
[0m23:53:24.511577 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.513201 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_price_product_per_category
[0m23:53:24.524915 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.526397 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.527558 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: BEGIN
[0m23:53:24.528556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:24.539725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:53:24.541254 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.542364 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category)
  );
[0m23:53:24.548165 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:53:24.562677 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.563822 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */
alter table "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp" rename to "highest_price_product_per_category"
[0m23:53:24.565122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.573768 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: COMMIT
[0m23:53:24.574676 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.575962 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: COMMIT
[0m23:53:24.578806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:24.582472 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."highest_price_product_per_category__dbt_backup"
[0m23:53:24.590176 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:53:24.591228 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */
drop view if exists "think-thrift-db"."public"."highest_price_product_per_category__dbt_backup" cascade
[0m23:53:24.592867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:53:24.596015 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: Close
[0m23:53:24.597140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaddd90>]}
[0m23:53:24.605419 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.highest_price_product_per_category ..... [[32mCREATE VIEW[0m in 0.09s]
[0m23:53:24.607840 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_price_product_per_category
[0m23:53:24.609013 [debug] [Thread-1 (]: Began running node model.think_thrift_project.lowest_price_product_per_category
[0m23:53:24.610507 [info ] [Thread-1 (]: 7 of 9 START sql view model public.lowest_price_product_per_category ........... [RUN]
[0m23:53:24.612584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_price_product_per_category, now model.think_thrift_project.lowest_price_product_per_category)
[0m23:53:24.613931 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.lowest_price_product_per_category
[0m23:53:24.624819 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.626549 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.lowest_price_product_per_category
[0m23:53:24.631791 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.633554 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.635761 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: BEGIN
[0m23:53:24.637835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:24.659072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m23:53:24.660877 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.662568 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category)
  );
[0m23:53:24.711713 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m23:53:24.722848 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.724529 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */
alter table "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp" rename to "lowest_price_product_per_category"
[0m23:53:24.726839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:24.731649 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: COMMIT
[0m23:53:24.736716 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.738639 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: COMMIT
[0m23:53:24.741555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:53:24.748189 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."lowest_price_product_per_category__dbt_backup"
[0m23:53:24.760090 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:53:24.761571 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */
drop view if exists "think-thrift-db"."public"."lowest_price_product_per_category__dbt_backup" cascade
[0m23:53:24.765861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:53:24.776712 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: Close
[0m23:53:24.779152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab27ce0>]}
[0m23:53:24.796461 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.lowest_price_product_per_category ...... [[32mCREATE VIEW[0m in 0.17s]
[0m23:53:24.802873 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.lowest_price_product_per_category
[0m23:53:24.807346 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:53:24.810870 [info ] [Thread-1 (]: 8 of 9 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:53:24.813889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.lowest_price_product_per_category, now model.think_thrift_project.total_sales_per_user)
[0m23:53:24.854870 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:53:24.866612 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:53:24.868924 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:53:24.999063 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:53:25.003481 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:53:25.005410 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:53:25.006952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:25.022537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m23:53:25.023494 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:53:25.024672 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:53:25.029565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:53:25.034792 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:53:25.035562 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:53:25.036892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:25.039216 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:53:25.044724 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:53:25.046734 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:53:25.049772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:25.053338 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:53:25.055752 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:53:25.057833 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:53:25.059003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:53:25.061132 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:53:25.062188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0f740>]}
[0m23:53:25.063281 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.25s]
[0m23:53:25.081907 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:53:25.086055 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:53:25.092077 [info ] [Thread-1 (]: 9 of 9 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:53:25.093489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:53:25.095584 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:53:25.109030 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:53:25.110617 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:53:25.124896 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:53:25.130419 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:53:25.131646 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:53:25.134478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:25.155652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m23:53:25.158465 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:53:25.163359 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:53:25.174939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:53:25.191135 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:53:25.192690 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:53:25.195582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:53:25.201173 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:53:25.204448 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:53:25.205714 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:53:25.208913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:53:25.214275 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:53:25.219109 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:53:25.221121 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:53:25.222439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:53:25.226552 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:53:25.227736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8ea0015-b6dc-4ac5-9bf5-f0cd3dcb1c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b8890>]}
[0m23:53:25.229581 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:53:25.234214 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:53:25.241023 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:25.242496 [debug] [MainThread]: On master: BEGIN
[0m23:53:25.243797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:25.259456 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m23:53:25.261711 [debug] [MainThread]: On master: COMMIT
[0m23:53:25.262609 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:25.263616 [debug] [MainThread]: On master: COMMIT
[0m23:53:25.265299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:53:25.266316 [debug] [MainThread]: On master: Close
[0m23:53:25.271716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:25.273549 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:53:25.274999 [info ] [MainThread]: 
[0m23:53:25.276343 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m23:53:25.293834 [debug] [MainThread]: Command end result
[0m23:53:25.392087 [info ] [MainThread]: 
[0m23:53:25.393611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:25.394918 [info ] [MainThread]: 
[0m23:53:25.396165 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m23:53:25.403188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.363191, "process_user_time": 5.377433, "process_kernel_time": 1.060061, "process_mem_max_rss": "115343360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:53:25.404989 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:25.404683 after 4.37 seconds
[0m23:53:25.406198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa99ac0>]}
[0m23:53:25.407518 [debug] [MainThread]: Flushing usage events
[0m23:55:26.087775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d03b0>]}


============================== 23:55:26.104302 | cbc93351-fe4c-4186-bdb8-bf6be59a56ef ==============================
[0m23:55:26.104302 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:55:26.105859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"start_date": "2024-10-01"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:55:26.467735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824cb90>]}
[0m23:55:26.557588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6e1e0>]}
[0m23:55:26.560396 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:55:26.597981 [debug] [MainThread]: checksum: 4a489b93b53bc4097f498f05057f34f9e984121a3f1c8727a05ce7035fbe6d2e, vars: {'start_date': '2024-10-01'}, profile: , target: , version: 1.8.7
[0m23:55:26.738512 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:55:26.739412 [debug] [MainThread]: previous checksum: 4a489b93b53bc4097f498f05057f34f9e984121a3f1c8727a05ce7035fbe6d2e, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m23:55:26.740045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d0080>]}
[0m23:55:28.697409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2de80>]}
[0m23:55:28.883243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8e120>]}
[0m23:55:28.884062 [info ] [MainThread]: Found 9 models, 3 seeds, 423 macros
[0m23:55:28.884772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e66b10>]}
[0m23:55:28.887898 [info ] [MainThread]: 
[0m23:55:28.888923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:55:28.896275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:55:29.007580 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:55:29.008286 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:29.008906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:29.107346 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.096 seconds
[0m23:55:29.110053 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:55:29.113415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:55:29.126116 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:55:29.126827 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:55:29.127358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:29.136533 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:55:29.137208 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:55:29.137781 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:55:29.142560 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m23:55:29.145870 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:55:29.146771 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:55:29.160421 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:29.161975 [debug] [MainThread]: On master: BEGIN
[0m23:55:29.162641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:29.170975 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:55:29.171783 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:29.172498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:55:29.200135 [debug] [MainThread]: SQL status: SELECT 13 in 0.027 seconds
[0m23:55:29.212764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f35c10>]}
[0m23:55:29.213928 [debug] [MainThread]: On master: ROLLBACK
[0m23:55:29.215295 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:29.216044 [debug] [MainThread]: On master: BEGIN
[0m23:55:29.217923 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:55:29.219165 [debug] [MainThread]: On master: COMMIT
[0m23:55:29.220033 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:29.220761 [debug] [MainThread]: On master: COMMIT
[0m23:55:29.221705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:55:29.224213 [debug] [MainThread]: On master: Close
[0m23:55:29.228425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:55:29.230003 [info ] [MainThread]: 
[0m23:55:29.239438 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:55:29.242093 [info ] [Thread-1 (]: 1 of 9 START sql view model public.products .................................... [RUN]
[0m23:55:29.243672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m23:55:29.246201 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:55:29.262800 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:55:29.264274 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:55:29.339111 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:55:29.340798 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:55:29.341737 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:55:29.342511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.350820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:55:29.351617 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:55:29.352329 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:55:29.355289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:55:29.365829 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:55:29.366672 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:55:29.368217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.373537 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:55:29.374408 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:55:29.375694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.406073 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:55:29.406854 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:55:29.407463 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:55:29.409864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:29.419368 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:55:29.427694 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:55:29.428567 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:55:29.432357 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:55:29.436369 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:55:29.438907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae5610>]}
[0m23:55:29.440150 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.19s]
[0m23:55:29.441311 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:55:29.442115 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:55:29.443364 [info ] [Thread-1 (]: 2 of 9 START sql view model public.top_selling_products ........................ [RUN]
[0m23:55:29.444384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:55:29.445171 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:55:29.449795 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:55:29.451556 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:55:29.459847 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:55:29.462448 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:55:29.463389 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:55:29.464072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.472938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:55:29.473771 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:55:29.474473 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:55:29.479902 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:55:29.485806 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:55:29.486779 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:55:29.488624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.493691 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:55:29.495366 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:55:29.496663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:55:29.499335 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:55:29.500341 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:55:29.502112 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:55:29.504954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:55:29.508671 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:55:29.510345 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:55:29.511743 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:55:29.514865 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:55:29.517566 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:55:29.518634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930f7a0>]}
[0m23:55:29.519708 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:55:29.521103 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:55:29.521920 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:55:29.522843 [info ] [Thread-1 (]: 3 of 9 START sql view model public.transactions ................................ [RUN]
[0m23:55:29.523700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:55:29.524396 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:55:29.528822 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:55:29.530163 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:55:29.538159 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:55:29.539349 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:55:29.540058 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:55:29.540811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.548955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:55:29.549766 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:55:29.550573 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:55:29.553880 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:55:29.559359 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:55:29.560197 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:55:29.561603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.566341 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:55:29.567363 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:55:29.569264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.571952 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:55:29.572697 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:55:29.573479 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:55:29.575694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:55:29.580492 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:55:29.581977 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:55:29.582850 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:55:29.587042 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:55:29.590530 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:55:29.591831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dde20>]}
[0m23:55:29.593237 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:55:29.595617 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:55:29.596491 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:55:29.597713 [info ] [Thread-1 (]: 4 of 9 START sql view model public.user_sales .................................. [RUN]
[0m23:55:29.598704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:55:29.599415 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:55:29.605409 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:55:29.607820 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:55:29.614324 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:55:29.615510 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:55:29.616214 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:55:29.617413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.626310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:55:29.627256 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:55:29.628726 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:55:29.633462 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:55:29.640346 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:55:29.641057 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:55:29.642307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.649748 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:55:29.650546 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:55:29.652480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.655780 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:55:29.656465 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:55:29.657073 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:55:29.659666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:29.664106 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:55:29.665329 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:55:29.665991 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:55:29.668956 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:55:29.671390 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:55:29.672455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933e750>]}
[0m23:55:29.673566 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m23:55:29.674949 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:55:29.675859 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:55:29.676976 [info ] [Thread-1 (]: 5 of 9 START sql view model public.users ....................................... [RUN]
[0m23:55:29.678008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:55:29.678673 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:55:29.682649 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:55:29.683977 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:55:29.692209 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:55:29.693779 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:55:29.695493 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:55:29.696299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.705326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:55:29.706815 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:55:29.708831 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:55:29.715266 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:55:29.722951 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:55:29.723799 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:55:29.727217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:55:29.737470 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:55:29.738768 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:55:29.741275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.747151 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:55:29.748105 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:55:29.748892 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:55:29.751542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:29.756160 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:55:29.758227 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:55:29.759107 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:55:29.763335 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:55:29.766354 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:55:29.767794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109310680>]}
[0m23:55:29.769584 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m23:55:29.771257 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:55:29.772178 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_price_product_per_category
[0m23:55:29.774286 [info ] [Thread-1 (]: 6 of 9 START sql view model public.highest_price_product_per_category .......... [RUN]
[0m23:55:29.777860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.highest_price_product_per_category)
[0m23:55:29.779227 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_price_product_per_category
[0m23:55:29.790307 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.792411 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_price_product_per_category
[0m23:55:29.805472 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.807754 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.809978 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: BEGIN
[0m23:55:29.812250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.825182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:55:29.826151 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.826945 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category)
  );
[0m23:55:29.832331 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:55:29.844452 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.853678 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */
alter table "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp" rename to "highest_price_product_per_category"
[0m23:55:29.856108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.862539 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: COMMIT
[0m23:55:29.863907 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.864825 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: COMMIT
[0m23:55:29.867213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:29.870813 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."highest_price_product_per_category__dbt_backup"
[0m23:55:29.872201 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:55:29.872860 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */
drop view if exists "think-thrift-db"."public"."highest_price_product_per_category__dbt_backup" cascade
[0m23:55:29.873881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:55:29.876153 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: Close
[0m23:55:29.877273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930fd70>]}
[0m23:55:29.878556 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.highest_price_product_per_category ..... [[32mCREATE VIEW[0m in 0.10s]
[0m23:55:29.880115 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_price_product_per_category
[0m23:55:29.880910 [debug] [Thread-1 (]: Began running node model.think_thrift_project.lowest_price_product_per_category
[0m23:55:29.882040 [info ] [Thread-1 (]: 7 of 9 START sql view model public.lowest_price_product_per_category ........... [RUN]
[0m23:55:29.883045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_price_product_per_category, now model.think_thrift_project.lowest_price_product_per_category)
[0m23:55:29.883738 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.lowest_price_product_per_category
[0m23:55:29.888006 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.889335 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.lowest_price_product_per_category
[0m23:55:29.915519 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.918412 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.919776 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: BEGIN
[0m23:55:29.920564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:29.930471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:55:29.931309 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.932384 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category)
  );
[0m23:55:29.936892 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:55:29.946904 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.947786 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */
alter table "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp" rename to "lowest_price_product_per_category"
[0m23:55:29.949685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:29.953218 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: COMMIT
[0m23:55:29.954147 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.954784 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: COMMIT
[0m23:55:29.957281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:29.962387 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."lowest_price_product_per_category__dbt_backup"
[0m23:55:29.963660 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:55:29.964319 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */
drop view if exists "think-thrift-db"."public"."lowest_price_product_per_category__dbt_backup" cascade
[0m23:55:29.965549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:55:29.967909 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: Close
[0m23:55:29.968992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093325d0>]}
[0m23:55:29.970085 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.lowest_price_product_per_category ...... [[32mCREATE VIEW[0m in 0.09s]
[0m23:55:29.971553 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.lowest_price_product_per_category
[0m23:55:29.972382 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:55:29.973299 [info ] [Thread-1 (]: 8 of 9 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:55:29.974377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.lowest_price_product_per_category, now model.think_thrift_project.total_sales_per_user)
[0m23:55:29.975106 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:55:29.980111 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:55:29.981623 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:55:29.991945 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:55:29.994098 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:55:29.996328 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:55:29.997611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:30.008270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:55:30.009372 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:55:30.010705 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:55:30.016163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:55:30.022873 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:55:30.023728 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:55:30.025155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:30.028616 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:55:30.029598 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:55:30.030337 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:55:30.032867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:30.037170 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:55:30.038618 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:55:30.039320 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:55:30.040408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:55:30.042682 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:55:30.044215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930c680>]}
[0m23:55:30.045957 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:55:30.047494 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:55:30.048286 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:55:30.049201 [info ] [Thread-1 (]: 9 of 9 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:55:30.050065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:55:30.050740 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:55:30.057290 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:55:30.058613 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:55:30.064505 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:55:30.065655 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:55:30.066401 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:55:30.067145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:55:30.085247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:55:30.086933 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:55:30.087797 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:55:30.094145 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:55:30.112760 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:55:30.113637 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:55:30.115264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:55:30.120195 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:55:30.121271 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:55:30.122095 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:55:30.124698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:55:30.129510 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:55:30.130785 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:55:30.131420 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:55:30.132594 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:55:30.134950 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:55:30.136080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc93351-fe4c-4186-bdb8-bf6be59a56ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109313620>]}
[0m23:55:30.137142 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m23:55:30.138654 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:55:30.141986 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:30.142972 [debug] [MainThread]: On master: BEGIN
[0m23:55:30.143590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:30.153695 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:55:30.154398 [debug] [MainThread]: On master: COMMIT
[0m23:55:30.154946 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:30.155477 [debug] [MainThread]: On master: COMMIT
[0m23:55:30.156274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:55:30.156874 [debug] [MainThread]: On master: Close
[0m23:55:30.157675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:30.158303 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:55:30.159373 [info ] [MainThread]: 
[0m23:55:30.161012 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m23:55:30.165294 [debug] [MainThread]: Command end result
[0m23:55:30.261514 [info ] [MainThread]: 
[0m23:55:30.263617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:30.265109 [info ] [MainThread]: 
[0m23:55:30.267020 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m23:55:30.278264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3419504, "process_user_time": 6.382509, "process_kernel_time": 0.989668, "process_mem_max_rss": "115728384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:55:30.280252 [debug] [MainThread]: Command `dbt run` succeeded at 23:55:30.279886 after 4.35 seconds
[0m23:55:30.283773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e38590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8eba0>]}
[0m23:55:30.291253 [debug] [MainThread]: Flushing usage events
[0m23:56:29.039213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106884500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106884080>]}


============================== 23:56:29.054029 | 5f157c06-4b14-4a55-8094-4ab5a4cf850c ==============================
[0m23:56:29.054029 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:56:29.055725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/olikelly/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/olikelly/Documents/Coding/think-thrift/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --vars {"product_name": "trousers"}', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:56:29.426127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576c5f0>]}
[0m23:56:29.544217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669f6b0>]}
[0m23:56:29.548172 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:56:29.595735 [debug] [MainThread]: checksum: 67a91b40e87c19c48384e314a5ad8237006e7a343542c43cec2dcad3045a3b62, vars: {'product_name': 'trousers'}, profile: , target: , version: 1.8.7
[0m23:56:29.728570 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:56:29.729422 [debug] [MainThread]: previous checksum: 67a91b40e87c19c48384e314a5ad8237006e7a343542c43cec2dcad3045a3b62, current checksum: 4a489b93b53bc4097f498f05057f34f9e984121a3f1c8727a05ce7035fbe6d2e
[0m23:56:29.730092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c27e0>]}
[0m23:56:31.672099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732e8a0>]}
[0m23:56:31.877745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceb530>]}
[0m23:56:31.878842 [info ] [MainThread]: Found 9 models, 3 seeds, 423 macros
[0m23:56:31.879782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731d220>]}
[0m23:56:31.883044 [info ] [MainThread]: 
[0m23:56:31.884385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:31.891839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_think-thrift-db'
[0m23:56:32.004895 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db"
[0m23:56:32.005596 [debug] [ThreadPool]: On list_think-thrift-db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db"} */

    select distinct nspname from pg_namespace
  
[0m23:56:32.006154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:32.100063 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.094 seconds
[0m23:56:32.102385 [debug] [ThreadPool]: On list_think-thrift-db: Close
[0m23:56:32.107481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_think-thrift-db, now list_think-thrift-db_public)
[0m23:56:32.124794 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:56:32.125467 [debug] [ThreadPool]: On list_think-thrift-db_public: BEGIN
[0m23:56:32.125997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:32.134647 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:56:32.135338 [debug] [ThreadPool]: Using postgres connection "list_think-thrift-db_public"
[0m23:56:32.135915 [debug] [ThreadPool]: On list_think-thrift-db_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "list_think-thrift-db_public"} */
select
      'think-thrift-db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'think-thrift-db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:56:32.140785 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m23:56:32.143637 [debug] [ThreadPool]: On list_think-thrift-db_public: ROLLBACK
[0m23:56:32.145190 [debug] [ThreadPool]: On list_think-thrift-db_public: Close
[0m23:56:32.158675 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:32.159355 [debug] [MainThread]: On master: BEGIN
[0m23:56:32.159880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:32.168373 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:56:32.169099 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:32.169771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:32.196888 [debug] [MainThread]: SQL status: SELECT 13 in 0.026 seconds
[0m23:56:32.204393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce99d0>]}
[0m23:56:32.205141 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:32.205984 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:32.206584 [debug] [MainThread]: On master: BEGIN
[0m23:56:32.207625 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:56:32.208338 [debug] [MainThread]: On master: COMMIT
[0m23:56:32.208904 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:32.209439 [debug] [MainThread]: On master: COMMIT
[0m23:56:32.210233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:32.211011 [debug] [MainThread]: On master: Close
[0m23:56:32.211961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:56:32.212719 [info ] [MainThread]: 
[0m23:56:32.218779 [debug] [Thread-1 (]: Began running node model.think_thrift_project.products
[0m23:56:32.220456 [info ] [Thread-1 (]: 1 of 9 START sql view model public.products .................................... [RUN]
[0m23:56:32.221520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_think-thrift-db_public, now model.think_thrift_project.products)
[0m23:56:32.222393 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.products
[0m23:56:32.239880 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.products"
[0m23:56:32.241616 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.products
[0m23:56:32.318274 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.products"
[0m23:56:32.319665 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:56:32.320440 [debug] [Thread-1 (]: On model.think_thrift_project.products: BEGIN
[0m23:56:32.321161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.329778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:56:32.330664 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:56:32.331511 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */

  create view "think-thrift-db"."public"."products__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."products_seed"
  );
[0m23:56:32.334447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:56:32.344734 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:56:32.345473 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products" rename to "products__dbt_backup"
[0m23:56:32.346735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.351153 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:56:32.352001 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
alter table "think-thrift-db"."public"."products__dbt_tmp" rename to "products"
[0m23:56:32.353200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.388551 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:56:32.389300 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:56:32.389916 [debug] [Thread-1 (]: On model.think_thrift_project.products: COMMIT
[0m23:56:32.392334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:32.401962 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."products__dbt_backup"
[0m23:56:32.410408 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.products"
[0m23:56:32.411279 [debug] [Thread-1 (]: On model.think_thrift_project.products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.products"} */
drop view if exists "think-thrift-db"."public"."products__dbt_backup" cascade
[0m23:56:32.415223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:56:32.419030 [debug] [Thread-1 (]: On model.think_thrift_project.products: Close
[0m23:56:32.421575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513d5b0>]}
[0m23:56:32.422766 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.products ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:56:32.424022 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.products
[0m23:56:32.424820 [debug] [Thread-1 (]: Began running node model.think_thrift_project.top_selling_products
[0m23:56:32.426012 [info ] [Thread-1 (]: 2 of 9 START sql view model public.top_selling_products ........................ [RUN]
[0m23:56:32.426921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.products, now model.think_thrift_project.top_selling_products)
[0m23:56:32.427754 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.top_selling_products
[0m23:56:32.432370 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.top_selling_products"
[0m23:56:32.433641 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.top_selling_products
[0m23:56:32.442874 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.top_selling_products"
[0m23:56:32.444436 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:56:32.445387 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: BEGIN
[0m23:56:32.446123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.455032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:56:32.456064 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:56:32.457489 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */

  create view "think-thrift-db"."public"."top_selling_products__dbt_tmp"
    
    
  as (
    SELECT p.product_name, 
       SUM(s.quantity) AS total_quantity
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity DESC
  );
[0m23:56:32.462826 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:56:32.469222 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:56:32.469968 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products" rename to "top_selling_products__dbt_backup"
[0m23:56:32.471158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.476988 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:56:32.477734 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
alter table "think-thrift-db"."public"."top_selling_products__dbt_tmp" rename to "top_selling_products"
[0m23:56:32.478950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.482927 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:56:32.483981 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:56:32.484683 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: COMMIT
[0m23:56:32.487036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:32.491613 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."top_selling_products__dbt_backup"
[0m23:56:32.493161 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.top_selling_products"
[0m23:56:32.493840 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.top_selling_products"} */
drop view if exists "think-thrift-db"."public"."top_selling_products__dbt_backup" cascade
[0m23:56:32.496929 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:56:32.500431 [debug] [Thread-1 (]: On model.think_thrift_project.top_selling_products: Close
[0m23:56:32.501598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ec380>]}
[0m23:56:32.502711 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public.top_selling_products ................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:56:32.504159 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.top_selling_products
[0m23:56:32.505007 [debug] [Thread-1 (]: Began running node model.think_thrift_project.transactions
[0m23:56:32.505943 [info ] [Thread-1 (]: 3 of 9 START sql view model public.transactions ................................ [RUN]
[0m23:56:32.506813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.top_selling_products, now model.think_thrift_project.transactions)
[0m23:56:32.507628 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.transactions
[0m23:56:32.511784 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.transactions"
[0m23:56:32.513627 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.transactions
[0m23:56:32.519903 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.transactions"
[0m23:56:32.521427 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:56:32.522700 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: BEGIN
[0m23:56:32.523649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.532705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:56:32.533787 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:56:32.534488 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */

  create view "think-thrift-db"."public"."transactions__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."transactions_seed"
  );
[0m23:56:32.537920 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:56:32.544262 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:56:32.545163 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions" rename to "transactions__dbt_backup"
[0m23:56:32.546734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.552322 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:56:32.553167 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
alter table "think-thrift-db"."public"."transactions__dbt_tmp" rename to "transactions"
[0m23:56:32.554822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.558266 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:56:32.559259 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:56:32.559932 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: COMMIT
[0m23:56:32.562359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:32.567268 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."transactions__dbt_backup"
[0m23:56:32.568515 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.transactions"
[0m23:56:32.569163 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.transactions"} */
drop view if exists "think-thrift-db"."public"."transactions__dbt_backup" cascade
[0m23:56:32.572423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:56:32.575147 [debug] [Thread-1 (]: On model.think_thrift_project.transactions: Close
[0m23:56:32.576153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e8620>]}
[0m23:56:32.577227 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public.transactions ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m23:56:32.578665 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.transactions
[0m23:56:32.579575 [debug] [Thread-1 (]: Began running node model.think_thrift_project.user_sales
[0m23:56:32.581011 [info ] [Thread-1 (]: 4 of 9 START sql view model public.user_sales .................................. [RUN]
[0m23:56:32.581969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.transactions, now model.think_thrift_project.user_sales)
[0m23:56:32.582662 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.user_sales
[0m23:56:32.588369 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.user_sales"
[0m23:56:32.589813 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.user_sales
[0m23:56:32.596441 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.user_sales"
[0m23:56:32.597841 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:56:32.599518 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: BEGIN
[0m23:56:32.600216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.609558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:56:32.610444 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:56:32.611276 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */

  create view "think-thrift-db"."public"."user_sales__dbt_tmp"
    
    
  as (
    SELECT u.username, 
       SUM(s.quantity * p.price) AS total_sales
FROM "think-thrift-db"."public"."transactions_seed" s
JOIN "think-thrift-db"."public"."users_seed" u ON s.user_id = u.user_id
JOIN "think-thrift-db"."public"."products_seed" p ON s.product_id = p.product_id
GROUP BY u.username
  );
[0m23:56:32.616932 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:56:32.622256 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:56:32.623122 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales" rename to "user_sales__dbt_backup"
[0m23:56:32.625240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.633455 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:56:32.634205 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
alter table "think-thrift-db"."public"."user_sales__dbt_tmp" rename to "user_sales"
[0m23:56:32.635419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.639099 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:56:32.640085 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:56:32.640719 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: COMMIT
[0m23:56:32.642998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:32.647447 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."user_sales__dbt_backup"
[0m23:56:32.649407 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.user_sales"
[0m23:56:32.650142 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.user_sales"} */
drop view if exists "think-thrift-db"."public"."user_sales__dbt_backup" cascade
[0m23:56:32.652910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:56:32.655041 [debug] [Thread-1 (]: On model.think_thrift_project.user_sales: Close
[0m23:56:32.656133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1b260>]}
[0m23:56:32.657223 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public.user_sales ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m23:56:32.658695 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.user_sales
[0m23:56:32.659642 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users
[0m23:56:32.662765 [info ] [Thread-1 (]: 5 of 9 START sql view model public.users ....................................... [RUN]
[0m23:56:32.664151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.user_sales, now model.think_thrift_project.users)
[0m23:56:32.665568 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users
[0m23:56:32.671287 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users"
[0m23:56:32.672825 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users
[0m23:56:32.687639 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users"
[0m23:56:32.691139 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:56:32.691916 [debug] [Thread-1 (]: On model.think_thrift_project.users: BEGIN
[0m23:56:32.692667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.703324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m23:56:32.705981 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:56:32.707353 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */

  create view "think-thrift-db"."public"."users__dbt_tmp"
    
    
  as (
    SELECT *
FROM "think-thrift-db"."public"."users_seed"
  );
[0m23:56:32.711008 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:56:32.717327 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:56:32.718067 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users" rename to "users__dbt_backup"
[0m23:56:32.719256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.726072 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:56:32.727536 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
alter table "think-thrift-db"."public"."users__dbt_tmp" rename to "users"
[0m23:56:32.729896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.736228 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:56:32.737100 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:56:32.739789 [debug] [Thread-1 (]: On model.think_thrift_project.users: COMMIT
[0m23:56:32.743276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:32.747771 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users__dbt_backup"
[0m23:56:32.750124 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users"
[0m23:56:32.750989 [debug] [Thread-1 (]: On model.think_thrift_project.users: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users"} */
drop view if exists "think-thrift-db"."public"."users__dbt_backup" cascade
[0m23:56:32.754719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:56:32.757442 [debug] [Thread-1 (]: On model.think_thrift_project.users: Close
[0m23:56:32.758895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760af00>]}
[0m23:56:32.761092 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.users .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m23:56:32.764959 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users
[0m23:56:32.766275 [debug] [Thread-1 (]: Began running node model.think_thrift_project.highest_price_product_per_category
[0m23:56:32.767542 [info ] [Thread-1 (]: 6 of 9 START sql view model public.highest_price_product_per_category .......... [RUN]
[0m23:56:32.770765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.users, now model.think_thrift_project.highest_price_product_per_category)
[0m23:56:32.776642 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.highest_price_product_per_category
[0m23:56:32.781160 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.784796 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.highest_price_product_per_category
[0m23:56:32.795207 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.798561 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.801017 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: BEGIN
[0m23:56:32.802893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.819147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:56:32.820660 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.823584 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */

  create view "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MAX(price) FROM products AS p WHERE p.category = products.category)
  );
[0m23:56:32.830823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:56:32.835509 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.837451 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */
alter table "think-thrift-db"."public"."highest_price_product_per_category__dbt_tmp" rename to "highest_price_product_per_category"
[0m23:56:32.841503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:56:32.846429 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: COMMIT
[0m23:56:32.847764 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.848550 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: COMMIT
[0m23:56:32.851059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:56:32.857507 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."highest_price_product_per_category__dbt_backup"
[0m23:56:32.859126 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.highest_price_product_per_category"
[0m23:56:32.859956 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.highest_price_product_per_category"} */
drop view if exists "think-thrift-db"."public"."highest_price_product_per_category__dbt_backup" cascade
[0m23:56:32.863457 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:56:32.870595 [debug] [Thread-1 (]: On model.think_thrift_project.highest_price_product_per_category: Close
[0m23:56:32.872445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f8110>]}
[0m23:56:32.874718 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.highest_price_product_per_category ..... [[32mCREATE VIEW[0m in 0.10s]
[0m23:56:32.878545 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.highest_price_product_per_category
[0m23:56:32.880516 [debug] [Thread-1 (]: Began running node model.think_thrift_project.lowest_price_product_per_category
[0m23:56:32.883107 [info ] [Thread-1 (]: 7 of 9 START sql view model public.lowest_price_product_per_category ........... [RUN]
[0m23:56:32.884171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.highest_price_product_per_category, now model.think_thrift_project.lowest_price_product_per_category)
[0m23:56:32.885775 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.lowest_price_product_per_category
[0m23:56:32.891340 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.893436 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.lowest_price_product_per_category
[0m23:56:32.915113 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.917313 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.919507 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: BEGIN
[0m23:56:32.922826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:32.937567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:56:32.939848 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.941778 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */

  create view "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp"
    
    
  as (
    SELECT 
product_name, category, price
FROM "think-thrift-db"."public"."products"
WHERE price = (SELECT MIN(price) FROM products AS p WHERE p.category = products.category)
  );
[0m23:56:32.952185 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:56:32.961055 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.962094 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */
alter table "think-thrift-db"."public"."lowest_price_product_per_category__dbt_tmp" rename to "lowest_price_product_per_category"
[0m23:56:32.965781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:32.975457 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: COMMIT
[0m23:56:32.977117 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.978513 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: COMMIT
[0m23:56:32.981764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:32.991641 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."lowest_price_product_per_category__dbt_backup"
[0m23:56:32.993083 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.lowest_price_product_per_category"
[0m23:56:32.993882 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.lowest_price_product_per_category"} */
drop view if exists "think-thrift-db"."public"."lowest_price_product_per_category__dbt_backup" cascade
[0m23:56:32.994995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:56:32.999088 [debug] [Thread-1 (]: On model.think_thrift_project.lowest_price_product_per_category: Close
[0m23:56:33.002231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b8650>]}
[0m23:56:33.003710 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.lowest_price_product_per_category ...... [[32mCREATE VIEW[0m in 0.12s]
[0m23:56:33.009941 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.lowest_price_product_per_category
[0m23:56:33.011595 [debug] [Thread-1 (]: Began running node model.think_thrift_project.total_sales_per_user
[0m23:56:33.012625 [info ] [Thread-1 (]: 8 of 9 START sql view model public.total_sales_per_user ........................ [RUN]
[0m23:56:33.014229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.lowest_price_product_per_category, now model.think_thrift_project.total_sales_per_user)
[0m23:56:33.018498 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.total_sales_per_user
[0m23:56:33.028471 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.030005 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.total_sales_per_user
[0m23:56:33.042832 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.044798 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.046298 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: BEGIN
[0m23:56:33.048366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:33.062189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:56:33.063870 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.065986 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */

  create view "think-thrift-db"."public"."total_sales_per_user__dbt_tmp"
    
    
  as (
    SELECT 
  user_id, 
  SUM(quantity * price) AS total_sales
FROM "think-thrift-db"."public"."transactions" 
JOIN "think-thrift-db"."public"."products" 
ON transactions.product_id = products.product_id
GROUP BY user_id
  );
[0m23:56:33.079989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m23:56:33.094765 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.095635 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
alter table "think-thrift-db"."public"."total_sales_per_user__dbt_tmp" rename to "total_sales_per_user"
[0m23:56:33.097109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:33.101213 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:56:33.102663 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.103490 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: COMMIT
[0m23:56:33.105797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:56:33.109960 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."total_sales_per_user__dbt_backup"
[0m23:56:33.111272 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.total_sales_per_user"
[0m23:56:33.111928 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.total_sales_per_user"} */
drop view if exists "think-thrift-db"."public"."total_sales_per_user__dbt_backup" cascade
[0m23:56:33.112969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:56:33.115378 [debug] [Thread-1 (]: On model.think_thrift_project.total_sales_per_user: Close
[0m23:56:33.116450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bbe30>]}
[0m23:56:33.118065 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.total_sales_per_user ................... [[32mCREATE VIEW[0m in 0.10s]
[0m23:56:33.120652 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.total_sales_per_user
[0m23:56:33.121420 [debug] [Thread-1 (]: Began running node model.think_thrift_project.users_since_2022
[0m23:56:33.122373 [info ] [Thread-1 (]: 9 of 9 START sql view model public.users_since_2022 ............................ [RUN]
[0m23:56:33.123312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.think_thrift_project.total_sales_per_user, now model.think_thrift_project.users_since_2022)
[0m23:56:33.124045 [debug] [Thread-1 (]: Began compiling node model.think_thrift_project.users_since_2022
[0m23:56:33.129284 [debug] [Thread-1 (]: Writing injected SQL for node "model.think_thrift_project.users_since_2022"
[0m23:56:33.130753 [debug] [Thread-1 (]: Began executing node model.think_thrift_project.users_since_2022
[0m23:56:33.139794 [debug] [Thread-1 (]: Writing runtime sql for node "model.think_thrift_project.users_since_2022"
[0m23:56:33.141871 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:56:33.143331 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: BEGIN
[0m23:56:33.144753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:33.157545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:56:33.159271 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:56:33.160069 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */

  create view "think-thrift-db"."public"."users_since_2022__dbt_tmp"
    
    
  as (
    SELECT * 
FROM "think-thrift-db"."public"."users"
WHERE join_date >= '2022-01-01'
  );
[0m23:56:33.164667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:56:33.171017 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:56:33.171907 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
alter table "think-thrift-db"."public"."users_since_2022__dbt_tmp" rename to "users_since_2022"
[0m23:56:33.175377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:33.178864 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:56:33.180527 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:56:33.182475 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: COMMIT
[0m23:56:33.185967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:56:33.191767 [debug] [Thread-1 (]: Applying DROP to: "think-thrift-db"."public"."users_since_2022__dbt_backup"
[0m23:56:33.193384 [debug] [Thread-1 (]: Using postgres connection "model.think_thrift_project.users_since_2022"
[0m23:56:33.194479 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "think_thrift", "target_name": "dev", "node_id": "model.think_thrift_project.users_since_2022"} */
drop view if exists "think-thrift-db"."public"."users_since_2022__dbt_backup" cascade
[0m23:56:33.196051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:56:33.199615 [debug] [Thread-1 (]: On model.think_thrift_project.users_since_2022: Close
[0m23:56:33.200689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f157c06-4b14-4a55-8094-4ab5a4cf850c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cda90>]}
[0m23:56:33.201774 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.users_since_2022 ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:56:33.203216 [debug] [Thread-1 (]: Finished running node model.think_thrift_project.users_since_2022
[0m23:56:33.205326 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.206104 [debug] [MainThread]: On master: BEGIN
[0m23:56:33.206653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:33.216880 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:56:33.217568 [debug] [MainThread]: On master: COMMIT
[0m23:56:33.218185 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.218729 [debug] [MainThread]: On master: COMMIT
[0m23:56:33.219692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:33.220637 [debug] [MainThread]: On master: Close
[0m23:56:33.222156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:33.222962 [debug] [MainThread]: Connection 'model.think_thrift_project.users_since_2022' was properly closed.
[0m23:56:33.223710 [info ] [MainThread]: 
[0m23:56:33.224876 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m23:56:33.229507 [debug] [MainThread]: Command end result
[0m23:56:33.312677 [info ] [MainThread]: 
[0m23:56:33.313990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:33.314788 [info ] [MainThread]: 
[0m23:56:33.315545 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m23:56:33.321940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.403358, "process_user_time": 6.211636, "process_kernel_time": 0.83407, "process_mem_max_rss": "115466240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:56:33.324190 [debug] [MainThread]: Command `dbt run` succeeded at 23:56:33.323768 after 4.41 seconds
[0m23:56:33.325717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106884620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106884080>]}
[0m23:56:33.327305 [debug] [MainThread]: Flushing usage events
